import re
from collections import defaultdict

# Input data as a single string
data = """BK18_K95_BxBK18_K95_B BK18_K95_ExBK18_K95_E BK18_150_BxBK18_150_B BK18_150_ExBK18_150_E BK18_220_BxBK18_220_B BK18_220_ExBK18_220_E BK18_B95e_BxBK18_B95e_B BK18_B95e_ExBK18_B95e_E W023e_BxW023e_B W023e_ExW023e_E P030e_BxP030e_B P030e_ExP030e_E W033e_BxW033e_B W033e_ExW033e_E P044e_BxP044e_B P044e_ExP044e_E P143e_BxP143e_B P143e_ExP143e_E P217e_BxP217e_B P217e_ExP217e_E P353e_BxP353e_B P353e_ExP353e_E BK18_K95_BxBK18_K95_E BK18_K95_ExBK18_150_B BK18_150_BxBK18_150_E BK18_150_ExBK18_220_B BK18_220_BxBK18_220_E BK18_220_ExBK18_B95e_B BK18_B95e_BxBK18_B95e_E BK18_B95e_ExW023e_B W023e_BxW023e_E W023e_ExP030e_B P030e_BxP030e_E P030e_ExW033e_B W033e_BxW033e_E W033e_ExP044e_B P044e_BxP044e_E P044e_ExP143e_B P143e_BxP143e_E P143e_ExP217e_B P217e_BxP217e_E P217e_ExP353e_B P353e_BxP353e_E BK18_K95_BxBK18_150_B BK18_K95_ExBK18_150_E BK18_150_BxBK18_220_B BK18_150_ExBK18_220_E BK18_220_BxBK18_B95e_B BK18_220_ExBK18_B95e_E BK18_B95e_BxW023e_B BK18_B95e_ExW023e_E W023e_BxP030e_B W023e_ExP030e_E P030e_BxW033e_B P030e_ExW033e_E W033e_BxP044e_B W033e_ExP044e_E P044e_BxP143e_B P044e_ExP143e_E P143e_BxP217e_B P143e_ExP217e_E P217e_BxP353e_B P217e_ExP353e_E BK18_K95_BxBK18_150_E BK18_K95_ExBK18_220_B BK18_150_BxBK18_220_E BK18_150_ExBK18_B95e_B BK18_220_BxBK18_B95e_E BK18_220_ExW023e_B BK18_B95e_BxW023e_E BK18_B95e_ExP030e_B W023e_BxP030e_E W023e_ExW033e_B P030e_BxW033e_E P030e_ExP044e_B W033e_BxP044e_E W033e_ExP143e_B P044e_BxP143e_E P044e_ExP217e_B P143e_BxP217e_E P143e_ExP353e_B P217e_BxP353e_E BK18_K95_BxBK18_220_B BK18_K95_ExBK18_220_E BK18_150_BxBK18_B95e_B BK18_150_ExBK18_B95e_E BK18_220_BxW023e_B BK18_220_ExW023e_E BK18_B95e_BxP030e_B BK18_B95e_ExP030e_E W023e_BxW033e_B W023e_ExW033e_E P030e_BxP044e_B P030e_ExP044e_E W033e_BxP143e_B W033e_ExP143e_E P044e_BxP217e_B P044e_ExP217e_E P143e_BxP353e_B P143e_ExP353e_E BK18_K95_BxBK18_220_E BK18_K95_ExBK18_B95e_B BK18_150_BxBK18_B95e_E BK18_150_ExW023e_B BK18_220_BxW023e_E BK18_220_ExP030e_B BK18_B95e_BxP030e_E BK18_B95e_ExW033e_B W023e_BxW033e_E W023e_ExP044e_B P030e_BxP044e_E P030e_ExP143e_B W033e_BxP143e_E W033e_ExP217e_B P044e_BxP217e_E P044e_ExP353e_B P143e_BxP353e_E BK18_K95_BxBK18_B95e_B BK18_K95_ExBK18_B95e_E BK18_150_BxW023e_B BK18_150_ExW023e_E BK18_220_BxP030e_B BK18_220_ExP030e_E BK18_B95e_BxW033e_B BK18_B95e_ExW033e_E W023e_BxP044e_B W023e_ExP044e_E P030e_BxP143e_B P030e_ExP143e_E W033e_BxP217e_B W033e_ExP217e_E P044e_BxP353e_B P044e_ExP353e_E BK18_K95_BxBK18_B95e_E BK18_K95_ExW023e_B BK18_150_BxW023e_E BK18_150_ExP030e_B BK18_220_BxP030e_E BK18_220_ExW033e_B BK18_B95e_BxW033e_E BK18_B95e_ExP044e_B W023e_BxP044e_E W023e_ExP143e_B P030e_BxP143e_E P030e_ExP217e_B W033e_BxP217e_E W033e_ExP353e_B P044e_BxP353e_E BK18_K95_BxW023e_B BK18_K95_ExW023e_E BK18_150_BxP030e_B BK18_150_ExP030e_E BK18_220_BxW033e_B BK18_220_ExW033e_E BK18_B95e_BxP044e_B BK18_B95e_ExP044e_E W023e_BxP143e_B W023e_ExP143e_E P030e_BxP217e_B P030e_ExP217e_E W033e_BxP353e_B W033e_ExP353e_E BK18_K95_BxW023e_E BK18_K95_ExP030e_B BK18_150_BxP030e_E BK18_150_ExW033e_B BK18_220_BxW033e_E BK18_220_ExP044e_B BK18_B95e_BxP044e_E BK18_B95e_ExP143e_B W023e_BxP143e_E W023e_ExP217e_B P030e_BxP217e_E P030e_ExP353e_B W033e_BxP353e_E BK18_K95_BxP030e_B BK18_K95_ExP030e_E BK18_150_BxW033e_B BK18_150_ExW033e_E BK18_220_BxP044e_B BK18_220_ExP044e_E BK18_B95e_BxP143e_B BK18_B95e_ExP143e_E W023e_BxP217e_B W023e_ExP217e_E P030e_BxP353e_B P030e_ExP353e_E BK18_K95_BxP030e_E BK18_K95_ExW033e_B BK18_150_BxW033e_E BK18_150_ExP044e_B BK18_220_BxP044e_E BK18_220_ExP143e_B BK18_B95e_BxP143e_E BK18_B95e_ExP217e_B W023e_BxP217e_E W023e_ExP353e_B P030e_BxP353e_E BK18_K95_BxW033e_B BK18_K95_ExW033e_E BK18_150_BxP044e_B BK18_150_ExP044e_E BK18_220_BxP143e_B BK18_220_ExP143e_E BK18_B95e_BxP217e_B BK18_B95e_ExP217e_E W023e_BxP353e_B W023e_ExP353e_E BK18_K95_BxW033e_E BK18_K95_ExP044e_B BK18_150_BxP044e_E BK18_150_ExP143e_B BK18_220_BxP143e_E BK18_220_ExP217e_B BK18_B95e_BxP217e_E BK18_B95e_ExP353e_B W023e_BxP353e_E BK18_K95_BxP044e_B BK18_K95_ExP044e_E BK18_150_BxP143e_B BK18_150_ExP143e_E BK18_220_BxP217e_B BK18_220_ExP217e_E BK18_B95e_BxP353e_B BK18_B95e_ExP353e_E BK18_K95_BxP044e_E BK18_K95_ExP143e_B BK18_150_BxP143e_E BK18_150_ExP217e_B BK18_220_BxP217e_E BK18_220_ExP353e_B BK18_B95e_BxP353e_E BK18_K95_BxP143e_B BK18_K95_ExP143e_E BK18_150_BxP217e_B BK18_150_ExP217e_E BK18_220_BxP353e_B BK18_220_ExP353e_E BK18_K95_BxP143e_E BK18_K95_ExP217e_B BK18_150_BxP217e_E BK18_150_ExP353e_B BK18_220_BxP353e_E BK18_K95_BxP217e_B BK18_K95_ExP217e_E BK18_150_BxP353e_B BK18_150_ExP353e_E BK18_K95_BxP217e_E BK18_K95_ExP353e_B BK18_150_BxP353e_E BK18_K95_BxP353e_B BK18_K95_ExP353e_E BK18_K95_BxP353e_E"""
# Split the data into paths
entries = data.split()

# Dictionary to hold the left and right pairs
pairs_count = defaultdict(int)

# Process each entry
for entry in entries:
    if 'x' in entry:
        left, right = entry.split('x')
        pairs_count[(left, right)] += 1

# Generate a summary table
summary = []
freq_set = set()
for (left, right), count in pairs_count.items():
    summary.append((count, left, right))
    freq_set.add(left)
    freq_set.add(right)
# Sort by count
summary.sort(reverse=True, key=lambda x: x[0])

# Print the summary table
print("{:<10} {:<25} {:<25}".format("Count", "Left Path", "Right Path"))
print("-" * 60)
i = 0
for count, left, right in summary:
    i += 1
    print("{:<10} {:<25} {:<25}".format(i, left, right))
print({item: index for index, item in enumerate(freq_set)})
