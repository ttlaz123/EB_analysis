<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>EDE Update</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <!-- Load up MathJax for math notation -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
    </script>
    <script type="text/javascript" src="../mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
</head>

<body>
    <!-- Add my custom pager script -->
    <script type="text/javascript" src="scripts/pager.js"></script>
    <link rel="stylesheet" type="text/css" href="scripts/pager.css">

    <header>
        <h1>General constraints on ell-dependent polarization rotation</h1>

        <time datetime="2025 June 5" class="published updated">
            2025 June 5
        </time> —
        Tongtian (Tom) Liu, Dominic Beck
    </header>

    <hr>
    <section>
        <h2>Introduction</h2>
        <p><strong>Summary:</strong>  
    This posting presents follow-up analysis on the Early Dark Energy (EDE) signal in BICEP data, 
    focusing on further MCMC fits and addressing simulation-related systematics identified in previous work.  
    We assess how fitting different EB curves impacts the inferred coupling parameter \(g\),  
    and introduce a new angular-scale-dependent birefringence analysis to test for potential scale dependence 
    in the signal.
  </p>

        <p>This posting builds upon previous updates:</p>
        <ul>
            <li><a
                    href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20240924_preliminary_eb_ede_results/">
                    2024-09-24: Preliminary EB EDE Results</a></li>
            <li><a
                    href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20241203_multicomp_eb_ede_update/">
                    2024-12-03: Multicomponent EB EDE Update</a></li>
            <li><a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20250218_ede_forecast/">
                    2025-02-18: EDE Forecast</a></li>
            <li><a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20250513_dust_eb_ede_update/">
                    2025-05-13: Dust analysis</a></li>

        </ul>
        <p>
    We revisit the issue raised in the May 13 dust analysis regarding bias in the 
    maximum-likelihood (ML) estimator caused by the BB spectra.  
    We identify that the bias is due to excess signal in the BB simulations.
  </p>
   <p>
    We also rerun the MCMC fits for EB using a range of EDE parameters.  
    In particular, we test how different theoretical EDE parameters affect the inferred value of \(g\)
    as well as the rotation angles alpha, even when the simulated data uses a different set of EDE parameters.
  </p>
      <p>
    In addition, we implement an angular-scale dependent birefringence analysis.  
    We divide the multipole range into bins and fit independent rotation angles in each.  
    Comparing the resulting angle fits across binning schemes allows us to check for consistency 
    and any potential l-dependence in the signal.
  </p>
    </section>


    <section>
        <h2>BB spectra comparison</h2>
        <p>
    We begin by plotting the BB and EB spectra from the simulations. Each plot shows 499 simulated 
    curves overlaid in gray. The <span style="color:rgb(116, 116, 238);">blue shaded area</span> represents the 68% 
    confidence band (i.e., the central range containing 68% of the simulations), while the 
    <span style="color:red;">red line</span> shows the mean spectrum across all simulations for each bin.
  </p>

  <p>
    The BB and EB spectra are compared against the expected input signals used to generate the simulations.  
    In particular, the <code>Sigl</code> curves represent the signal-only case (no dust, no noise), including 
    only the primary CMB plus lensing. This serves as a useful baseline for verifying the fidelity 
    of the simulations and the consistency of the injected EDE signal.
  </p>
        <figure>
            <img alt="BB curves" id="bbcomp" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
             <figcaption>
  Comparison of BB and EB spectra across 499 simulations.  
 
  <ul>
    <li><strong>Spectrum type:</strong> 
      <em>BB</em> (total BB spectrum), 
      <em>BB Sigl</em> (BB signal-only without dust or noise), or 
      <em>EB</em> (total EB spectrum).</li>
    <li><strong>Injected EDE signal:</strong> 
      <em>Fede = 0.07, g = 1</em> shows simulations with an injected Early Dark Energy signal, 
      while <em>g = 0</em> corresponds to the null case with no EDE signal.</li>
  </ul>
  Each plot displays all 499 simulation realizations as gray lines.  
  The <span style="color:blue;">blue band</span> indicates the 68% confidence interval across simulations,  
  and the <span style="color:red;">red line</span> shows the mean spectrum in each bin.
</figcaption>

            <script type="text/javascript">
               

                pager.link("#bbcomp", {
                   
                    
                    'Spectra|spectro': [
                        'BB|BB',
                        'BB Sigl|BB_sigl',
                        'EB|EB',
                        'EE|EE',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
         
                    function (params) {
                        let dirbase = '/liuto/home/GitHub/EB_analysis/'
                        let dirpath = dirbase + '/overlay_plots/';
                        let file = params.ede + '_overlay_confband_' + params.spectro
                        let name = dirpath + file +  '.png';
            
                        console.log(name);
                        return name;
                    });

                pager.setparams({
        
                    'ede': 'zeroeb',
                    'spectro': 'BB',
                });
            </script>
        </figure>
        <p>
  Differences between the BB curves become especially apparent in the BB sigl plots
  when comparing the <em>g = 1</em> and <em>g = 0</em> cases. In contrast, the EE curves
  remain largely similar between these two cases.
</p>
<p>
  As expected, the EB curves center around zero when <em>g = 0</em> (no injected EDE), while
  they resemble a scaled version of EE when <em>g = 1</em> (with EDE injection), consistent with
  theoretical expectations that cosmic birefringence mixes E and B modes.
</p>
<p>
  To better illustrate these differences, we plot the bin-by-bin differences between the mean EE
  and BB spectra for each case. For EE, the difference straddles zero, suggesting minimal change
  between <em>g = 0</em> and <em>g = 1</em>. However, for BB, there is a clear and consistent
  positive excess when EDE is injected.
</p>
  Notably, the BB excess signal is approximately 10% of the peak BB sigl amplitude, whereas the
  EE difference remains within 5% of its peak, as seen by comparing the vertical axis ranges.
</p>
            <figure>
            <img alt="BB Diffs" id="bbdiff" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
             <figcaption>
    Plot showing the difference between the mean spectra for <em>g = 1</em> and
    <em>g = 0</em> cases.
    <ul>
      <li><strong>Data type:</strong>
        Choose <em>Signal + lensing</em> for signal-only simulations (no dust or noise), or
        <em>+Dust+Noise</em> for fully simulated datasets.</li>
      <li><strong>Spectrum:</strong>
        Toggle between <em>BB</em> and <em>EE</em> to see how EDE injection impacts each.</li>
    </ul>
    The gray curves represent simulation realizations, the <span style="color:blue;">blue band</span> shows
    the 68% spread, and the <span style="color:red;">red line</span> indicates the mean difference.
  </figcaption>

            <script type="text/javascript">
               

                pager.link("#bbdiff", {
                   
                    
                    'Data type|dtype': [
                        'Signal + lensing|_sigl',
                        '+Dust+Noise|'
                    ],
                    'Spectra|spectrq': [
                        'BB|BB',
                        'EE|EE',
                    ],
                },
         
                    function (params) {
                        let dirbase = '/liuto/home/GitHub/EB_analysis/'
                        let dirpath = dirbase + '/overlay_plots/';
                        let file = 'diff_overlay_confband_' + params.spectrq + params.dtype 
                        let name = dirpath + file +  '.png';
            
                        console.log(name);
                        return name;
                    });

                pager.setparams({
        
                    'dtype': '_sigl',
                });
            </script>
        </figure>
        <p>
  Going forward, we can further verify the origin of the BB excess signal through several approaches.
  One option is to rerun the MCMC analysis using a more realistic BB model that accounts for 
  additional contributions from EB and EE leakage via lensing, the currently hypothesized source of this excess signal. 
  This would help confirm the robustness of the 
  estimator under more complete modeling of the BB spectrum.
</p>
<p>
  Alternatively, we can revisit the simulation pipeline itself to better control for unwanted 
  excess in the BB signal, ensuring that only the intended signal components (e.g., lensing, 
  injected birefringence) are included and that the BB spectrum is not affected by these components.
</p>
<p>
  These investigations reinforce that the issue identified in the previous analysis is not 
  a bug in the estimator, but rather a mismatch between the BB signal in our simulations 
  and the assumed BB model used in the MCMC fit. The estimator provides unbiased 
  fits for <em>g</em> and rotation angle as long as the simulated BB is consistent with the model.
</p>
<p>
  For real data, this means we must carefully check whether the inclusion of BB in the likelihood 
  alters the best-fit values. A shift would imply that BB is indeed seeing excess rotation. 
  The magnitude of this shift could potentially indicate a true physical signal and 
  can be characterized by the estimator bias due to unmodeled BB structure.
</p>

<p>
    One proposal was to multiply the BB spectra by a lensing amplitude parameter A_lens. 
    We run the MCMC chains for this proposal below: 
</p>
<figure>
            <img alt="Lensing Amplitude" id="alens" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
    We generate new MCMC chains with A_lens scaling the BB spectrum
</figcaption>
            <script type="text/javascript">
               function pad(num, size) {
                    num = num.toString();
                    while (num.length < size) num = "0" + num;
                    return num;
                }
                const simnums = [];
                for (let i = 0; i < 10; i++) {
                    s = pad(i, 1);

                    simnums[i] = s.concat('|', s);

                }

                pager.link("#alens", {
                    'Map Sim Num Digit1|digit1': simnums,
                    'Digit2|digit2': simnums,
                    'Digit3|digit3': simnums,

                    'Map Type|m_map_type': [
                        'Best Fit EE|_bestfitEE',
                        'Best Fit EB|_bestfitEB',
                        'Best Fit BB|_bestfitBB',
                        'Triangle Plot|_triangle_plot',
                        'Summary Plot (Peaks histogram)|sim1_summary',
                        'Chi Squared histogram|simchisq_hist'
                    ],
                    
                    'Bins Used|bin_num': [
                        '2-15|_bin2-15',
                    ],
                   
                    'Spectra|spectral': [
                        'EB Only|_eb',
                        'No BB|_nob',
                        'All|_all',
                        'All, BB scaled|_alens',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
         
                    function (params) {
                        let dirbase = '/liuto'
                        let dirpath = dirbase + '/ede_chains/';
                        let mcmc_folder = params.ede + params.bin_num  + '_sigl'+ params.spectral+'_ebfede0.07/';
                        let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
                        let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
                        if (params.m_map_type == 'sim1_summary' || params.m_map_type == 'simchisq_hist') {
                            name = dirpath + mcmc_folder + params.m_map_type + '.png'
                        }
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'digit1': '0',
                    'digit2': '0',
                    'digit3': '1',
                    'bin_num':'_bin2-15',
                    'ede': 'zeroeb',
                    'spectral': '_alens',
                });
            </script>
        </figure>
        <p>
            Allowing the BB spectra to be scaled by A_lens does decrease the bias in the EDE dataset 
            to within the 68% confidence interval, but it also increases the bias slightly 
            in the no EDE dataset. We should consider whether the trade off is worth including the A_lens parameter.
        </p>
    </section>
    <section>
        <h2>Alternative EB curves with different EDE parameters</h2>
       <p>
    We rerun the MCMC fits for EB-only using alternative theoretical EB spectra generated 
    from <a href="https://github.com/doicbek/class_private">CLASS</a>, with best-fit parameters 
    from <a href="https://arxiv.org/pdf/2303.15369">Eskilt et al.</a> Each EB curve corresponds 
    to a different EDE model motivated by recent cosmological datasets. Note that the 
    <code>f<sub>EDE</sub> = 0.07</code> case is the same fiducial model used throughout our 
    previous analyses.
</p>
<figure>
            <img alt="BB Diffs" id="edecurves" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
             <figcaption>
    Plot showing the different EB curves generated using different Early Dark Energy parameters
  </figcaption>

            <script type="text/javascript">
               

                pager.link("#edecurves", {
                   
                    
                   
                },
         
                    function (params) {
                        let dirbase = '/liuto/home/GitHub/EB_analysis/'
                        let dirpath = dirbase + '/zscore_histograms/';
                        let file = 'eb_ee_plot' 
                        let name = dirpath + file +  '.png';
            
                        console.log(name);
                        return name;
                    });

                pager.setparams({
        
                });
            </script>
        </figure>
        <p>Using the different EB plots, we generate the MCMC chains below.</p>
        <figure>
            <img alt="EDE params" id="fede" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
    Explore different MCMC fit results and diagnostic plots:<br><br>
    <strong>Map Sim Num Digit1, Digit2, Digit3:</strong> Select the simulation instance by its digit indices (0–9), viewing individual simulation chain results.<br><br>
    <strong>Map Type:</strong> Choose the type of plot:<br>
    &nbsp;&nbsp;- <em>Best Fit EE/EB/BB:</em> Shows the MCMC best-fit parameter constraints for each polarization spectrum.<br>
    &nbsp;&nbsp;- <em>Triangle Plot:</em> Displays joint posterior distributions and parameter correlations.<br>
    &nbsp;&nbsp;- <em>Summary Plot (Peaks histogram):</em> Histogram summarizing the distribution of peak values in the MCMC chains.<br>
    &nbsp;&nbsp;- <em>Chi Squared histogram:</em> Distribution of chi-squared goodness-of-fit values across simulations.<br><br>
    <strong>EDE parameters:</strong> Select different Early Dark Energy models based on f<sub>EDE</sub> values from various datasets:<br>
    • <a href="https://arxiv.org/abs/2503.14454">ACT</a> data (f<sub>EDE</sub> ≈ 0.012).<br>
    • <a href="https://arxiv.org/pdf/2210.16296">Planck</a> data (f<sub>EDE</sub> ≈ 0.070).<br>
    • <a href="https://arxiv.org/pdf/2210.16296">Planck + BOSS</a> (f<sub>EDE</sub> ≈ 0.087).<br>
    • <a href="https://arxiv.org/pdf/2210.16296">Planck + BOSS + SH0ES</a> (f<sub>EDE</sub> ≈ 0.127).<br><br>
   
    <strong>Bins Used:</strong> Select the multipole bin range used in the fit (currently fixed to bins 2–15).<br><br>
    <strong>Dust model:</strong> Currently fixed to 'Fixed Dust = 0', indicating no dust contamination is modeled.<br><br>
    <strong>Spectra:</strong> Choose which spectra to fit; here it is EB only.<br><br>
    <strong>Injected EDE Signal:</strong> Select whether the simulations include an injected EDE signal (f<sub>EDE</sub>=0.07, g=1) or no signal (g=0).<br><br>
    
</figcaption>
            <script type="text/javascript">
           
                pager.link("#fede", {
                    'Map Sim Num Digit1|digit1': simnums,
                    'Digit2|digit2': simnums,
                    'Digit3|digit3': simnums,

                    'Map Type|m_map_type': [
                        'Best Fit EE|_bestfitEE',
                        'Best Fit EB|_bestfitEB',
                        'Best Fit BB|_bestfitBB',
                        'Triangle Plot|_triangle_plot',
                        'Summary Plot (Peaks histogram)|sim1_summary',
                        'Chi Squared histogram|simchisq_hist'
                    ],
                    'EDE parameters|fede': [
                        'f_EDE = 0.012 (ACT)|_ebfede0.01',
                        'f_EDE = 0.070 (Planck)|_ebfede0.07',
                        'f_EDE = 0.087 (Planck Boss)|_ebfede0.09',
                        'f_EDE = 0.127 (Planck Boss SH0ES)|_ebfede0.13',
                    ], 
                    'Bins Used|bin_num': [
                        '2-15|_bin2-15',
                    ],
                    'Dust model|theory_compf': [
                        'Fixed Dust = 0|_fixed_dust',
                    ],
                    'Spectra|spectra': [
                        'EB only|_eb',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
         
                    function (params) {
                        let dirbase = '/liuto'
                        let dirpath = dirbase + '/ede_chains/';
                        let mcmc_folder = params.ede + params.bin_num  + params.theory_compf + params.spectra+ params.fede +'/';
                        let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
                        let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
                        if (params.m_map_type == 'sim1_summary' || params.m_map_type == 'simchisq_hist') {
                            name = dirpath + mcmc_folder + params.m_map_type + '.png'
                        }
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'digit1': '0',
                    'digit2': '0',
                    'digit3': '1',
                    'inj_sig': '',
                    'bin_num':'_bin2-15',
                    'fede':'_ebfede0.07',
                    'ede': 'zeroeb',
                    'spectra': '_eb',
                    'theory_compf': '_fixed_dust',
                });
            </script>
        </figure>

        <h3>g = 0</h3>
<table border="1" cellpadding="6" cellspacing="0">
  <thead>
    <tr>
      <th>Parameter</th>
      <th>fede = 0.012</th>
      <th>fede = 0.07</th>
      <th>fede = 0.087</th>
      <th>fede = 0.127</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>alpha_BK18_220</td>
      <td>-0.00 ± 0.21</td>
      <td>-0.02 ± 0.27</td>
      <td>-0.01 ± 0.22</td>
      <td>0 ± 0.17</td>
    </tr>
    <tr>
      <td>alpha_BK18_150</td>
      <td>-0.01 ± 0.14</td>
      <td>-0.02 ± 0.21</td>
      <td>-0.01 ± 0.16</td>
      <td>0 ± 0.10</td>
    </tr>
    <tr>
      <td>alpha_BK18_K95</td>
      <td>-0.02 ± 0.25</td>
      <td>-0.03 ± 0.32</td>
      <td>-0.04 ± 0.26</td>
      <td>-0.01 ± 0.23</td>
    </tr>
    <tr>
      <td>alpha_BK18_B95lf</td>
      <td>-0.01 ± 0.13</td>
      <td>-0.03 ± 0.22</td>
      <td>-0.01 ± 0.15</td>
      <td>-0.01 ± 0.07</td>
    </tr>
    <tr>
      <td>g</td>
      <td>0.11 ± 1.1</td>
      <td>0.02 ± 0.46</td>
      <td>0.04 ± 0.41</td>
      <td>0.03 ± 0.35</td>
    </tr>
  </tbody>
</table>

<h3>g = 1</h3>
<table border="1" cellpadding="6" cellspacing="0">
  <thead>
    <tr>
      <th>Parameter</th>
      <th>fede = 0.012</th>
      <th>fede = 0.07</th>
      <th>fede = 0.087</th>
      <th>fede = 0.127</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>alpha_BK18_220</td>
      <td>0.20±0.21</td>
      <td>0 ± 0.30</td>
      <td>0.13 ± 0.23</td>
      <td>0.34 ± 0.19</td>
    </tr>
    <tr>
      <td>alpha_BK18_150</td>
      <td>0.20 ± 0.15</td>
      <td>0 ± 0.23</td>
      <td>0.12 ± 0.16</td>
      <td>0.35 ± 0.10</td>
    </tr>
    <tr>
      <td>alpha_BK18_K95</td>
      <td>0.19 ± 0.24</td>
      <td>0 ± 0.29</td>
      <td>0.12 ± 0.25</td>
      <td>0.35 ± 0.23</td>
    </tr>
    <tr>
      <td>alpha_BK18_B95lf</td>
      <td>0.20 ± 0.13</td>
      <td>0 ± 0.23</td>
      <td>0.13 ± 0.15</td>
      <td>0.36 ± 0.07</td>
    </tr>
    <tr>
      <td>g</td>
      <td>2.29 ± 1.2</td>
      <td>0.97 ± 0.45</td>
      <td>0.89 ± 0.42</td>
      <td>0.75 ± 0.37</td>
    </tr>
  </tbody>
</table>


    <p>
    The two tables report best-fit polarization rotation angles (<code>α</code>) for different BK18 frequency bands,
    along with the early dark energy (EDE) axion coupling parameter <code>g</code>, under two scenarios:
    <code>g = 0</code> (no coupling) and <code>g = 1</code> (strong coupling). Each case is evaluated for different
    EDE energy fractions <code>f<sub>EDE</sub></code>.
  </p>
   <h4>1. <code>g = 0</code> (No Axion Coupling)</h4>
  <ul>
    <li>Rotation angles <code>α</code> are consistent with zero within uncertainties across all bands and EDE fractions.<br></li>
    <li>The fitted <code>g</code> values are near zero, with large error bars (~0.35–0.46), as expected.<br></li>
    <li>No dependence on <code>f<sub>EDE</sub></code> is observed, indicating no spurious detection of rotation or coupling.<br></li>
  </ul>

  <h4>2. <code>g = 1</code> Case (Large Coupling)</h4>
  <ul>
    <li>Rotation angles <code>α</code> become increasingly positive with larger <code>f<sub>EDE</sub></code> values.<br></li>
    <li><code>g</code> is recovered close to 1 when the injected <code>f<sub>EDE</sub></code> curve matches the model used in fitting.<br></li>
    <li>When mismatched curves are used (e.g., fitting <code>f<sub>EDE</sub> = 0.087</code> when the injected signal was <code>f<sub>EDE</sub> = 0.07</code>),
        <code>g</code> shifts downward and <code>α</code> increases to compensate.<br></li>
    <li>This tradeoff reflects how the estimator reallocates the signal between scale-dependent coupling and uniform rotation.<br></li>
  </ul>
  <p>
    When no EDE signal is injected, the estimator accurately recovers both <code>g ≈ 0</code> and <code>α ≈ 0</code>.
    With an injected signal, recovery depends on how well the model curve matches the simulation. If the model exactly matches
    the injected <code>f<sub>EDE</sub></code> (e.g., 0.07), <code>g = 1</code> is recovered cleanly, and all rotation angles remain zero.
    However, when the model curve deviates from the injected one, the recovered <code>g</code> decreases, and the rotation angles
    increase to absorb the mismatch. This tradeoff becomes more pronounced at higher <code>f<sub>EDE</sub></code>, revealing the
    degeneracy between <code>g</code> and <code>α</code> in those regimes.
  </p>
<p>
    For real data, this implies that comparing results across different <code>f<sub>EDE</sub></code> model curves can serve as
    a diagnostic: if the recovered <code>g</code> and <code>α</code> change significantly across models, it could indicate
    the presence of a true EDE signal. We quantify these comparisons by using the Z-score:
  </p>

   \[ Z = \frac{\mu_1 - \mu_2}{\sqrt{\sigma_1^2 + \sigma_2^2}} \]
  <p>
    where:
    <ul>
      <li><strong>μ₁</strong> and <strong>μ₂</strong> are the posterior means</li>
      <li><strong>σ₁</strong> and <strong>σ₂</strong> are the standard deviations of the posteriors</li>
    </ul>
  </p>

  <p>
    This metric is useful because it takes into account both the magnitude of the shift in the mean values and the uncertainties
    associated with those estimates. A large Z-score implies that the two posterior peaks are significantly separated
    relative to their widths, suggesting a model-dependent shift that may reflect physical sensitivity to <code>f<sub>EDE</sub></code>.
  </p>


 <figure>
            <img alt="Z Scores" id="zscoref" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
                
            </figcaption>

            <script type="text/javascript">
               

                pager.link("#zscoref", {
                   
                    'Parameter|anglef':[
                        'alpha_BK18_150|alpha_BK18_150',
                        'alpha_BK18_K95|alpha_BK18_K95',
                        'alpha_BK18_B95lf|alpha_BK18_B95e',
                        'alpha_BK18_220|alpha_BK18_220',
                        'g|gMpl',
                    ],
                 
                    
                    'Model compare 1|binset1f':[
                        'f_EDE = 0.012 (ACT)|_ebfede0.01',
                        'f_EDE = 0.070 (Planck)|_ebfede0.07',
                        'f_EDE = 0.087 (Planck Boss)|_ebfede0.09',
                        'f_EDE = 0.127 (Planck Boss SH0ES)|_ebfede0.13',
                    ],
                    'Model compare 2|binset2f':[
                        'f_EDE = 0.012 (ACT)|_ebfede0.01',
                        'f_EDE = 0.070 (Planck)|_ebfede0.07',
                        'f_EDE = 0.087 (Planck Boss)|_ebfede0.09',
                        'f_EDE = 0.127 (Planck Boss SH0ES)|_ebfede0.13',
                    ],
                
        
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
         
                    function (params) {
                        let dirbase = '/liuto/home/GitHub/EB_analysis/'
                        let dirpath = dirbase + '/zscore_histograms/';
                        let zscore1 = params.anglef + '_' + params.ede + '_bin2-15_fixed_dust_eb' + params.binset1f 
                        let zscore2 = params.ede + '_bin2-15_fixed_dust_eb' + params.binset2f ;
                        
                        let name = dirpath + 'zscore_hist_' + zscore1 + '_' + zscore2 +  '.png';
            
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'anglef': 'gMpl',
                    'binset1f': '_ebfede0.07',
                    'binset2f': '_ebfede0.09',
                    'ede': 'zeroeb',
                });
            </script>
        </figure>
    
 <h3>Z-Score Comparison for alpha_BK18_150</h3>

<div style="display: flex; gap: 40px; flex-wrap: wrap;">

  <div style="flex: 1; min-width: 300px;">
    <h4>Case: <code>g = 0</code> (No Axion Coupling)</h4>
    <table border="1" cellspacing="0" cellpadding="4" style="width: 100%;">
      <tr>
        <th>Model 2 →<br>Model 1 ↓</th>
        <th>f<sub>EDE</sub> = 0.012</th>
        <th>0.07</th>
        <th>0.087</th>
        <th>0.127</th>
      </tr>
      <tr><td>0.12</td><td>0</td>         <td>0.01±0.52</td> <td>0.01±0.28</td>  <td>-0.04±0.58</td></tr>
      <tr><td>0.07</td><td>-0.01±0.52</td><td>0</td>          <td>0±0.38</td>     <td>-0.04±0.92</td></tr>
      <tr><td>0.087</td><td>-0.01±0.28</td><td>0±0.38</td>    <td>0</td>          <td>-0.05±0.74</td></tr>
      <tr><td>0.127</td><td>0.04±0.58</td> <td>0.04±0.92</td> <td>0.05±0.74</td>  <td>0</td></tr>
    </table>
  </div>

  <div style="flex: 1; min-width: 300px;">
    <h4>Case: <code>g = 1</code> (Injected Axion Coupling)</h4>
    <table border="1" cellspacing="0" cellpadding="4" style="width: 100%;">
      <tr>
        <th>Model 2 →<br>Model 1 ↓</th>
        <th>f<sub>EDE</sub> = 0.012</th>
        <th>0.07</th>
        <th>0.087</th>
        <th>0.127</th>
      </tr>
      <tr><td>0.12</td><td>0</td>         <td>0.91±1.24</td> <td>0.37±1.21</td>  <td>-1.08±0.64</td></tr>
      <tr><td>0.07</td><td>-0.91±1.24</td><td>0</td>          <td>-0.59±0.41</td> <td>-1.79±1.27</td></tr>
      <tr><td>0.087</td><td>-0.37±1.21</td><td>-0.59±0.41</td><td>0</td>          <td>-1.42±1.23</td></tr>
      <tr><td>0.127</td><td>1.08±0.64</td> <td>1.79±1.27</td> <td>1.42±1.23</td>  <td>0</td></tr>
    </table>
  </div>

</div>

<h3>Z-Score Comparison for gMpl</h3>

<div style="display: flex; gap: 40px; flex-wrap: wrap;">

  <div style="flex: 1; min-width: 300px;">
    <h4>Case: <code>g = 0</code> (No Axion Coupling)</h4>
    <table border="1" cellspacing="0" cellpadding="4" style="width: 100%;">
      <tr>
        <th>Model 2 →<br>Model 1 ↓</th>
        <th>f<sub>EDE</sub> = 0.012</th>
        <th>0.07</th>
        <th>0.087</th>
        <th>0.127</th>
      </tr>
      <tr>
        <td>0.12</td><td>0</td><td>0.06±0.73</td><td>0.05±0.77</td><td>0.06±0.83</td>
      </tr>
      <tr>
        <td>0.07</td><td>-0.06±0.73</td><td>0</td><td>-0.01±0.27</td><td>0±0.3</td>
      </tr>
      <tr>
        <td>0.087</td><td>-0.05±0.77</td><td>0.01±0.27</td><td>0</td><td>0.02±0.23</td>
      </tr>
      <tr>
        <td>0.127</td><td>-0.06±0.83</td><td>0±0.3</td><td>-0.02±0.23</td><td>0</td>
      </tr>
    </table>
  </div>

  <div style="flex: 1; min-width: 300px;">
    <h4>Case: <code>g = 1</code> (Injected Axion Coupling)</h4>
    <table border="1" cellspacing="0" cellpadding="4" style="width: 100%;">
      <tr>
        <th>Model 2 →<br>Model 1 ↓</th>
        <th>f<sub>EDE</sub> = 0.012</th>
        <th>0.07</th>
        <th>0.087</th>
        <th>0.127</th>
      </tr>
      <tr>
        <td>0.12</td><td>0</td><td>1.30±1.23</td><td>1.39±1.22</td><td>1.54±0.87</td>
      </tr>
      <tr>
        <td>0.07</td><td>-1.30±1.23</td><td>0</td><td>0.15±0.28</td><td>0.42±1.24</td>
      </tr>
      <tr>
        <td>0.087</td><td>-1.39±1.22</td><td>-0.15±0.28</td><td>0</td><td>0.29±1.23</td>
      </tr>
      <tr>
        <td>0.127</td><td>-1.54±0.87</td><td>-0.42±1.24</td><td>-0.29±1.23</td><td>0</td>
      </tr>
    </table>
  </div>

</div>


  <h4>Interpretation</h4>
   <p>
    Each cell in the tables represents the normalized difference in log-likelihoods (Z-score) between two EB models with different values of 
    <code>f<sub>EDE</sub></code>. These values are symmetric across the diagonal, consistent with the definition of the Z-score:
  </p>

  <h3>Case: <code>g = 0</code> (No Axion Coupling)</h3>

  <ul>
    <li>Across <strong>all parameters</strong> (alpha_BK18_150, gMpl, etc.), the Z-scores are very close to zero.</li>
    <li>Different EB curves with different f_EDE values do not lead to distinguishable differences in parameter posteriors under the null coupling case.</li>
    <li>The differences in parameter values are small compared to the uncertainties when comparing the different models.</li>
  </ul>

   <h3>Case: <code>g = 1</code> (Injected Axion Coupling)</h3>

  <ul>
    <li>Z-scores show larger deviations, especially when comparing high EDE fractions (e.g., 0.127) to low (e.g., 0.012).</li>
    <li>For example:
      <ul>
        <li><code>α<sub>BK18_150</sub></code>: comparing 0.127 → 0.012 yields <strong>Z = 1.08 ± 0.64</strong></li>
        <li><code>g<sub>Mpl</sub></code>: 0.127 → 0.012 yields <strong>Z = 1.54 ± 0.87</strong></li>
      </ul>
    </li>
    <li>These shifts suggest that with EDE axion coupling at g=1, the parameters becomes more sensitive to the modeled EB spectrum.</li>
    <li>Still, most differences remain within 2σ.</li>
  </ul>

  <p>
    Overall, these results support the strategy of scanning across <code>f<sub>EDE</sub></code> model curves: 
    if the best-fit parameters are significantly different depending on the model EB curve, 
    it could point to the presence of a true EDE signal. 

  </p>


    </section>
    <section>
        <h2>L dependent rotation Bin split 2-8 and 9-15</h2>
        <p>
    This analysis investigates scale-dependent rotation angles derived from EB spectra using a multicomponent model.
    The analysis focuses solely on polarization rotation without assuming any Early Dark Energy (EDE) model, thus g is set to 0.
    The data is split into two multipole bin ranges: low-L (bins 2-8) and high-L (bins 9-15), to explore possible 
    scale-dependent systematic or physical effects.
  </p>
    <p>
    To quantify differences between these bin ranges, rotation angles are computed independently in each bin set,
    and their difference is analyzed using z-scores. This enables identification of statistically significant 
    bin-dependent rotation effects. First, we generate the MCMC chains for each set of bin ranges.
  </p>
  <p>
    The rotation angles for each injected signal set is as follows for the angles in order: BK18_220, BK18_150, BK18_K95, and BK18_B95e
            (B95lf)
    <ul>
                            <li>No Miscalibration: Nothing is injected</li>
                            <li>Positive Miscalibration: Injected rotation of 0, 0.25, 0.5, 0.75</li>
                            <li>Negative Miscalibration: Injected rotation of 0, -0.25, -0.5, -0.75</li>
                            <li>Blanaced Miscalibration: Injected rotation of 0.5, 0, -0,5, -1</li>

                        </ul>
  </p>
 <figure>
            <img alt="Multicomponent Analysis Spectrum" id="morebins" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
                <p>Pager for multicomponent analysis of the Early Dark Energy (EDE) spectrum across 499 simulations.</p>
  <p>Options include:</p>
  <ul>
    <li><strong>Map Type:</strong> Best Fit EE, Best Fit EB, Best Fit BB, Triangle Plot, Summary Plot (Peaks histogram), Chi Squared histogram</li>
    <li><strong>Bins Used:</strong> 2-8, 9-15, 2-15</li>
    <li><strong>Injected Signal:</strong> Positive Miscalibration, Negative Miscalibration, Balanced Miscalibration, No Miscalibration</li>
    <li><strong>Model:</strong> Rotation Only</li>
    <li><strong>Spectra:</strong> EB only</li>
    <li><strong>Injected EDE Signal:</strong> Fede = 0.07, g = 1; or g = 0 (no EDE)</li>
    <li><strong>Simulation Number:</strong> 001 to 499</li>
  </ul>
            </figcaption>

            <script type="text/javascript">
                

                pager.link("#morebins", {
                    'Map Sim Num Digit1|digit1': simnums,
                    'Digit2|digit2': simnums,
                    'Digit3|digit3': simnums,

                    'Map Type|m_map_type': [
                        'Best Fit EE|_bestfitEE',
                        'Best Fit EB|_bestfitEB',
                        'Best Fit BB|_bestfitBB',
                        'Triangle Plot|_triangle_plot',
                        'Summary Plot (Peaks histogram)|sim1_summary',
                        'Chi Squared histogram|simchisq_hist'
                    ],
                    'Bins Used|bin_num15': [
                        '2-8|_bin2-8',
                        '9-15|_bin9-15',
                        '2-15|_bin2-15',
                    ],
                    'Injected Signal|inj_sig': [
                        'Positive Miscalibration|_sigpos',
                        'Negative Miscalibration|_signeg',
                        'Balanced Miscalibration|_sigbal',
                        'No Miscalibration|'
                    ],
                    'Model|theory_comp': [
                        'Rotation Only|_det_polrot',
                    ],
                    'Spectra|spectra': [
                        'EB only|_eb',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
                    function (params) {
                        let dirbase = '/liuto'
                        let dirpath = dirbase + '/ede_chains/';
                        let mcmc_folder = params.ede + params.bin_num15 + params.theory_comp + params.spectra + params.inj_sig+ '/';
                        let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
                        let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
                        if (params.m_map_type == 'sim1_summary' || params.m_map_type == 'simchisq_hist') {
                            name = dirpath + mcmc_folder + params.m_map_type + '.png'
                        }
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'digit1': '0',
                    'digit2': '0',
                    'digit3': '1',
                    'inj_sig': '',
                    'm_map_type': 'sim1_summary',
                    'bin_num15': '_bin2-15',
                    'ede': 'zeroeb',
                    'spectra': '_eb',
                    'theory_comp': '_det_polrot',
                });
            </script>
        </figure>
        <p>
  Looking at the summary plots, we see that when <em>g = 0</em>, the rotation angles stay well within
  the range of the injected miscalibration angles and are essentially the same for both low and high ℓ.
  However, when <em>g = 1</em>, the high-ℓ bins consistently show higher posterior angle peaks,
  indicating that the rotation angles now depend on ℓ.
  This matches the expectation that the <em>g = 1</em> EB spectrum is a rotated version of EE,
  but with different rotation angles at different multipoles.
</p>

<p>
  To demonstrate how choosing different bin sets affects the likelihood calculations,
  we overlay contour plots from each bin set.
  The blue contour represents the combined likelihood using all bins,
  and it visually confirms consistency with the individual red (high-ℓ) and gray (low-ℓ) contours,
  while also providing tighter constraints overall.
  In this dataset, the red contours are noticeably tighter than the gray ones,
  showing that the high-ℓ bins have significantly stronger constraining power than the low-ℓ bins.
</p>

      <figure>
            <img alt="Bin diffs" id="bindiff" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
           <figcaption>
    <p>
      Bin difference analysis showing overlaid contours: red for high multipole bins, 
      gray for low multipole bins, and blue for all bins combined.
    </p>
    <p>Options include:</p>
    <ul>
      <li><strong>Simulation Number:</strong> 001 to 499</li>
      <li><strong>Injected Signal:</strong> Positive, Negative, Balanced Miscalibration, or None</li>
      <li><strong>Model:</strong> Detector Polarization Rotation Only</li>
      <li><strong>Spectra:</strong> EB cross-power spectrum only</li>
      <li><strong>Injected EDE Signal:</strong> Early Dark Energy with Fede=0.07, g=1, or no EDE (g=0)</li>
    </ul>
  </figcaption>

            <script type="text/javascript">
               

                pager.link("#bindiff", {
                    'Map Sim Num Digit1|digit1': simnums,
                    'Digit2|digit2': simnums,
                    'Digit3|digit3': simnums,

                 
                    'Injected Signal|inj_sig': [
                        'Positive Miscalibration|_sigpos',
                        'Negative Miscalibration|_signeg',
                        'Balanced Miscalibration|_sigbal',
                        'No Miscalibration|'
                    ],
                    'Model|theory_comp': [
                        'Rotation Only|_det_polrot',
                    ],
                    'Spectra|spectra': [
                        'EB only|_eb',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
         
                    function (params) {
                        let dirbase = '/liuto'
                        let dirpath = dirbase + '/ede_chains/bindiffs2-8,9-15,2-15/';
                        let mcmc_folder = params.ede + params.theory_comp + params.spectra + params.inj_sig+ '/';
                        let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
                        let name = dirpath + mcmc_folder + sim_id  + '.png';
            
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'digit1': '0',
                    'digit2': '0',
                    'digit3': '1',
                    'inj_sig': '',
                    'ede': 'zeroeb',
                    'spectra': '_eb',
                    'theory_comp': '_det_polrot',
                });
            </script>
        </figure>
        <p>
  To quantify the difference in the posteriors when comparing high-ell and low-ell bins, we calculate 
  the Z-score between the rotation angle posteriors derived from each bin set. The Z-score is computed 
  for each individual simulation realization, where \(\mu_1\) and \(\sigma_1\) are taken from the 
  posterior fitted using the low-ell bins, and \(\mu_2\) and \(\sigma_2\) from the high-ell bins.
</p>

<p>
  This yields a Z-score for each simulation realization, resulting in 499 Z-scores per rotation angle. 
  These are plotted as histograms to visualize the distribution of differences between the two bin sets. 
  We apply a simple Gaussian fit to each histogram to extract its peak and width.
</p>

<p>
  When analyzing real data, the observed Z-score can be compared to these histograms to assess whether 
  the difference between high-ell and low-ell is statistically significant and to which injected 
  scenario it is most consistent.
</p>
        <figure>
            <img alt="Z Scores" id="zscore" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
                <p>Z-score histogram showing statistical significance of polarization angle differences.</p>
  <p>Selectable options:</p>
  <ul>
    <li><strong>Angle:</strong> Polarization rotation angles measured from different BICEP frequency bands (150 GHz, K95, B95lf, 220 GHz).</li>
    <li><strong>Injected Signal:</strong> Type of simulated miscalibration applied to the data — positive, negative, balanced, or no miscalibration.</li>
    <li><strong>Bin sets compared:</strong> Two multipole ranges: low bins (2-8) and high bins (9-15) to compare angular scale dependencies.</li>
    <li><strong>Model:</strong> Theoretical model assuming only polarization rotation effects.</li>
    <li><strong>Spectra:</strong> Using EB cross-power spectrum only (E-mode and B-mode cross-correlation).</li>
    <li><strong>Injected EDE Signal:</strong> Presence or absence of an early dark energy signal in the simulated dataset.</li>
  </ul>
            </figcaption>

            <script type="text/javascript">
               

                pager.link("#zscore", {
                   
                    'Angle|angle':[
                        'alpha_BK18_150|alpha_BK18_150',
                        'alpha_BK18_K95|alpha_BK18_K95',
                        'alpha_BK18_B95lf|alpha_BK18_B95e',
                        'alpha_BK18_220|alpha_BK18_220',
                    ],
                 
                    'Injected Signal|inj_sig': [
                        'Positive Miscalibration|_sigpos',
                        'Negative Miscalibration|_signeg',
                        'Balanced Miscalibration|_sigbal',
                        'No Miscalibration|'
                    ],
                    'Bins compare 1|binset1':[
                        'Bins 2-8|bin2-8',
                    ],
                    'Bins compare 2|binset2':[
                        'Bins 9-15|bin9-15',
                    ],
                    'Model|theory_comp': [
                        'Rotation Only|_det_polrot',
                    ],
                    'Spectra|spectra': [
                        'EB only|_eb',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
         
                    function (params) {
                        let dirbase = '/liuto/home/GitHub/EB_analysis/'
                        let dirpath = dirbase + '/zscore_histograms/';
                        let zscore1 = params.angle + '_' + params.ede + '_' + params.binset1 + params.theory_comp + params.spectra + params.inj_sig
                        let zscore2 = params.ede + '_' + params.binset2 + params.theory_comp + params.spectra + params.inj_sig
                        
                        let name = dirpath + 'zscore_hist_' + zscore1 + '_' + zscore2 +  '.png';
            
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'angle': 'alpha_BK18_150',
                    'binset1': 'bin2-8',
                    'binset2': 'bin9-15',
                    'inj_sig': '',
                    'ede': 'zeroeb',
                    'spectra': '_eb',
                    'theory_comp': '_det_polrot',
                });
            </script>
        </figure>
        <div style="display: flex; gap: 40px; font-family: Arial, sans-serif;">

  <table border="1" cellpadding="6" style="border-collapse: collapse; width: 48%;">
    <caption><strong>g = 0 (No EDE Signal)</strong></caption>
    <thead>
      <tr>
        <th>Angle</th>
        <th>Positive Miscal</th>
        <th>Negative Miscal</th>
        <th>Balanced Miscal</th>
        <th>No Miscal</th>
      </tr>
    </thead>
    <tbody>
      <tr><td>alpha_BK18_150</td><td>-0.13 ± 1.1</td><td>-0.1 ± 1.1</td><td>-0.12 ± 1.11</td><td>-0.13 ± 1.13</td></tr>
      <tr><td>alpha_BK18_220</td><td>0.01 ± 1.27</td><td>0.02 ± 1.28</td><td>0.03 ± 1.26</td><td>0.01 ± 1.25</td></tr>
      <tr><td>alpha_BK18_K95</td><td>-0.08 ± 1.16</td><td>-0.1 ± 1.15</td><td>-0.09 ± 1.12</td><td>-0.1 ± 1.16</td></tr>
      <tr><td>alpha_BK18_B95lf</td><td>-0.02 ± 0.98</td><td>0 ± 0.98</td><td>-0.01 ± 0.98</td><td>-0.02 ± 1.01</td></tr>
    </tbody>
  </table>

  <table border="1" cellpadding="6" style="border-collapse: collapse; width: 48%;">
    <caption><strong>g = 1 (Injected EDE Signal)</strong></caption>
    <thead>
      <tr>
        <th>Angle</th>
        <th>Positive Miscal</th>
        <th>Negative Miscal</th>
        <th>Balanced Miscal</th>
        <th>No Miscal</th>
      </tr>
    </thead>
    <tbody>
      <tr><td>alpha_BK18_150</td><td>-0.50 ± 1.17</td><td>-0.52 ± 1.14</td><td>-0.49 ± 1.2</td><td>-0.53 ± 1.2</td></tr>
      <tr><td>alpha_BK18_220</td><td>-0.30 ± 1.28</td><td>-0.29 ± 1.3</td><td>-0.27 ± 1.27</td><td>-0.31 ± 1.3</td></tr>
      <tr><td>alpha_BK18_K95</td><td>-0.10 ± 1.09</td><td>-0.16 ± 1.14</td><td>-0.12 ± 1.11</td><td>-0.13 ± 1.14</td></tr>
      <tr><td>alpha_BK18_B95lf</td><td>-0.72 ± 1.01</td><td>-0.73 ± 1.03</td><td>-0.73 ± 1.03</td><td>-0.74 ± 1.03</td></tr>
    </tbody>
  </table>

</div>

<p>
  When <em>g = 0</em>, we expect no true discrepancy in polarization rotation angles,
  and accordingly, the Z-scores are centered around zero.
  The spread of these Z-scores is approximately one, indicating that noise in the EB spectrum
  naturally causes some variation in the fitted rotation angles between high-ℓ and low-ℓ bins.
</p>

<p>
  For <em>g = 1</em>, the overall spread of the Z-scores remains similar,
  but the distribution notably shifts downward.
  This shift is less than one standard deviation for all angles,
  implying that although aggregate differences become apparent across 500 simulations,
  such ell-dependent rotation would not be confidently detected in any single realization.
</p>

<p>
  To explore the effect of more extreme variations in rotation,
  we plot Z-scores comparing every possible combination of injected signals.
  For example, we can compare cases where the low-ℓ bins have a negative angle injected,
  while the high-ℓ bins have a positive angle injected.
  This produces much larger Z-scores,
  demonstrating that the EB spectrum is sensitive to significant differences in injected signals.
</p>

        <figure>
    <img alt="All Bin2-8 vs Bin9-15 Comparisons" id="bindiff_all_combos" src="#" width="750" height="500"
        onerror="javascript:this.src='dne.png'" />
    <figcaption>
  <p>Comprehensive comparison of Z-score histograms between low (bins 2-8) and high (bins 9-15) multipole ranges across all parameter combinations.</p>
  <p>Selectable options:</p>
  <ul>
    <li><strong>Angle:</strong> Polarization rotation angles from BICEP frequency bands (150 GHz, K95, B95lf, 220 GHz).</li>
    <li><strong>Injected Signal for Bins 2-8:</strong> Simulated miscalibration type in low multipole bins: positive, negative, balanced, or none.</li>
    <li><strong>Injected Signal for Bins 9-15:</strong> Same as above, but for high multipole bins.</li>
    <li><strong>Injected EDE Signal for Bins 2-8:</strong> Early dark energy signal injected or not in low multipole bins.</li>
    <li><strong>Injected EDE Signal for Bins 9-15:</strong> Early dark energy signal injected or not in high multipole bins.</li>
  </ul>
</figcaption>

    <script type="text/javascript">

        pager.link("#bindiff_all_combos", {
            'Angle|angle':[
                        'alpha_BK18_150|alpha_BK18_150',
                        'alpha_BK18_K95|alpha_BK18_K95',
                        'alpha_BK18_B95lf|alpha_BK18_B95e',
                        'alpha_BK18_220|alpha_BK18_220',
                    ],
            'Injected Signal Bins 2-8|inj_sig1': [
                'Positive Miscalibration|_sigpos',
                'Negative Miscalibration|_signeg',
                'Balanced Miscalibration|_sigbal',
                'No Miscalibration|'
            ],
            'Injected Signal Bins 9-15|inj_sig2': [
                'Positive Miscalibration|_sigpos',
                'Negative Miscalibration|_signeg',
                'Balanced Miscalibration|_sigbal',
                'No Miscalibration|'
            ],
            'Model|theory_comp': [
                'Rotation Only|_det_polrot',
            ],
            'Spectra|spectra': [
                'EB only|_eb',
            ],
            'Injected EDE Signal Bins 2-8|ede1': [
                'Fede = 0.07, g = 1|fede01',
                'g = 0|zeroeb'
            ],

            'Injected EDE Signal Bins 9-15|ede2': [
                'Fede = 0.07, g = 1|fede01',
                'g = 0|zeroeb'
            ]
        },

            function (params) {
                let dirbase = '/liuto/home/GitHub/EB_analysis/'
                let dirpath = dirbase + '/zscore_histograms/';
                let bin1 = 'bin2-8' + params.inj_sig1;
                let bin2 = 'bin9-15' + params.inj_sig2;
                let zscore1 = params.angle + '_' + params.ede1 + '_' + params.binset1 + params.theory_comp + params.spectra + params.inj_sig1
                let zscore2 = params.ede2 + '_' + params.binset2 + params.theory_comp + params.spectra + params.inj_sig2
                        
                let name = dirpath + 'zscore_hist_' + zscore1 + '_' + zscore2 +  '.png';
                console.log(name);
                return name;
            });

        pager.setparams({
            'inj_sig1': '',
            'inj_sig2': '',
            'ede1': 'zeroeb',
            'ede2': 'zeroeb',
            'spectra': '_eb',
            'theory_comp': '_det_polrot',
            'angle': 'alpha_BK18_150',
            'binset1': 'bin2-8',
            'binset2': 'bin9-15',
        });

    </script>
</figure>

    </section>
    <section>
        <h2>L dependent rotation Bin split 2-10 and 11-15</h2>
        <p>
        We repeat the same analysis as in section IV, except we use a different combination of bin sets. 
        Here, we choose bins 2-10 as our low-ell bins, and 11-15 as our high-ell bins.
        </p>
        
 <figure>
            <img alt="Multicomponent Analysis Spectrum" id="morebins10" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
                <p>Pager for multicomponent analysis of the Early Dark Energy (EDE) spectrum across 499 simulations.</p>
  <p>Options include:</p>
  <ul>
    <li><strong>Map Type:</strong> Best Fit EE, Best Fit EB, Best Fit BB, Triangle Plot, Summary Plot (Peaks histogram), Chi Squared histogram</li>
    <li><strong>Bins Used:</strong> 2-10, 11-15, 2-15</li>
    <li><strong>Injected Signal:</strong> Positive Miscalibration, Negative Miscalibration, Balanced Miscalibration, No Miscalibration</li>
    <li><strong>Model:</strong> Rotation Only</li>
    <li><strong>Spectra:</strong> EB only</li>
    <li><strong>Injected EDE Signal:</strong> Fede = 0.07, g = 1; or g = 0 (no EDE)</li>
    <li><strong>Simulation Number:</strong> 001 to 499</li>
  </ul>
            </figcaption>

            <script type="text/javascript">

                pager.link("#morebins10", {
                    'Map Sim Num Digit1|digit1': simnums,
                    'Digit2|digit2': simnums,
                    'Digit3|digit3': simnums,

                    'Map Type|m_map_type': [
                        'Best Fit EE|_bestfitEE',
                        'Best Fit EB|_bestfitEB',
                        'Best Fit BB|_bestfitBB',
                        'Triangle Plot|_triangle_plot',
                        'Summary Plot (Peaks histogram)|sim1_summary',
                        'Chi Squared histogram|simchisq_hist'
                    ],
                    'Bins Used|bin_num10': [
                        '2-10|_bin2-10',
                        '11-15|_bin11-15',
                        '2-15|_bin2-15',
                    ],
                    'Injected Signal|inj_sig': [
                        'Positive Miscalibration|_sigpos',
                        'Negative Miscalibration|_signeg',
                        'Balanced Miscalibration|_sigbal',
                        'No Miscalibration|'
                    ],
                    'Model|theory_comp': [
                        'Rotation Only|_det_polrot',
                    ],
                    'Spectra|spectra': [
                        'EB only|_eb',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
                    function (params) {
                        let dirbase = '/liuto'
                        let dirpath = dirbase + '/ede_chains/';
                        let mcmc_folder = params.ede + params.bin_num10 + params.theory_comp + params.spectra + params.inj_sig+ '/';
                        let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
                        let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
                        if (params.m_map_type == 'sim1_summary' || params.m_map_type == 'simchisq_hist') {
                            name = dirpath + mcmc_folder + params.m_map_type + '.png'
                        }
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'digit1': '0',
                    'digit2': '0',
                    'digit3': '1',
                    'inj_sig': '',
                    'm_map_type': '_bestfitEB',
                    'bin_num10': '_bin2-15',
                    'ede': 'zeroeb',
                    'spectra': '_eb',
                    'theory_comp': '_det_polrot',
                });
            </script>
        </figure>
         <p>
    Again, when g=1, the posterior peaks for the high-ell bins are consistently larger than those for the low-ell bins.
    The shift in the maximum likelihood estimate is now even more pronounced.
    This larger shift can be understood by examining the overlapping contours plotted below.
    Unlike the previous case where the low-ell bins had much weaker constraining power than the high-ell bins,
    here we redefine the low-ell and high-ell ranges so that both sets have similar constraining power.
    This balanced split allows the difference in the MCMC fit to become more noticeable.
    
</p>
      <figure>
            <img alt="Bin diffs" id="bindiff10" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
  <p>Pager for bin difference analysis, all 3 contours for different bin sets are plotted on top of each other. 
    Red for high ell, gray for low ell, and blue for all bins.
  </p>
  <p>Options include:</p>
  <ul>
    <li><strong>Simulation Number:</strong> 001 to 499</li>
    <li><strong>Injected Signal:</strong> Positive Miscalibration, Negative Miscalibration, Balanced Miscalibration, No Miscalibration</li>
    <li><strong>Model:</strong> Rotation Only</li>
    <li><strong>Spectra:</strong> EB only</li>
    <li><strong>Injected EDE Signal:</strong> Fede = 0.07, g = 1; or g = 0 (no EDE)</li>
  </ul>
</figcaption>

            <script type="text/javascript">
               

                pager.link("#bindiff10", {
                    'Map Sim Num Digit1|digit1': simnums,
                    'Digit2|digit2': simnums,
                    'Digit3|digit3': simnums,

                 
                    'Injected Signal|inj_sig': [
                        'Positive Miscalibration|_sigpos',
                        'Negative Miscalibration|_signeg',
                        'Balanced Miscalibration|_sigbal',
                        'No Miscalibration|'
                    ],
                    'Model|theory_comp': [
                        'Rotation Only|_det_polrot',
                    ],
                    'Spectra|spectra': [
                        'EB only|_eb',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
         
                    function (params) {
                        let dirbase = '/liuto'
                        let dirpath = dirbase + '/ede_chains/bindiffs2-10,11-15,2-15/';
                        let mcmc_folder = params.ede + params.theory_comp + params.spectra + params.inj_sig+ '/';
                        let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
                        let name = dirpath + mcmc_folder + sim_id  + '.png';
            
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'digit1': '0',
                    'digit2': '0',
                    'digit3': '1',
                    'inj_sig': '',
                    'ede': 'zeroeb',
                    'spectra': '_eb',
                    'theory_comp': '_det_polrot',
                });
            </script>
        </figure>
        <p>We observe that the blue contours, representing the combined data, no longer closely follows the red contour,
    but instead lies between the red and gray contours.</p>
        <figure>
            <img alt="Z Scores" id="zscore10" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
           <figcaption>
  <p>Z-score histogram showing statistical significance of polarization angle differences.</p>
  <p>Selectable options:</p>
  <ul>
    <li><strong>Angle:</strong> Polarization rotation angles measured from different BICEP frequency bands (150 GHz, K95, B95lf, 220 GHz).</li>
    <li><strong>Injected Signal:</strong> Type of simulated miscalibration applied to the data — positive, negative, balanced, or no miscalibration.</li>
    <li><strong>Bin sets compared:</strong> Two multipole ranges: low bins (2-10) and high bins (11-15) to compare angular scale dependencies.</li>
    <li><strong>Model:</strong> Theoretical model assuming only polarization rotation effects.</li>
    <li><strong>Spectra:</strong> Using EB cross-power spectrum only (E-mode and B-mode cross-correlation).</li>
    <li><strong>Injected EDE Signal:</strong> Presence or absence of an early dark energy signal in the simulated dataset.</li>
  </ul>
</figcaption>

            <script type="text/javascript">
               
                pager.link("#zscore10", {
                   
                    'Angle|angle':[
                        'alpha_BK18_150|alpha_BK18_150',
                        'alpha_BK18_K95|alpha_BK18_K95',
                        'alpha_BK18_B95lf|alpha_BK18_B95e',
                        'alpha_BK18_220|alpha_BK18_220',
                    ],
                 
                    'Injected Signal|inj_sig': [
                        'Positive Miscalibration|_sigpos',
                        'Negative Miscalibration|_signeg',
                        'Balanced Miscalibration|_sigbal',
                        'No Miscalibration|'
                    ],
                    'Bins compare 1|binset1b':[
                        'Bins 2-10|bin2-10',
                    ],
                    'Bins compare 2|binset2b':[
                        'Bins 11-15|bin11-15',
                    ],
                    'Model|theory_comp': [
                        'Rotation Only|_det_polrot',
                    ],
                    'Spectra|spectra': [
                        'EB only|_eb',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
         
                    function (params) {
                        let dirbase = '/liuto/home/GitHub/EB_analysis/'
                        let dirpath = dirbase + '/zscore_histograms/';
                        let zscore1 = params.angle + '_' + params.ede + '_' + params.binset1b + params.theory_comp + params.spectra + params.inj_sig
                        let zscore2 = params.ede + '_' + params.binset2b + params.theory_comp + params.spectra + params.inj_sig
                        
                        let name = dirpath + 'zscore_hist_' + zscore1 + '_' + zscore2 +  '.png';
            
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'angle': 'alpha_BK18_150',
                    'binset1b': 'bin2-10',
                    'binset2b': 'bin11-15',
                    'inj_sig': '',
                    'ede': 'zeroeb',
                    'spectra': '_eb',
                    'theory_comp': '_det_polrot',
                });
            </script>
        </figure>
        <p>
  The table below summarizes the Z score when comparing the data in low-ell and high-ell bins, 
  comparing the cases of g=0 (no Early Dark Energy signal) and g=1 (with Early Dark Energy signal). 
  For g=0, the fitted angles cluster near zero with uncertainties around 1.2, indicating no ell-dependent rotation. 
  When g=1, the rotation angles shift downward for all frequencies, with uncertainties remaining similar. 
  This shift reflects the presence of ell-dependent rotation induced by the Early Dark Energy signal.
</p>

<table border="1" cellpadding="5" cellspacing="0">
  <thead>
    <tr>
      <th>Angle</th>
      <th>g=0 (Rotation ± Uncertainty)</th>
      <th>g=1 (Rotation ± Uncertainty)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>alpha_BK18_150</td>
      <td>-0.06 ± 1.22</td>
      <td>-1.21 ± 1.29</td>
    </tr>
    <tr>
      <td>alpha_BK18_220</td>
      <td>0.02 ± 1.28</td>
      <td>-0.56 ± 1.20</td>
    </tr>
    <tr>
      <td>alpha_BK18_K95</td>
      <td>-0.08 ± 1.27</td>
      <td>-0.25 ± 1.22</td>
    </tr>
    <tr>
      <td>alpha_BK18_B95lf</td>
      <td>-0.02 ± 1.06</td>
      <td>-1.59 ± 1.09</td>
    </tr>
  </tbody>
</table>
<p>
  Similar to the previous case, the angles alpha_BK18_150 and alpha_BK18_B95lf show the strongest 
  discriminating power. The magnitude of the difference now suggests it is possible to detect 
  ell-dependent rotation with the current binning scheme by fitting rotation angles separately 
  for the two bin sets. A Z-score significantly less than 2 indicates evidence of ell-dependent 
  rotation that is unlikely to be explained by noise alone. However, it is important to note 
  that this result assumes an injected signal with g=1, which is much stronger than what current 
  literature estimates, where g is expected to be less than 0.2. Therefore, while it is unlikely 
  that ell-dependent rotation is detected in the actual BICEP data, we can still place a rough, 
  model-independent constraint on its magnitude.
</p>
<p>
    Again, we have the Z-score histograms available for all combinations of high and low ell bin configurations.
</p>
        <figure>
    <img alt="All Bin2-10 vs Bin11-15 Comparisons" id="bindiff_all_combos10" src="#" width="750" height="500"
        onerror="javascript:this.src='dne.png'" />
    <figcaption>
  <p>Comprehensive comparison of Z-score histograms between low (bins 2-10) and high (bins 11-15) multipole ranges across all parameter combinations.</p>
  <p>Selectable options:</p>
  <ul>
    <li><strong>Angle:</strong> Polarization rotation angles from BICEP frequency bands (150 GHz, K95, B95lf, 220 GHz).</li>
    <li><strong>Injected Signal for Bins 2-10:</strong> Simulated miscalibration type in low multipole bins: positive, negative, balanced, or none.</li>
    <li><strong>Injected Signal for Bins 11-15:</strong> Same as above, but for high multipole bins.</li>
    <li><strong>Injected EDE Signal for Bins 2-10:</strong> Early dark energy signal injected or not in low multipole bins.</li>
    <li><strong>Injected EDE Signal for Bins 11-15:</strong> Early dark energy signal injected or not in high multipole bins.</li>
  </ul>
</figcaption>

    <script type="text/javascript">

        pager.link("#bindiff_all_combos10", {
            'Angle|angle':[
                        'alpha_BK18_150|alpha_BK18_150',
                        'alpha_BK18_K95|alpha_BK18_K95',
                        'alpha_BK18_B95lf|alpha_BK18_B95e',
                        'alpha_BK18_220|alpha_BK18_220',
                    ],
            'Injected Signal Bins 2-10|inj_sig1': [
                'Positive Miscalibration|_sigpos',
                'Negative Miscalibration|_signeg',
                'Balanced Miscalibration|_sigbal',
                'No Miscalibration|'
            ],
            'Injected Signal Bins 11-15|inj_sig2': [
                'Positive Miscalibration|_sigpos',
                'Negative Miscalibration|_signeg',
                'Balanced Miscalibration|_sigbal',
                'No Miscalibration|'
            ],
            'Model|theory_comp': [
                'Rotation Only|_det_polrot',
            ],
            'Spectra|spectra': [
                'EB only|_eb',
            ],
            'Injected EDE Signal Bins 2-10|ede1': [
                'Fede = 0.07, g = 1|fede01',
                'g = 0|zeroeb'
            ],

            'Injected EDE Signal Bins 11-15|ede2': [
                'Fede = 0.07, g = 1|fede01',
                'g = 0|zeroeb'
            ]
        },

            function (params) {
                let dirbase = '/liuto/home/GitHub/EB_analysis/'
                let dirpath = dirbase + '/zscore_histograms/';
                let bin1 = 'bin2-10' + params.inj_sig1;
                let bin2 = 'bin11-15' + params.inj_sig2;
                let zscore1 = params.angle + '_' + params.ede1 + '_' + params.binset1b + params.theory_comp + params.spectra + params.inj_sig1
                let zscore2 = params.ede2 + '_' + params.binset2b + params.theory_comp + params.spectra + params.inj_sig2
                        
                let name = dirpath + 'zscore_hist_' + zscore1 + '_' + zscore2 +  '.png';
                console.log(name);
                return name;
            });

        pager.setparams({
            'inj_sig1': '',
            'inj_sig2': '',
            'ede1': 'zeroeb',
            'ede2': 'zeroeb',
            'spectra': '_eb',
            'theory_comp': '_det_polrot',
            'angle': 'alpha_BK18_150',
            'binset1b': 'bin2-10',
            'binset2b': 'bin11-15',
        });

    </script>
</figure>

    </section>
<section>
    <h2>Constraining Isotropic rotation with dust</h2>
    <p>We run the full MCMC pipeline on the no EDE injected dataset to set a constraint on 
        the general isotropic birefringence angle \(\alpha_{CMB}\). Unfortunately, the dust 
        calibration does not have significant constraining power on the rotation angles, so 
        the overal isotropic rotation angle is still strongly degenerate with the individual 
        rotation angles for each receiver. Regardless, this is still a constraint that is 
        agnostic to any particular assumption about how dust affects the EB spectrum.
    </p>
      <figure>
            <img alt="Isotropic angle constraints" id="alphacmb" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
    Explore different MCMC fit results and diagnostic plots:<br><br>
    <strong>Map Sim Num Digit1, Digit2, Digit3:</strong> Select the simulation instance by its digit indices (0–9), viewing individual simulation chain results.<br><br>
    <strong>Map Type:</strong> Choose the type of plot:<br>
    &nbsp;&nbsp;- <em>Best Fit EE/EB/BB:</em> Shows the MCMC best-fit parameter constraints for each polarization spectrum.<br>
    &nbsp;&nbsp;- <em>Triangle Plot:</em> Displays joint posterior distributions and parameter correlations.<br>
    &nbsp;&nbsp;- <em>Summary Plot (Peaks histogram):</em> Histogram summarizing the distribution of peak values in the MCMC chains.<br>
    &nbsp;&nbsp;- <em>Chi Squared histogram:</em> Distribution of chi-squared goodness-of-fit values across simulations.<br><br>
   
</figcaption>
            <script type="text/javascript">
               
                

                pager.link("#alphacmb", {
                    'Map Sim Num Digit1|digit1': simnums,
                    'Digit2|digit2': simnums,
                    'Digit3|digit3': simnums,

                    'Map Type|m_map_type': [
                        'Best Fit EE|_bestfitEE',
                        'Best Fit EB|_bestfitEB',
                        'Best Fit BB|_bestfitBB',
                        'Triangle Plot|_triangle_plot',
                        'Summary Plot (Peaks histogram)|sim1_summary',
                        'Chi Squared histogram|simchisq_hist'
                    ],
                    'Bins Used|bin_num': [
                        '2-15|_bin2-15',
                    ],
                    'Dust model|theory_compd': [
                        'Gaussian Dust, no EDE|_no_ede',
                    ],
                    'Spectra|spectrad': [
                        'EB only|_all',
                    ],
                    'Injected EDE Signal|ede': [
                        'g = 0|zeroeb'
                    ]
                },
         
                    function (params) {
                        let dirbase = '/liuto'
                        let dirpath = dirbase + '/ede_chains/';
                        let mcmc_folder = params.ede + params.bin_num  + params.theory_compd + params.spectrad+ params.feded +'/';
                        let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
                        let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
                        if (params.m_map_type == 'sim1_summary' || params.m_map_type == 'simchisq_hist') {
                            name = dirpath + mcmc_folder + params.m_map_type + '.png'
                        }
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'digit1': '0',
                    'digit2': '0',
                    'digit3': '1',
                    'inj_sig': '',
                    'm_map_type':'sim1_summary',
                    'bin_num':'_bin2-15',
                    'feded':'_ebfede0.07',
                    'ede': 'zeroeb',
                    'spectrad': '_all',
                    'theory_compd': '_no_ede',
                });
            </script>
        </figure>
</section>
    <section>
        <h2>Future Directions</h2>
        <ul>
             <li>
      Evaluate whether additional simulations are needed to verify the claim about the BB signal, or lower 
      injected signal strengths (e.g., g = 0.1–0.2) that are more consistent with theoretical expectations. 
    </li>
    
    <li>
      Finalize the diagnostic suite for use on the real data. This includes both the 
      model dependent method that mimic's Eskilt's constraint of EDE, 
      as well as the model agnostic method involving choosing which rotation angles, 
      bin combinations, and Z-score metrics to provide the most sensitive and interpretable measures of 
      ell-dependent rotation.
    </li>
   <li>
      Develop a strategy to publish the results without compromising 
      the blinding of the polarization calibration analysis in the BICEP3 polarization angles paper. 
    </li>
  </ul>
     
    </section>
    <section>
        <h2>Appendix</h2>
        <p>All chains and plots can be found in
            <code>/n/holylfs04/LABS/kovac_lab/Users/liuto/ede_chains</code>.
        </p>
    </section>
</body>

</html>
