<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Early Dark Energy Dust and Polarization Miscalibration Simulation Update</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <!-- Load up MathJax for math notation -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
    </script><script type="text/javascript" src="../mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
</head>

<body>
    <!-- Add my custom pager script -->
    <script type="text/javascript" src="scripts/pager.js"></script>
    <link rel="stylesheet" type="text/css" href="scripts/pager.css">

    <header>
        <h1>Early Dark Energy EB Spectrum Dust Analysis Simulation Update</h1>

        <time datetime="2025 May 13" class="published updated">
            2025 May 13
        </time> —
        Tongtian (Tom) Liu, Dominic Beck
    </header>

    <hr>
    <section>
        <h2>Introduction</h2>
        <p>This posting is an update to the previous postings:</p>
        <ul>
        <li><a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20240924_preliminary_eb_ede_results/">2024-09-24 Preliminary EB EDE Results</a></li>
        <li><a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20241203_multicomp_eb_ede_update/">2024-12-03 Multicomp EB EDE Update</a></li>
        <li><a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20250218_ede_forecast/">2025-02-18 EDE Forecast</a></li>
        </ul>
        <p>
            We further demonstrate the robustness of the method for fitting to early dark energy parameters.
            We first refactor our EDE fitting pipeline to also include the data from the EE and BB spectra. 
            While the sensitivity to rotation angle and EDE parameters for EE and BB are much suppressed compared 
            to EB, their presence helps calibrate nuisance parameters like dust, which in turn improves constraints 
            on rotation angles determined by EB.
            
          </p>
          <p>
            We inject miscalibration rotation angles into our data to see their effect on the pipeline.
            We run MCMC chains using EB only, then with EE and EB (excluding BB), and finally with all EE, EB, and BB.
            This progression lets us isolate the influence of each spectrum type on the inferred parameters when signals are injected.
          </p>
          <p>
            The injected miscalibration angles (in degrees) for BK18_220, BK18_150, BK18_K95, and BK18_B95e (B95lf) are:
            <ul>
              <li>Positive: 0, 0.25, 0.5, 0.75</li>
              <li>Negative: 0, -0.25, -0.5, -0.75</li>
              <li>Balanced: -1, -0.5, 0, 0.5</li>
            </ul>
            We apply these to two datasets: BK18lf (no EDE injection) and BK18lf_fede01 (with EDE injected at fede=0.07, g=1).
            This tests whether polarization rotation miscalibration could falsely enhance the EDE signal.
          </p>
           
        <p>
            We also run the fitting over the dust models presented in 
            <a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20210122_BK18mm_final_altdust/">J. Willmert's posting</a>.
            This is to show that different dust models would not impact our evaluation of g.
        </p>
    </section>
    <section>
   <h2>Bias checks</h2>
   <figure>
    <img alt="Multicomponent Analysis EB Spectrum" id="dustfigs" src="#" width="750" height="500" onerror="javascript:this.src='dne.png'" />
    <figcaption>
        <p>Interactive plot pager for multicomponent analysis of the Early Dark Energy (EDE) spectrum.
            Visualizes the fits and triangle plots for 499 simulations.</p>
        <ul>
            <li><strong>Map Type</strong>: Choose the type of plot to visualize:
                <ul>
                    <li>Best Fit EE: Displays best fit to the EE spectrum.</li>
                    <li>Best Fit EB: Displays best fit to the EB spectrum.</li>
                    <li>Best Fit BB: Displays best fit to the BB spectrum.</li>
                    <li>Triangle Plot: Shows parameter correlation contours.</li>
                </ul>
            </li>
            <li><strong>Bins Used</strong>: Choose the binning scheme applied to spectra:
                <ul>
                    <li>2–15: Uses bins 2 through 15.</li>
                </ul>
            </li>
            <li><strong>Theory comp</strong>: Select the theoretical model used for comparison:
                <ul>
                    <li>Fixed dust fit: Dust parameters fixed to zero.</li>
                    <li>With Dust fit: Dust parameters are floated in the fit.</li>
                    <li>Signal Only: Only the injected signal is fit, no dust model or noise.</li>
                    <li>Fixed angle signal only: Signal-only fit with angle fixed to 0.</li>
                </ul>
            </li>
            <li><strong>Spectra</strong>: Choose which spectra to include in the fit:
                <ul>
                    <li>All: Includes EE, EB, and BB.</li>
                    <li>No BB: Includes EE and EB only.</li>
                    <li>EB only: Only EB spectrum is used.</li>
                </ul>
            </li>
            <li><strong>Injected EDE Signal</strong>: Select which Early Dark Energy (EDE) signal was injected:
                <ul>
                    <li>Fede = 0.07, g = 1: Injected signal with EDE.</li>
                    <li>g = 0: No rotation, null birefringence.</li>
                </ul>
            </li>
            <li><strong>Map Sim num</strong>: Choose the simulation number (three digits) to view results for a particular realization.</li>
        </ul>
        <p>This interactive plot allows detailed exploration of multicomponent analysis by adjusting map types, binning, theoretical assumptions, spectra selections, EDE signal injections, and simulation numbers.</p>
    </figcaption>

    <script type="text/javascript">
                function pad(num, size) {
                    num = num.toString();
                    while (num.length < size) num = "0" + num;
                    return num;
                }
                const simnums = [];
                for (let i = 0; i < 10; i++) {
                    s = pad(i, 1);

                    simnums[i] = s.concat('|', s);

                }

        pager.link("#dustfigs", {
            'Map Sim Num Digit1|digit1': simnums,
            'Digit2|digit2': simnums,
            'Digit3|digit3': simnums,

            'Map Type|m_map_type': [
                'Best Fit EE|_bestfitEE',
                'Best Fit EB|_bestfitEB',
                'Best Fit BB|_bestfitBB',
                'Triangle Plot|_triangle_plot',
                'Summary Plot (Peaks histogram)|sim1_summary'
            ],
            'Bins Used|bin_num15': [
                '2-15|_bin15',
            ],
            'Theory comp|theory_comp':[
                'Fixed dust fit|_fixeddust',
                'With Dust fit|_gdust',
                'Signal Only|_sigl',
                'Fixed angle signal only|_sigl_fixedangle'
            ],
            'Spectra|spectra':[
                'All|_all',
                'No BB|_nob',
                'EB only|_eb',
            ],
            'Injected EDE Signal|ede': [
                'Fede = 0.07, g = 1|fede01',
                'g = 0|zeroeb'
            ]
        },
        function (params) {
            let dirbase = '/liuto'
            let dirpath = dirbase + '/ede_chains/';
            let mcmc_folder = params.ede + params.bin_num15 + params.theory_comp + params.spectra + '/';
            let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
            let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
            if(params.m_map_type == 'sim1_summary'){
                name = dirpath + mcmc_folder + params.m_map_type + '.png'
            }
            console.log(name);
            return name;
        });

        pager.setparams({
            'digit1':'0',
            'digit2': '0',
            'digit3': '1',
            'm_map_type': '_bestfitEB',
            'bin_num15': '_bin15',
            'ede': 'zeroeb',
            'spectra':'_all',
            'theory_comp':'_fixeddust',
        });
    </script>
</figure>
    </section>
 
<section>

<h2>Injecting detector rotation miscalibration</h2>
<figure>
    <img alt="Fitting to injected miscalibration" id="polrot" src="#" width="750" height="500" onerror="javascript:this.src='dne.png'" />
    <figcaption>
        <p>Interactive plot pager for multicomponent analysis of the Early Dark Energy (EDE) spectrum.
            Visualizes the fits and triangle plots for 499 simulations.</p>
        <ul>
            <li><strong>Map Type</strong>: Choose the type of plot to visualize:
                <ul>
                    <li>Best Fit EE: Displays best fit to the EE spectrum.</li>
                    <li>Best Fit EB: Displays best fit to the EB spectrum.</li>
                    <li>Best Fit BB: Displays best fit to the BB spectrum.</li>
                    <li>Triangle Plot: Shows parameter correlation contours.</li>
                    <li>Summary plot: shows the peaks of all the triangle plot sims.</li>
                </ul>
            </li>
            <li><strong>Bins Used</strong>: Choose the binning scheme applied to spectra:
                <ul>
                    <li>2–15: Uses bins 2 through 15.</li>
                </ul>
            </li>
            <li><strong>Injected Signal</strong>: Select the detector miscalibration angle to inject into the sim, units in degrees
                <ul>
                <li>No Miscalibration: Nothing is injected</li>
                <li>Positive Miscalibration: Injected rotation of 0, 0.25, 0.5, 0.75</li>
                <li>Negative Miscalibration: Injected rotation of 0, -0.25, -0.5, -0.75</li>
                <li>Blanaced Miscalibration: Injected rotation of 0.5, 0, -0,5, -1</li>

                </ul>
            </li>
            </li>
            <li><strong>Map Sim num</strong>: Choose the simulation number (three digits) to view results for a particular realization.</li>
        </ul>
        <p>This interactive plot allows detailed exploration of multicomponent analysis by adjusting map types, binning, theoretical assumptions, spectra selections, EDE signal injections, and simulation numbers.</p>
    </figcaption>

    <script type="text/javascript">

        pager.link("#polrot", {
            'Map Sim Num Digit1|digit1': simnums,
            'Digit2|digit2': simnums,
            'Digit3|digit3': simnums,

            'Map Type|m_map_type': [
                'Best Fit EE|_bestfitEE',
                'Best Fit EB|_bestfitEB',
                'Best Fit BB|_bestfitBB',
                'Triangle Plot|_triangle_plot',
                'Summary Plot (Peaks histogram)|sim1_summary'
            ],
            'Bins Used|bin_num15': [
                '2-15|_bin15',
            ],
            'Injected Signal|inj_sig':[
                'Positive Miscalibration|_sigpos',
                'Negative Miscalibration|_signeg',
                'Balanced Miscalibration|_sigbal',
                ],
            'Spectra|spectra':[
                'All|_all',
                'No  BB|_nob',
                'EB Only|_eb',
            ],
            'Injected EDE Signal|ede': [
                'g = 0|zeroeb',
                'g = 1, fede=0.07|fede01'
            ]
        },
        function (params) {
            let dirbase2 = '/liuto'
            let dirpath = dirbase2 + '/ede_chains/';
            let mcmc_folder = params.ede + params.bin_num15 + '_gdust' + params.spectra + params.inj_sig + '/';
            let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
            let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
            if(params.m_map_type == 'sim1_summary'){
                name = dirpath + mcmc_folder + params.m_map_type + '.png'
            }
            console.log(name);
            return name;
        });

        pager.setparams({
            'digit1':'0',
            'digit2': '0',
            'digit3': '1',
            'm_map_type': '_bestfitEB',
            'bin_num15': '_bin15',
            'ede': 'zeroeb',
            'spectra':'_all',
            'inj_sig': '_sigpos',
        });
    </script>
</figure>
</section>

<section>
    <h2>Trying different dust models</h2>
 <figure>
     <img alt="Fitting to different dust models" id="dustmodels" src="#" width="750" height="500" onerror="javascript:this.src='dne.png'" />
     <figcaption>
         <p>Interactive plot pager for multicomponent analysis of the Early Dark Energy (EDE) spectrum.
             Visualizes the fits and triangle plots for 499 simulations.</p>
         <ul>
             <li><strong>Map Type</strong>: Choose the type of plot to visualize:
                 <ul>
                     <li>Best Fit EE: Displays best fit to the EE spectrum.</li>
                     <li>Best Fit EB: Displays best fit to the EB spectrum.</li>
                     <li>Best Fit BB: Displays best fit to the BB spectrum.</li>
                     <li>Triangle Plot: Shows parameter correlation contours.</li>
                     <li>Summary plot: shows the peaks of all the triangle plot sims.</li>
                 </ul>
             </li>
             <li><strong>Bins Used</strong>: Choose the binning scheme applied to spectra:
                 <ul>
                     <li>2–15: Uses bins 2 through 15.</li>
                 </ul>
             </li>
             <li><strong>Dust model</strong>: Select the theoretical dust model used for comparison:
                 <ul>
                 Dust models acquired from <a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20210122_BK18mm_final_altdust/">J. Willmert's posting</a>
                 </ul>
             </li>
             </li>
             <li><strong>Map Sim num</strong>: Choose the simulation number (three digits) to view results for a particular realization.</li>
         </ul>
         <p>This interactive plot allows detailed exploration of multicomponent analysis by adjusting map types, binning, theoretical assumptions, spectra selections, EDE signal injections, and simulation numbers.</p>
     </figcaption>
 
     <script type="text/javascript">
 
         pager.link("#dustmodels", {
             'Map Sim Num Digit1|digit1': simnums,
             'Digit2|digit2': simnums,
             'Digit3|digit3': simnums,
 
             'Map Type|m_map_type': [
                 'Best Fit EE|_bestfitEE',
                 'Best Fit EB|_bestfitEB',
                 'Best Fit BB|_bestfitBB',
                 'Triangle Plot|_triangle_plot',
                 'Summary Plot (Peaks histogram)|sim1_summary'
             ],
             'Bins Used|bin_num15': [
                 '2-15|_bin15',
             ],
             'Dust model|dust_model':[
                 'No Dust|_nodust',
                 'Gaussian Dust|_gdust',
                 'pysm1|_pysm1',
                 'pysm2|_pysm2',
                 'pysm3|_pysm3',
                 'mhd|_mhd',
                 'mkd|_mkd',
                 'gdecorr|_gdecorr',
                 'gampmod|_gampmod',
                 'vansyngel|_vansyngel',
 
             ],
             'Spectra|spectrad':[
                 'All|_all',
             ],
             'Injected EDE Signal|eded': [
                 'g = 0|zeroeb'
             ]
         },
         function (params) {
             let dirbase2 = '/liuto'
             let dirpath = dirbase2 + '/ede_chains/';
             let mcmc_folder = params.eded + params.bin_num15 + params.dust_model + params.spectrad + '/';
             let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
             let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
             if(params.m_map_type == 'sim1_summary'){
                 name = dirpath + mcmc_folder + params.m_map_type + '.png'
             }
             console.log(name);
             return name;
         });
 
         pager.setparams({
             'digit1':'0',
             'digit2': '0',
             'digit3': '1',
             'm_map_type': '_bestfitEB',
             'bin_num15': '_bin15',
             'eded': 'zeroeb',
             'spectrad':'_all',
             'dust_model':'_pysm1',
         });
     </script>
 </figure>
 </section>

 
</body>

</html>
