<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Early Dark Energy Simulation Dust and Polarization Miscalibration Update</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <!-- Load up MathJax for math notation -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
    </script><script type="text/javascript" src="../mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
</head>

<body>
    <!-- Add my custom pager script -->
    <script type="text/javascript" src="scripts/pager.js"></script>
    <link rel="stylesheet" type="text/css" href="scripts/pager.css">

    <header>
        <h1>Early Dark Energy Simulation Dust and Polarization Miscalibration Update</h1>

        <time datetime="2025 May 13" class="published updated">
            2025 May 13
        </time> —
        Tongtian (Tom) Liu, Dominic Beck
    </header>

    <hr>
    <section>
        <h2>Introduction</h2>
        <p><strong>Summary:</strong> EB-only and full-spectrum fits both recover <em>g ≈ 0</em> with minor bias;
            rotation angles remain near zero, supporting the robustness of the pipeline for multiple different 
            dust and detector miscalibration models. 
            When fitting for data at <em>g = 1</em>, 
            including BB suppresses <em>g</em> to due to compensatory shifts
            in rotation angles. Removing BB restores expected recovery near <em>g = 1</em>.</p>
              
        <p>This posting builds upon previous updates:</p>
  <ul>
    <li><a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20240924_preliminary_eb_ede_results/">
        2024-09-24: Preliminary EB EDE Results</a></li>
    <li><a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20241203_multicomp_eb_ede_update/">
        2024-12-03: Multicomponent EB EDE Update</a></li>
    <li><a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20250218_ede_forecast/">
        2025-02-18: EDE Forecast</a></li>
  </ul>
  <p>
    Here, we further demonstrate the robustness of our method for fitting early dark energy (EDE)
    parameters by expanding the pipeline to also include EE and BB spectra alongside EB. While
    EE and BB are far less sensitive to polarization rotation or EDE parameters than EB,
    their inclusion helps calibrate nuisance parameters like dust, ultimately tightening
    constraints on the EB-inferred rotation angle. 
</p>

<p>
    We jointly fit dust and EDE parameters to ensure that uncertainties in the dust model
    are properly propagated into our estimates of \( g \) and the rotation angles.
    Across all configurations tested, we find no significant degeneracy between
    the foreground dust parameters and the EDE coupling. EB remains the primary
    spectrum constraining \( g \), with EE and BB helping calibrate polarization amplitude
    and dust components.
</p>

<h3>EE, EB, and BB Spectra Modeling and Miscalibration</h3>

  
<p>
    We begin with the polarization power spectra generated by <strong>CAMB</strong>,
    including lensing effects. Depending on the MCMC configuration, the EB spectrum
    is either set to zero (by setting g=0) or initialized with a nonzero value determined by the
    early dark energy (EDE) parameters:
  </p>

  <p>
    \[
    D_{\ell}^{EE,\,\mathrm{CMB}}, \quad
    D_{\ell}^{BB,\,\mathrm{CMB}}, \quad
    D_{\ell}^{EB,\,\mathrm{CMB}} = g \times D_{\ell}^{EB,\,\mathrm{EDE}}.
    \]
  </p>
  <p>
    These theory spectra are rotated by a global cosmic birefringence angle
    \(\alpha_{\mathrm{cmb}}\), resulting in:
  </p>

  <p>
    \[
    \tilde{D}_{\ell}^{EE,\,{\rm CMB}} = D_{\ell}^{EE,\,{\rm CMB}} \cos^2(2\alpha_{\rm cmb}) 
    + D_{\ell}^{BB,\,{\rm CMB}} \sin^2(2\alpha_{\rm cmb}) 
    - D_{\ell}^{EB,\,{\rm CMB}} \sin(4\alpha_{\rm cmb})
    \]
    \[
    \tilde{D}_{\ell}^{BB,\,{\rm CMB}} = D_{\ell}^{EE,\,{\rm CMB}} \sin^2(2\alpha_{\rm cmb}) 
    + D_{\ell}^{BB,\,{\rm CMB}} \cos^2(2\alpha_{\rm cmb}) 
    + D_{\ell}^{EB,\,{\rm CMB}} \sin(4\alpha_{\rm cmb})
    \]
    \[
    \tilde{D}_{\ell}^{EB,\,{\rm CMB}} = \frac{1}{2} (D_{\ell}^{EE,\,{\rm CMB}} - D_{\ell}^{BB,\,{\rm CMB}}) \sin(4\alpha_{\rm cmb}) 
    + \frac{D_{\ell}^{EB,\,{\rm CMB}}}{\cos(4\alpha_{\rm cmb})}
    \]
  </p>
  <p>
    In many of our MCMC runs, we ultimately ignore \(\alpha_{\mathrm{cmb}}\) due
    to its high degeneracy with the per-frequency polarization angle miscalibration
    parameters.
  </p>
  <p>
    Dust foregrounds are modeled for each spectrum
    \(XY \in \{EE, BB, EB\}\) using the following power-law form:
  </p>

  <p>
    \[
    \hat{D}_\ell^{EE,\,\nu_1 \times \nu_2} =  
    \tilde{D}_\ell^{EE,\,{\rm CMB}} + f_d^{\nu_1}(\beta_d) f_d^{\nu_2}(\beta_d) A_d^{EE} \left(\frac{\ell}{80}\right)^{\alpha_d^{EE}} 
    \]
    \[
    \hat{D}_\ell^{BB,\,\nu_1 \times \nu_2} = 
    \tilde{D}_\ell^{BB,\,{\rm CMB}} + f_d^{\nu_1}(\beta_d) f_d^{\nu_2}(\beta_d) A_d^{BB} \left(\frac{\ell}{80}\right)^{\alpha_d^{BB}} 
    \]
    \[
    \hat{D}_\ell^{EB,\,\nu_1 \times \nu_2} = 
    \tilde{D}_\ell^{EB,\,{\rm CMB}} + f_d^{\nu_1}(\beta_d) f_d^{\nu_2}(\beta_d) A_d^{EB} \left(\frac{\ell}{80}\right)^{\alpha_d^{EB}} 
    \]
  </p>
  <p>
    where \(f_d^{\nu}\) is the bandpass function for each receiver. We assume the dust spectral index
    \(\beta_d\) is common across EE, BB, and EB, while the amplitude \(A_d^{XY}\)
    and spectral tilt \(\alpha_d^{XY}\) are allowed to differ between spectra.
    Note that the bandpass function appears twice to account for both frequencies
    in the cross-spectrum.
  </p>
  <p>
    For each frequency channel 
    \(\nu\in BK18_{220}\), \(BK18_{150}\), \(BK18_{K95}\), \(BK18_{B95e}\) (aka.\(BK18_{B95lf} \)), 
    we include a detector miscalibration angle
    \(\alpha_{\nu}\) that further rotates the spectra after foregrounds are added:
  </p>
  <p>
    \[
    \bar{D}_{\ell}^{EE,\,\nu_1 \times \nu_2} = \hat{D}_{\ell}^{EE} \cos(2\alpha^{\nu_1}) \cos(2\alpha^{\nu_2}) + 
    \hat{D}_{\ell}^{BB} \sin(2\alpha^{\nu_1}) \sin(2\alpha^{\nu_2}) - \hat{D}_{\ell}^{EB} \cos(2\alpha^{\nu_1}) \sin(2\alpha^{\nu_2}) - 
    \hat{D}_{\ell}^{BE} \sin(2\alpha^{\nu_1}) \cos(2\alpha^{\nu_2})
    \]
    \[
    \bar{D}_{\ell}^{BB,\,\nu_1 \times \nu_2} = \hat{D}_{\ell}^{EE} \sin(2\alpha^{\nu_1}) \sin(2\alpha^{\nu_2}) + 
    \hat{D}_{\ell}^{BB} \cos(2\alpha^{\nu_1}) \cos(2\alpha^{\nu_2}) + \hat{D}_{\ell}^{EB} \sin(2\alpha^{\nu_1}) \cos(2\alpha^{\nu_2}) + 
    \hat{D}_{\ell}^{BE} \cos(2\alpha^{\nu_1}) \sin(2\alpha^{\nu_2})
    \]
    \[
    \bar{D}_{\ell}^{EB,\,\nu_1 \times \nu_2} = \hat{D}_{\ell}^{EE} \cos(2\alpha^{\nu_1}) \sin(2\alpha^{\nu_2}) - 
    \hat{D}_{\ell}^{BB} \sin(2\alpha^{\nu_1}) \cos(2\alpha^{\nu_2}) + \hat{D}_{\ell}^{EB} \cos(2\alpha^{\nu_1}) \cos(2\alpha^{\nu_2}) - 
    \hat{D}_{\ell}^{BE} \sin(2\alpha^{\nu_1}) \sin(2\alpha^{\nu_2})
    \]
    \[
    \bar{D}_{\ell}^{BE,\,\nu_1 \times \nu_2} = \hat{D}_{\ell}^{EE} \sin(2\alpha^{\nu_1}) \cos(2\alpha^{\nu_2}) -
     \hat{D}_{\ell}^{BB} \cos(2\alpha^{\nu_1}) \sin(2\alpha^{\nu_2}) - \hat{D}_{\ell}^{EB} \sin(2\alpha^{\nu_1}) \sin(2\alpha^{\nu_2}) + 
     \hat{D}_{\ell}^{BE} \cos(2\alpha^{\nu_1}) \cos(2\alpha^{\nu_2})
    \]
  </p>
  <p>
    These per-frequency rotation parameters account for uncertainties in instrument
    polarization angle calibration, which can mimic or obscure a genuine cosmic
    birefringence signal. In most analyses, we marginalize over the \(\alpha_{\nu}\)
    parameters while setting \(\alpha_{\mathrm{cmb}} = 0\).
  </p>
<p>These steps are summarized in <a href="#fig-summary">Figure 1.1</a>.</p>
<figure id="fig-summary">
    <img src="visual_summary.png" width="750" height="500">
    <figcaption>
        <p>Overview of the EB spectrum modeling pipeline.<br>
            The primordial CMB polarization power spectra (EE, BB, and EB) are generated by early-universe physics.<br>
            A global cosmic birefringence angle rotates these spectra as the signal propagates through the universe.<br>
            Foreground dust contributions are added, modeled with frequency-dependent amplitudes and tilts.<br>
            Instrumental polarization angle miscalibrations, parameterized by per-frequency angles, apply an additional rotation specific to each receiver.
            </p>
    </figcaption>
</figure>
<h3>MCMC Likelihood Framework</h3>
<p>
    We use a likelihood-based framework to infer birefringence and detector miscalibration 
    angles from polarization power spectra. While our primary focus is on the 
    EB spectrum, where a nonzero signal indicates parity violation or systematics, our 
    framework is flexible and can incorporate EE and BB spectra as well.
  </p>
  <p>
    For each spectrum type (e.g., EB), we stack the bandpowers across all multipole bins 
    and frequency pairs (\( \nu_1 \times \nu_2 \)) into a single data vector. 
    The corresponding theoretical prediction is obtained by modeling the 
    effect of miscalibration on the CMB and early dark energy signals.
  </p>
  <p>
    The likelihood is defined as:
  </p>
  
  <p>
    \[
    -2\ln \mathcal{L} = 
    \left( \bar{D}_\ell^{\rm theory} - D_\ell^{\rm data} \right)^T 
    \Sigma^{-1} 
    \left( \bar{D}_\ell^{\rm theory} - D_\ell^{\rm data} \right)
    \]
  </p>
  <p>
    where \( D_\ell^{\rm data} \) are the measured bandpowers, 
    \( \bar{D}_\ell^{\rm theory} \) are the model predictions, and
     \( \Sigma \) is the covariance matrix derived from simulations. 
     The theory and data vectors stack each cross-spectrum from every pair 
     of frequencies that we wish to include, whether that is EB, EE, BB, 
     or some combination of the three spectra types. 
     The covariance accounts for both statistical uncertainties and systematics 
     such as instrumental noise and foreground residuals.
  </p>


  <p>
    The parameter vector is typically:
  </p>
  
  <p>
    \[
    \theta = \left\{ g, \{\alpha^\nu\}, \text{dust parameters}, \ldots \right\}
    \]
  </p>
  
  <p>
    We adopt uniform priors on all parameters.
  </p>
  
  <p>
    The posterior distribution \( P(\theta | D_{\ell}^{\rm data}) \propto \mathcal{L}(D|\theta)\,
    P(\theta) \) is explored using Markov Chain Monte Carlo (MCMC) via <code>Cobaya</code>. 
    Chains are run until convergence, assessed by the Gelman-Rubin criterion \( R-1 < 0.03 \),
     and constraints are quoted from marginalized posteriors.
  </p>
<h3>Further tests</h3>
<p>
    To test the impact of detector miscalibration on the best fit parameters, 
    we inject artificial rotation angles into the maps
    and fit the parameters using three combinations of spectra: EB only, EE + EB (excluding BB),
    and the full EE + EB + BB set. This progression allows us to isolate the influence of each
    spectrum type on the parameter recovery in the presence of injected signals.
</p>
<p>
    Finally, we assess the robustness of our constraints against different dust models by
    fitting over the dust scenarios presented in
    <a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20210122_BK18mm_final_altdust/">
        J. Willmert’s posting
    </a>. This helps determine whether the inferred coupling \( g \) is sensitive to dust modeling.
</p>

<h3>Differences from Mainline <em>r</em> Analysis</h3>
<p>
    Our analysis departs from the standard BICEP/Keck tensor-to-scalar ratio (<em>r</em>) pipeline in several key ways:
  </p>
  
  <ul>
    <li>
      <strong>Focus on EB:</strong> While the mainline analysis relies primarily on BB spectra,
       we incorporate the EB spectrum as the main observable, which is not used in the standard 
       <em>r</em> analysis beyond calibrating the detector rotation.
    </li>
    <li>
      <strong>Neglect of Synchrotron Radiation:</strong> 
      We assume negligible synchrotron emission and exclude it from the model. 
      In contrast, the main <em>r</em> pipeline jointly fits synchrotron and dust foregrounds.
    </li>
    <li>
      <strong>Gaussian Likelihood:</strong> 
      We use a Gaussian likelihood approximation for all spectra. 
      The standard <em>r</em> analysis uses Hamimeche–Lewis tailored to non-Gaussian distributions in low-ℓ BB.
    </li>
    <li>
      <strong>Extended Multipole Range:</strong> 
      Our analysis uses data up to bin 15 (ℓ ≈ 500), 
      beyond the typical BB-focused range of bins 2–10 used in the mainline analysis.
    </li>
    <li>
      <strong>EDE Signal Injection in EB Only:</strong> 
      We assume EDE only affects the EB spectrum, with no impact on EE or BB. 
      The mainline <em>r</em> analysis does not include any early dark energy modeling.
    </li>
  </ul>
  
  <p>
    These differences reflect the distinct goals of this analysis,
    namely, probing polarization rotation and early dark energy signatures in EB,
    rather than measuring the primordial gravitational wave amplitude via BB.
  </p>
    </section>



<section>
<h2>Initial Bias Checks</h2>
<p>
    The primary goal is to constrain to degeneracy between miscalibration-induced 
    polarization rotation and the EDE signal. Specifically, we evaluate the impact of the EDE signal injected exclusively 
    into the EB spectrum, as EE and BB modifications from EDE are expected to be negligible in 
    the absence of polarization rotation. Our MCMC pipeline assumes no EDE contributions to EE or BB.
  </p>
<p>
    We begin by running MCMC chains on two datasets: <strong>BK18lf</strong> (no EDE injection) 
    and <strong>BK18lf_fede01</strong> (EDE injected with \( f_{\mathrm{EDE}} = 0.07 \), \( g = 1 \)). 
    These datasets are based on the standard BK18 large-field map combination (3553×1459×5260×5261). 
    The only difference is that <strong>BK18lf_fede01</strong> includes a nonzero EB spectrum 
    corresponding to the best-fit EDE parameters from 
    <a href="https://arxiv.org/pdf/2209.07804">Murai (2022)</a>. Both datasets model gaussian dust.
This is further detailed in <a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20241203_multicomp_eb_ede_update/">
    2024-12-03: Multicomponent EB EDE Update</a></p> 
<p>
    We will also explore a grid of \( f_{\mathrm{EDE}} \) values for our final analysis to assess 
    the sensitivity across different EDE scenarios. While we begin with \( f_{\mathrm{EDE}} = 0.07 \) 
    (from <a href="https://arxiv.org/pdf/2209.07804">Murai 2022</a>), we will also consider values like 
    \( f_{\mathrm{EDE}} = 0.0872 \) and \( f_{\mathrm{EDE}} = 0.1271 \) as explored by 
    <a href="https://arxiv.org/pdf/2303.15369">Eskilt (2023)</a>.
  </p>  
  <p>
    For each dataset, we fit three spectrum combinations: EB only, EE + EB, and full EE + EB + BB. 
    Additionally, we evaluate two dust models for our likelihood function:
  </p>


  <ol>
    <li>
      <strong>Fixed dust:</strong> We set dust amplitude to zero, using base EE and BB theory curves (with lensing) 
      and an EB theory curve derived from the EDE model.
    </li>
    <li>
      <strong>Nominal dust:</strong> Here, we additionally fit for dust amplitude \( A_{\text{dust}} \) and 
      exponent \( \alpha_{\text{dust}} \), with separate parameters for each spectrum (EE, BB, EB). 
      The dust spectral index \( \beta \) is shared across all spectra.
    </li>
  </ol>
  <p>
    The goal of these initial checks is to recover the injected signals and demonstrate that our pipeline 
    does not introduce bias in the EDE coupling parameter \( g \). By simultaneously fitting dust parameters 
    with \( g \), we properly propagate dust uncertainties into the final errors, while potentially breaking 
    degeneracies between foreground EB and true polarization rotation. Jointly fitting dust with EE and BB 
    spectra also helps calibrate the polarization amplitude, leading to a more robust and bias-resistant 
    measurement of any cosmological birefringence or early dark energy signal.
  </p>

   <figure>
    <img alt="Multicomponent Analysis EB Spectrum" id="dustfigs" src="#" width="750" height="500" onerror="javascript:this.src='dne.png'" />
    <figcaption>
        <p>Interactive plot pager for multicomponent analysis of the Early Dark Energy (EDE) spectrum.
            Visualizes the fits and triangle plots for 499 simulations.</p>
        <ul>
            <li><strong>Map Type</strong>: Choose the type of plot to visualize:
                <ul>
                    <li>Best Fit EE: Displays best fit to the EE spectrum.</li>
                    <li>Best Fit EB: Displays best fit to the EB spectrum.</li>
                    <li>Best Fit BB: Displays best fit to the BB spectrum.</li>
                    <li>Triangle Plot: Shows parameter correlation contours.</li>
                    <li>Summary plot: shows the peaks of all the triangle plot sims.</li>
                </ul>
            </li>
            <li><strong>Bins Used</strong>: Choose the binning scheme applied to spectra:
                <ul>
                    <li>2–15: Uses bins 2 through 15.</li>
                </ul>
            </li>
            <li><strong>Dust model</strong>: Select the theoretical model used for comparison:
                <ul>
                    <li>Fixed dust fit: Dust parameters fixed to zero.</li>
                    <li>Nominal Dust fit: Dust parameters are floated in the fit.</li>
                </ul>
            </li>
            <li><strong>Spectra</strong>: Choose which spectra to include in the fit:
                <ul>
                    <li>All: Includes EE, EB, and BB.</li>
                    <li>No BB: Includes EE and EB only.</li>
                    <li>EB only: Only EB spectrum is used.</li>
                </ul>
            </li>
            <li><strong>Injected EDE Signal</strong>: Select which Early Dark Energy (EDE) signal was injected:
                <ul>
                    <li>Fede = 0.07, g = 1: Injected signal with EDE.</li>
                    <li>g = 0: No rotation, null birefringence.</li>
                </ul>
            </li>
            <li><strong>Map Sim num</strong>: Choose the simulation number (three digits) to view results for a particular realization.</li>
        </ul>
        <p>This interactive plot allows detailed exploration of multicomponent analysis by adjusting 
            map types, binning, theoretical assumptions, spectra selections, EDE signal injections, and simulation numbers.</p>
    </figcaption>

    <script type="text/javascript">
                function pad(num, size) {
                    num = num.toString();
                    while (num.length < size) num = "0" + num;
                    return num;
                }
                const simnums = [];
                for (let i = 0; i < 10; i++) {
                    s = pad(i, 1);

                    simnums[i] = s.concat('|', s);

                }

        pager.link("#dustfigs", {
            'Map Sim Num Digit1|digit1': simnums,
            'Digit2|digit2': simnums,
            'Digit3|digit3': simnums,

            'Map Type|m_map_type': [
                'Best Fit EE|_bestfitEE',
                'Best Fit EB|_bestfitEB',
                'Best Fit BB|_bestfitBB',
                'Triangle Plot|_triangle_plot',
                'Summary Plot (Peaks histogram)|sim1_summary'
            ],
            'Bins Used|bin_num15': [
                '2-15|_bin15',
            ],
            'Dust Model|theory_comp':[
                'Fixed dust = zero|_fixeddust',
                'Nominal dust|_gdust',
            ],
            'Spectra|spectra':[
                'All|_all',
                'No BB|_nob',
                'EB only|_eb',
            ],
            'Injected EDE Signal|ede': [
                'Fede = 0.07, g = 1|fede01',
                'g = 0|zeroeb'
            ]
        },
        function (params) {
            let dirbase = '/liuto'
            let dirpath = dirbase + '/ede_chains/';
            let mcmc_folder = params.ede + params.bin_num15 + params.theory_comp + params.spectra + '/';
            let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
            let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
            if(params.m_map_type == 'sim1_summary'){
                name = dirpath + mcmc_folder + params.m_map_type + '.png'
            }
            console.log(name);
            return name;
        });

        pager.setparams({
            'digit1':'0',
            'digit2': '0',
            'digit3': '1',
            'm_map_type': '_bestfitEB',
            'bin_num15': '_bin15',
            'ede': 'zeroeb',
            'spectra':'_all',
            'theory_comp':'_fixeddust',
        });
    </script>
</figure>
<p>
    We notice that for the best-fit BB plots, when BB is not included in the fit,  
    the model deviates significantly from the data.  
    This mismatch is not driven by polarization rotation or <em>g</em>,  
    but rather by the fact that BB dust becomes unconstrained when excluded from the fit.  
    This effect is further supported by the behavior seen in the signal-only (sigl) plots.
  </p>
  <h3>Bias Check Results</h3>
  <p>
    Below is a summary of the results over the peaks of the simulations.
  </p>
  <h4>ML search results for <em>g</em> = 0 (fixed dust model).</h4>
<p>
     We see that while there  
    is a slight positive bias for <em>g</em> and a slight negative bias for  
    the polarization rotation angles, those biases remain small compared to  
    the overall posterior spread.
  </p>
<table>
    <caption>ML search results for <em>g</em> = 0 (fixed dust model)</caption>
    <thead>
      <tr>
        <th>Spectra</th>
        <th>g</th>
        <th>α<sub>220</sub> (°)</th>
        <th>α<sub>150</sub> (°)</th>
        <th>α<sub>K95</sub> (°)</th>
        <th>α<sub>B95lf</sub> (°)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>All</th>
        <td>0.03 ± 0.27</td>
        <td>-0.01 ± 0.22</td>
        <td>-0.01 ± 0.14</td>
        <td>-0.01 ± 0.23</td>
        <td>-0.02 ± 0.13</td>
      </tr>
      <tr>
        <th>No BB</th>
        <td>0.05 ± 0.37</td>
        <td>-0.03 ± 0.24</td>
        <td>-0.03 ± 0.19</td>
        <td>-0.02 ± 0.26</td>
        <td>-0.03 ± 0.18</td>
      </tr>
      <tr>
        <th>EB only</th>
        <td>0.03 ± 0.37</td>
        <td>-0.02 ± 0.24</td>
        <td>-0.02 ± 0.19</td>
        <td>-0.02 ± 0.26</td>
        <td>-0.02 ± 0.18</td>
      </tr>
    </tbody>
  </table>
  <h4>ML search results for <em>g</em> = 1 (fixed dust model).</h4>
  <p>
    For <em>g</em> = 1, fitting to all three spectra yields a pronounced  
    suppression of the recovered coupling, offset by large positive shifts in each  
    rotation angle. This behaviour reflects a degeneracy between the injected EDE signal  
    and polarization miscalibration.  
    Omitting the BB spectrum from the ML search restores the recovered coupling distribution  
    to match the <em>g</em> = 0 case, albeit with a slightly broader posterior, demonstrating  
    that the BB data drive the apparent bias in the full-spectrum analysis.
  </p>
  <table>
    ML search results for <em>g</em> = 1 (fixed dust model)
    <thead>
      <tr>
        <th>Spectra</th>
        <th>g</th>
        <th>α<sub>220</sub> (°)</th>
        <th>α<sub>150</sub> (°)</th>
        <th>α<sub>K95</sub> (°)</th>
        <th>α<sub>B95lf</sub> (°)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>All</th>
        <td>0.62 ± 0.27</td>
        <td>0.20 ± 0.24</td>
        <td>0.18 ± 0.15</td>
        <td>0.15 ± 0.24</td>
        <td>0.16 ± 0.14</td>
      </tr>
      <tr>
        <th>No BB</th>
        <td>1.02 ± 0.44</td>
        <td>-0.04 ± 0.25</td>
        <td>-0.02 ± 0.21</td>
        <td>-0.03 ± 0.26</td>
        <td>-0.03 ± 0.19</td>
      </tr>
      <tr>
        <th>EB only</th>
        <td>1.00 ± 0.42</td>
        <td>-0.03 ± 0.25</td>
        <td>-0.01 ± 0.20</td>
        <td>-0.02 ± 0.23</td>
        <td>-0.02 ± 0.19</td>
      </tr>
    </tbody>
  </table>
  <h4>ML search results for <em>g</em> = 0 (nominal dust model)</h4>
  <p>
     We see similar results to  
    the <em>g</em> = 0 case without dust, albeit with slightly broader posteriors.  
    Allowing dust parameters to float propagates their uncertainty into other  
    parameters such as <em>g</em> and the rotation angles.  
    When fitting all three spectra, the EE and BB dust parameters are well constrained.  
    The EB dust amplitude, however, peaks at zero, leaving  
    \( \alpha_{\text{dust}} \) poorly determined. This is evident from the fact that  
    the summary‐level spread is much smaller than the spread seen in individual  
    simulations, reflecting the influence of the prior constraint.  
    Excluding BB from the fit causes the BB dust parameters to become unconstrained,  
    allowing individual‐simulation spreads to reach the prior bounds while the  
    summary distribution remains narrow. The same effect occurs when excluding EE,  
    in which case the dust spectral index \( \beta \) also becomes poorly constrained.  
    In all scenarios, the recovered rotation angles and <em>g</em> remain consistent,  
    differing only by modest increases in their posterior widths.  
  </p>
  
  <table>
    <caption>ML search results for <em>g</em> = 0 (nominal dust model)</caption>
    <thead>
      <tr>
        <th>Spectra</th>
        <th>g</th>
        <th>α<sub>220</sub> (°)</th>
        <th>α<sub>150</sub> (°)</th>
        <th>α<sub>K95</sub> (°)</th>
        <th>α<sub>B95lf</sub> (°)</th>
        <th>A<sub>dust</sub><sup>EE</sup></th>
        <th>α<sub>dust</sub><sup>EE</sup></th>
        <th>A<sub>dust</sub><sup>BB</sup></th>
        <th>α<sub>dust</sub><sup>BB</sup></th>
        <th>A<sub>dust</sub><sup>EB</sup></th>
        <th>α<sub>dust</sub><sup>EB</sup></th>
        <th>β</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>All</th>
        <td>0.03 ± 0.31</td>
        <td>0.01 ± 0.22</td>
        <td>-0.02 ± 0.17</td>
        <td>0.02 ± 0.27</td>
        <td>-0.02 ± 0.15</td>
        <td>7.7 ± 1.3</td>
        <td>-0.33 ± 0.18</td>
        <td>3.86 ± 0.8</td>
        <td>-0.31 ± 0.18</td>
        <td>0.00 ± 0.40</td>
        <td>—</td>
        <td>1.68 ± 0.15</td>
      </tr>
      <tr>
        <th>No BB</th>
        <td>0.04 ± 0.38</td>
        <td>-0.01 ± 0.26</td>
        <td>-0.04 ± 0.21</td>
        <td>0.01 ± 0.29</td>
        <td>-0.03 ± 0.18</td>
        <td>8.36 ± 1.46</td>
        <td>-0.33 ± 0.18</td>
        <td>—</td>
        <td>—</td>
        <td>-0.07 ± 0.45</td>
        <td>—</td>
        <td>1.79 ± 0.26</td>
      </tr>
      <tr>
        <th>EB only</th>
        <td>0.03 ± 0.38</td>
        <td>0.00 ± 0.25</td>
        <td>-0.03 ± 0.21</td>
        <td>0.02 ± 0.28</td>
        <td>-0.02 ± 0.18</td>
        <td>—</td>
        <td>—</td>
        <td>—</td>
        <td>—</td>
        <td>-0.03 ± 0.45</td>
        <td>—</td>
        <td>—</td>
      </tr>
    </tbody>
  </table>
  <h4>ML search results for <em>g</em> = 1 (nominal dust model)</h4>
  <p>
    Fitting all three spectra again yields suppression of the recovered coupling,  
    compensated by shifts in the rotation angles, reflecting a degeneracy between  
    the injected EDE signal and polarization miscalibration.  
    Omitting BB or using EB‑only restores the coupling to the expected value,  
    with only modest increases in uncertainty, consistent with the fixed dust  
    <em>g</em> = 1 case.  
    Similar to the <em>g</em> = 0 results, the EE and BB dust amplitudes and spectral index  
    remain well constrained in the full‑spectrum fit, while the EB dust amplitude stays  
    unconstrained.  
    Removing BB or EE leaves the corresponding dust parameters driven by the priors.  
    Across all configurations, the recovered coupling and rotation angles remain stable,  
    demonstrating the pipeline’s robustness.  
 
  </p>
  <table>
    <caption>ML search results for <em>g</em> = 1 (nominal dust model)</caption>
    <thead>
      <tr>
        <th>Spectra</th>
        <th>g</th>
        <th>α<sub>220</sub> (°)</th>
        <th>α<sub>150</sub> (°)</th>
        <th>α<sub>K95</sub> (°)</th>
        <th>α<sub>B95lf</sub> (°)</th>
        <th>A<sub>dust</sub><sup>EE</sup></th>
        <th>α<sub>dust</sub><sup>EE</sup> (°)</th>
        <th>A<sub>dust</sub><sup>BB</sup></th>
        <th>α<sub>dust</sub><sup>BB</sup> (°)</th>
        <th>A<sub>dust</sub><sup>EB</sup></th>
        <th>α<sub>dust</sub><sup>EB</sup> (°)</th>
        <th>β</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>All</th>
        <td>0.73 ± 0.30</td>
        <td>0.10 ± 0.25</td>
        <td>0.13 ± 0.16</td>
        <td>0.12 ± 0.22</td>
        <td>0.13 ± 0.17</td>
        <td>7.65 ± 1.47</td>
        <td>-0.40 ± 0.22</td>
        <td>3.54 ± 0.74</td>
        <td>-0.31 ± 0.20</td>
        <td>-0.03 ± 0.33</td>
        <td>—</td>
        <td>1.60 ± 0.14</td>
      </tr>
      <tr>
        <th>No BB</th>
        <td>0.98 ± 0.42</td>
        <td>-0.02 ± 0.25</td>
        <td>0.00 ± 0.20</td>
        <td>-0.01 ± 0.25</td>
        <td>-0.02 ± 0.18</td>
        <td>8.24 ± 1.66</td>
        <td>-0.39 ± 0.21</td>
        <td>—</td>
        <td>—</td>
        <td>0.02 ± 0.36</td>
        <td>—</td>
        <td>1.76 ± 0.26</td>
      </tr>
      <tr>
        <th>EB only</th>
        <td>1.00 ± 0.42</td>
        <td>-0.03 ± 0.25</td>
        <td>-0.01 ± 0.20</td>
        <td>-0.03 ± 0.27</td>
        <td>-0.02 ± 0.19</td>
        <td>—</td>
        <td>—</td>
        <td>—</td>
        <td>—</td>
        <td>0.02 ± 0.38</td>
        <td>—</td>
        <td>—</td>
      </tr>
    </tbody>
  </table>
  <h3>Examining BB Signal Only</h3>
  <p>
    We initially found it concerning that the recovered coupling <em>g</em> was heavily suppressed  
    when including the BB spectrum.  
    To investigate this further, we performed ML searchs on a “signal‑only” <em>g</em> = 1 dataset  
    with no dust or noise, comparing chains with and without BB to isolate its impact.
  </p>
<figure>
    <img alt="Multicomponent Analysis EB Spectrum" id="sigl" src="#" width="750" height="500" onerror="javascript:this.src='dne.png'" />
    <figcaption>
        <p>Interactive plot pager for multicomponent analysis of the Early Dark Energy (EDE) spectrum.
            Visualizes the fits and triangle plots for 499 simulations.</p>
        <ul>
            <li><strong>Map Type</strong>: Choose the type of plot to visualize:
                <ul>
                    <li>Best Fit EE: Displays best fit to the EE spectrum.</li>
                    <li>Best Fit EB: Displays best fit to the EB spectrum.</li>
                    <li>Best Fit BB: Displays best fit to the BB spectrum.</li>
                    <li>Triangle Plot: Shows parameter correlation contours.</li>
                    <li>Summary plot: shows the peaks of all the triangle plot sims.</li>
                </ul>
            </li>
            <li><strong>Bins Used</strong>: Choose the binning scheme applied to spectra:
                <ul>
                    <li>2–15: Uses bins 2 through 15.</li>
                </ul>
            </li>
            <li><strong>Model</strong>: Select the theoretical model used for comparison:
                <ul>
                    <li>Fixed dust fit: Dust parameters fixed to zero.</li>
                    <li>Nominal Dust fit: Dust parameters are floated in the fit.</li>
                    <li>Signal Only: Only the injected signal is fit, no dust model or noise in data.</li>
                    <li>Fixed angle signal only: Signal-only fit with angle fixed to 0.</li>
                </ul>
            </li>
            <li><strong>Spectra</strong>: Choose which spectra to include in the fit:
                <ul>
                    <li>All: Includes EE, EB, and BB.</li>
                    <li>No BB: Includes EE and EB only.</li>
                    <li>EB only: Only EB spectrum is used.</li>
                </ul>
            </li>
            <li><strong>Injected EDE Signal</strong>: Select which Early Dark Energy (EDE) signal was injected:
                <ul>
                    <li>Fede = 0.07, g = 1: Injected signal with EDE.</li>
                    <li>g = 0: No rotation, null birefringence.</li>
                </ul>
            </li>
            <li><strong>Map Sim num</strong>: 
                Choose the simulation number (three digits) to view results for a particular realization.</li>
        </ul>
        <p>This interactive plot allows detailed exploration of multicomponent analysis by adjusting 
            map types, binning, theoretical assumptions, spectra selections, EDE signal injections, and simulation numbers.</p>
    </figcaption>

    <script type="text/javascript">

        pager.link("#sigl", {
            'Map Sim Num Digit1|digit1': simnums,
            'Digit2|digit2': simnums,
            'Digit3|digit3': simnums,

            'Map Type|m_map_type': [
                'Best Fit EE|_bestfitEE',
                'Best Fit EB|_bestfitEB',
                'Best Fit BB|_bestfitBB',
                'Triangle Plot|_triangle_plot',
                'Summary Plot (Peaks histogram)|sim1_summary'
            ],
            'Bins Used|bin_num15': [
                '2-15|_bin15',
            ],
            'Model|theory_comp':[
                'Fixed dust fit|_fixeddust',
                'Nominal Dust fit|_gdust',
                'Signal Only|_sigl',
                'Fixed angle signal only|_sigl_fixedangle'
            ],
            'Spectra|spectra':[
                'All|_all',
                'No BB|_nob',
                'EB only|_eb',
            ],
            'Injected EDE Signal|ede': [
                'Fede = 0.07, g = 1|fede01',
            ]
        },
        function (params) {
            let dirbase = '/liuto'
            let dirpath = dirbase + '/ede_chains/';
            let mcmc_folder = params.ede + params.bin_num15 + params.theory_comp + params.spectra + '/';
            let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
            let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
            if(params.m_map_type == 'sim1_summary'){
                name = dirpath + mcmc_folder + params.m_map_type + '.png'
            }
            console.log(name);
            return name;
        });

        pager.setparams({
            'digit1':'0',
            'digit2': '0',
            'digit3': '1',
            'm_map_type': '_bestfitEB',
            'bin_num15': '_bin15',
            'ede': 'zeroeb',
            'spectra':'_all',
            'theory_comp':'_fixeddust',
        });
    </script>
</figure>
<p>
    For the signal‑only dataset with <em>g</em> = 1, fitting all three spectra again recovers a slightly  
    suppressed value of the coupling with small, consistent positive shifts in the rotation angles.  
    Similarly, removing BB or using EB only restores the coupling to its true injected value,  
    while all rotation angles shift back to near zero.  
    These results clearly demonstrate that BB is the primary spectrum causing suppression of 
    recovering the early dark energy signal, while EB is responsible for breaking the degeneracy  
    with polarization angle miscalibration.
  </p>

  <table>
    <caption>ML search results for <em>g</em> = 1 (signal‑only “sigl” dataset)</caption>
    <thead>
      <tr>
        <th>Spectra</th>
        <th><em>g</em></th>
        <th>α<sub>220</sub> (°)</th>
        <th>α<sub>150</sub> (°)</th>
        <th>α<sub>K95</sub> (°)</th>
        <th>α<sub>B95lf</sub> (°)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>All</th>
        <td>0.69 ± 0.17</td>
        <td>0.12 ± 0.08</td>
        <td>0.12 ± 0.09</td>
        <td>0.12 ± 0.10</td>
        <td>0.12 ± 0.08</td>
      </tr>
      <tr>
        <th>No BB</th>
        <td>0.97 ± 0.25</td>
        <td>-0.01 ± 0.12</td>
        <td>0.00 ± 0.12</td>
        <td>-0.01 ± 0.13</td>
        <td>0.00 ± 0.12</td>
      </tr>
      <tr>
        <th>EB Only</th>
        <td>0.97 ± 0.25</td>
        <td>-0.01 ± 0.12</td>
        <td>-0.01 ± 0.12</td>
        <td>-0.01 ± 0.13</td>
        <td>-0.01 ± 0.12</td>
      </tr>
    </tbody>
  </table>
  <p>
    When examining the BB and EB spectra individually across realizations, we observe a subtle trade-off in the fits  
    depending on whether the BB spectrum is included in the analysis.  
    In the <em>No BB</em> case, the BB spectrum shows a slightly worse fit, while the EB spectrum improves.  
    Conversely, when fitting <em>All</em> spectra, the BB fit improves slightly, but the EB fit becomes poorer.  
    This pattern suggests that the MCMC chains are compensating for tension in the BB spectrum  
    by significantly adjusting the value of <em>g</em>.  
    In other words, the BB data appear to exert a stronger influence on the inferred coupling than is physically expected,  
    pulling the best-fit <em>g</em> away from its true value in order to improve agreement with BB,  
    even at the cost of worsening the EB fit.
  </p>
  <p>
    We also try performing the <code>sigl</code> fit with every rotation angle fixed to zero. 
    In this case, we successfully recover the expected <em>g</em> = 1, even when using BB. 
    This indicates that the chi-squared contribution from BB is dominating more than it should, 
    causing the polarization rotation angles to shift and <em>g</em> to be suppressed in order 
    to satisfy the fit. Even though these changes are visually tiny, they show that the 
    BB spectrum is influencing the <em>g</em> estimation more than expected.
  </p>
  <h4>BB g suppression explanations</h4>
  <p>
    There are a few possible explanations for this behavior.  
    The first is that while generating the <code>fede01</code>, <em>g</em> = 1 simulations,  
    we did not alter the BB or EE spectra at all; only an EDE signal was added to EB.  
    This could explain why BB causes a suppression of <em>g</em>, as BB is slightly more sensitive  
    to EDE than EE.  
    However, since the simulations have no injected miscalibration angle,  
    there should be no polarization rotation, and no EDE signal from EB should have been  
    rotated into BB, unless there were unforeseen mechanisms in the simulation generation pipeline  
    allowing EB leakage into BB.  
    Ideally, the best-fit result for BB should aim to capture zero rotation unaffected by EDE signal.  
    Instead, the fit appears to produce a nonzero combination of EDE and rotation  
    that better accommodates discrepancies in the BB lensing signals.
  </p>
  <p>
    Another possible explanation is that the approximations used in generating the band power 
  window functions or covariance matrices assume a negligible EB signal,consistent with ΛCDM, 
  where the theoretical expectation for EB is zero and only noise contributes to its observed amplitude.  
  Injecting an EDE signal increases the EB power by more than an order of magnitude, 
  potentially violating the assumptions underlying these approximations and introducing spurious 
  coupling into BB.  
  However, this hypothesis is not strongly supported by later results.  
  When we inject a pure polarization rotation, which similarly boosts EB power, 
  we do not observe the same BB-driven suppression of the coupling parameter <em>g</em>.  
  This suggests that the suppression may be a specific feature of how EDE modifies the 
  spectrum and interacts with the pipeline, rather than a general breakdown of approximation validity.
  </p>
  <p>
    It is also possible that a bug in the analysis code could be driving this behavior.  
    However, this seems unlikely, as all other fits behave as expected, and the transitions  
    between <em>All</em> and <em>No BB</em> configurations appear smooth and continuous.  
    In particular, when we manually downweight the chi-squared contribution from the BB residuals,  
    the recovered parameter values gradually interpolate between the <em>All</em> and <em>No BB</em> fits.  
    This continuity suggests the MCMC pipeline is functioning properly and the anomalous influence of BB  
    is likely a genuine feature of the data-model interaction rather than an implementation error.
  </p>
  <p>
    Ultimately, we may not need to be overly concerned about this BB-induced suppression of <em>g</em>,  
    since our analysis focuses on the regime where <em>g</em> &lt; 0.2, closer to the <em>g</em> = 0 case.  
    In this regime, the dominant sensitivity to <em>g</em> comes from the EB spectrum,  
    and the BB spectrum is primarily included to constrain dust.  
    BB should not significantly impact the recovered value of <em>g</em> or the polarization rotation angles.  
    Therefore, it is sufficient to verify that including all spectra does not shift the rotation angles  
    compared to using EB only, which we trust to provide the most direct constraint.  
    As long as this consistency holds, the presence of BB should not compromise our conclusions.
  </p>
<p>
   
</p>
    </section>
 
<section>

<h2>Injecting detector rotation miscalibration</h2>

<h3>Pipeline Validation Checks</h3>
<ul>
  <li>Injected rotation angles are recovered accurately with no artificial inflation of ( g ).</li>
  <li>EB-only results align with All-spectra fits when BB is downweighted.</li>
  
</ul>
<p>
    We perform an additional check to ensure that we can break the degeneracy between polarization rotation and the EDE signal.  
    In this test, we inject different rotation angles directly into the spectra after they have been generated through the BK18 pipeline.  
    We then attempt to recover these injected signals for both the <em>g</em> = 0 case and the <em>g</em> = 1 case.  
    The goal of this check is twofold: first, to confirm that if we had a nonzero <em>g</em> value, it would not be suppressed,  
    and second, to demonstrate that if <em>g</em> were truly zero, the injected rotation angles would not lead us to falsely infer a nonzero <em>g</em>.  
    This provides further confidence that our analysis is robust and that the polarization rotation angles do not artificially bias the <em>g</em> estimation.
  </p>
<p>
    The injected rotation angles (in degrees) for BK18_220, BK18_150, BK18_K95, and BK18_B95e
    (B95lf) are grouped as follows:
</p>

<ul>
    <li><strong>Positive:</strong> 0, 0.25, 0.5, 0.75</li>
    <li><strong>Negative:</strong> 0, -0.25, -0.5, -0.75</li>
    <li><strong>Balanced:</strong> -1, -0.5, 0, 0.5</li>
</ul>
<figure>
    <img alt="Fitting to injected miscalibration" id="polrot" src="#" width="750" height="500" onerror="javascript:this.src='dne.png'" />
    <figcaption>
        <p>Interactive plot pager for multicomponent analysis of the Early Dark Energy (EDE) spectrum.
            Visualizes the fits and triangle plots for 499 simulations.</p>
        <ul>
            <li><strong>Map Type</strong>: Choose the type of plot to visualize:
                <ul>
                    <li>Best Fit EE: Displays best fit to the EE spectrum.</li>
                    <li>Best Fit EB: Displays best fit to the EB spectrum.</li>
                    <li>Best Fit BB: Displays best fit to the BB spectrum.</li>
                    <li>Triangle Plot: Shows parameter correlation contours.</li>
                    <li>Summary plot: shows the peaks of all the triangle plot sims.</li>
                </ul>
            </li>
            <li><strong>Bins Used</strong>: Choose the binning scheme applied to spectra:
                <ul>
                    <li>2–15: Uses bins 2 through 15.</li>
                </ul>
            </li>
            <li><strong>Injected Signal</strong>: Select the detector miscalibration angle to inject into the sim, units in degrees
                <ul>
                <li>No Miscalibration: Nothing is injected</li>
                <li>Positive Miscalibration: Injected rotation of 0, 0.25, 0.5, 0.75</li>
                <li>Negative Miscalibration: Injected rotation of 0, -0.25, -0.5, -0.75</li>
                <li>Blanaced Miscalibration: Injected rotation of 0.5, 0, -0,5, -1</li>

                </ul>
            </li>
            <li><strong>Spectra</strong>: Choose which spectra to include in the fit:
                <ul>
                    <li>All: Includes EE, EB, and BB.</li>
                    <li>No BB: Includes EE and EB only.</li>
                    <li>EB only: Only EB spectrum is used.</li>
                </ul>
            </li>
            </li>
            <li><strong>Map Sim num</strong>: Choose the simulation number (three digits) to view results for a particular realization.</li>
        </ul>
        <p>This interactive plot allows detailed exploration of multicomponent analysis by adjusting 
            map types, binning, theoretical assumptions, spectra selections, EDE signal injections, and simulation numbers.</p>
    </figcaption>

    <script type="text/javascript">

        pager.link("#polrot", {
            'Map Sim Num Digit1|digit1': simnums,
            'Digit2|digit2': simnums,
            'Digit3|digit3': simnums,

            'Map Type|m_map_type': [
                'Best Fit EE|_bestfitEE',
                'Best Fit EB|_bestfitEB',
                'Best Fit BB|_bestfitBB',
                'Triangle Plot|_triangle_plot',
                'Summary Plot (Peaks histogram)|sim1_summary'
            ],
            'Bins Used|bin_num15': [
                '2-15|_bin15',
            ],
            'Injected Signal|inj_sig':[
                'Positive Miscalibration|_sigpos',
                'Negative Miscalibration|_signeg',
                'Balanced Miscalibration|_sigbal',
                ],
            'Spectra|spectra':[
                'All|_all',
                'No  BB|_nob',
                'EB Only|_eb',
            ],
            'Injected EDE Signal|ede1': [
                'g = 1, fede=0.07|fede01'
            ]
        },
        function (params) {
            let dirbase2 = '/liuto'
            let dirpath = dirbase2 + '/ede_chains/';
            let mcmc_folder = params.ede1 + params.bin_num15 + '_gdust' + params.spectra + params.inj_sig + '/';
            let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
            let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
            if(params.m_map_type == 'sim1_summary'){
                name = dirpath + mcmc_folder + params.m_map_type + '.png'
            }
            console.log(name);
            return name;
        });

        pager.setparams({
            'digit1':'0',
            'digit2': '0',
            'digit3': '1',
            'm_map_type': '_bestfitEB',
            'bin_num15': '_bin15',
            'ede1': 'fede01',
            'spectra':'_all',
            'inj_sig': '_sigpos',
        });
    </script>
</figure>

<p>
    <strong>Table: Recovered <em>g</em> Values for Different Miscalibration Scenarios</strong>
  </p>
  
  <p><strong>g = 0 (Fixed Dust Model)</strong></p>
  <table border="1">
    <tr>
      <th>Spectra</th>
      <th>Positive Miscal</th>
      <th>Negative Miscal</th>
      <th>Balanced Miscal</th>
    </tr>
    <tr>
      <td>All</td>
      <td>0.04 ± 0.31</td>
      <td>0.01 ± 0.31</td>
      <td>0.02 ± 0.30</td>
    </tr>
    <tr>
      <td>No BB</td>
      <td>0.03 ± 0.38</td>
      <td>0.05 ± 0.38</td>
      <td>0.03 ± 0.38</td>
    </tr>
    <tr>
      <td>EB Only</td>
      <td>0.04 ± 0.37</td>
      <td>0.03 ± 0.38</td>
      <td>0.03 ± 0.37</td>
    </tr>
  </table>
  
  <p><strong>g = 1 (Nominal Dust Model)</strong></p>
  <table border="1">
    <tr>
      <th>Spectra</th>
      <th>Positive Miscal</th>
      <th>Negative Miscal</th>
      <th>Balanced Miscal</th>
    </tr>
    <tr>
      <td>All</td>
      <td>1.07 ± 0.39</td>
      <td>0.51 ± 0.21</td>
      <td>0.81 ± 0.34</td>
    </tr>
    <tr>
      <td>No BB</td>
      <td>0.98 ± 0.43</td>
      <td>0.99 ± 0.44</td>
      <td>0.97 ± 0.43</td>
    </tr>
    <tr>
      <td>EB Only</td>
      <td>0.97 ± 0.42</td>
      <td>0.98 ± 0.42</td>
      <td>0.97 ± 0.42</td>
    </tr>
  </table>
  
  <p>
    For <em>g = 0</em> (fixed dust model), the recovered values of <em>g</em> 
    are consistent across all miscalibration cases. 
    The values are all close to zero, indicating that the model is not biased 
    by the polarization rotation or other factors under these conditions.
    The spread of uncertainties is relatively consistent, with small variations
     between the different miscalibration types.
    </p>
    <p>
    For <em>g = 1</em> (nominal dust model), the recovered <em>g</em> values 
    exhibit more variation, especially in the <strong>All spectra</strong> case. 
    This suggests that the inclusion of BB spectra, with its sensitivity to dust, 
    affects the recovered coupling constant <em>g</em> The values for <em>g</em> in the 
    <strong>No BB</strong> and <strong>EB Only</strong> cases are more stable and 
    align closely with the expected value of <em>g = 1</em>, with only slight variations 
    in the uncertainties due to miscalibration.
  </p>
  <p>
    Importantly, the fact that the results for <strong>EB Only</strong> match closely with those for 
    <strong>All spectra</strong> in the <em>g = 1</em> case, while the inclusion of BB does not 
    significantly change the recovered values of <em>g</em> or the rotation angles, 
    means that we can trust these results. As long as the <strong>EB Only</strong> results align with the
    <strong>All spectra</strong> results, we can be confident that the recovered parameters are not being 
    unduly influenced by the BB spectra, which are primarily used for dust constraints.
  </p>
</section>

<section>
    <h2>Fitting to datasets with different dust models</h2>
    <p> Since these dust foregrounds can impact the results, 
        it's important to ensure that the dust models used are reliable and do not 
        introduce significant biases into the cosmological parameters being measured. </p>

     <p> The dust models employed in this analysis are based on a range of approaches, 
        as detailed in 
        <a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20210122_BK18mm_final_altdust/">
            Willmert's posting</a>.
        The pager below shows the MCMC plots for various dust models, 
         including "No Dust" (for comparison) and several different standard dust models, 
         such as Gaussian Dust, PySM models, and others like MHD, MKD, Gdecorr, and Gampmod.
          Each of these models represents a different method for characterizing the galactic 
          dust foregrounds, but the goal is to show that, despite the differences in the 
          dust models, the recovered value of the coupling parameter <em>g</em> remains 
          consistent across all of them. </p>
 <figure>
     <img alt="Fitting to different dust models" id="dustmodels" src="#" width="750" height="500" onerror="javascript:this.src='dne.png'" />
     <figcaption>
         <p>Interactive plot pager for multicomponent analysis of the Early Dark Energy (EDE) spectrum.
             Visualizes the fits and triangle plots for 499 simulations.</p>
         <ul>
             <li><strong>Map Type</strong>: Choose the type of plot to visualize:
                 <ul>
                     <li>Best Fit EE: Displays best fit to the EE spectrum.</li>
                     <li>Best Fit EB: Displays best fit to the EB spectrum.</li>
                     <li>Best Fit BB: Displays best fit to the BB spectrum.</li>
                     <li>Triangle Plot: Shows parameter correlation contours.</li>
                     <li>Summary plot: shows the peaks of all the triangle plot sims.</li>
                 </ul>
             </li>
             <li><strong>Bins Used</strong>: Choose the binning scheme applied to spectra:
                 <ul>
                     <li>2–15: Uses bins 2 through 15.</li>
                 </ul>
             </li>
             <li><strong>Dust model</strong>: Select the theoretical dust model used for comparison:
                 <ul>
                 Dust models acquired from 
                 <a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20210122_BK18mm_final_altdust/">J. Willmert's posting</a>
                 </ul>
             </li>
             </li>
             <li><strong>Map Sim num</strong>: Choose the simulation number (three digits) to view results for a particular realization.</li>
         </ul>
         <p>This interactive plot allows detailed exploration of multicomponent analysis by adjusting 
            map types, binning, theoretical assumptions, spectra selections, EDE signal injections, and simulation numbers.</p>
     </figcaption>
 
     <script type="text/javascript">
 
         pager.link("#dustmodels", {
             'Map Sim Num Digit1|digit1': simnums,
             'Digit2|digit2': simnums,
             'Digit3|digit3': simnums,
 
             'Map Type|m_map_type': [
                 'Best Fit EE|_bestfitEE',
                 'Best Fit EB|_bestfitEB',
                 'Best Fit BB|_bestfitBB',
                 'Triangle Plot|_triangle_plot',
                 'Summary Plot (Peaks histogram)|sim1_summary'
             ],
             'Bins Used|bin_num15': [
                 '2-15|_bin15',
             ],
             'Dust model|dust_model':[
                 'No Dust|_nodust',
                 'Gaussian Dust|_gdust',
                 'pysm1|_pysm1',
                 'pysm2|_pysm2',
                 'pysm3|_pysm3',
                 'mhd|_mhd',
                 'mkd|_mkd',
                 'gdecorr|_gdecorr',
                 'gampmod|_gampmod',
                 'vansyngel|_vansyngel',
 
             ],
             'Spectra|spectrad':[
                 'All|_all',
             ],
             'Injected EDE Signal|eded': [
                 'g = 0|zeroeb'
             ]
         },
         function (params) {
             let dirbase2 = '/liuto'
             let dirpath = dirbase2 + '/ede_chains/';
             let mcmc_folder = params.eded + params.bin_num15 + params.dust_model + params.spectrad + '/';
             let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
             let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
             if(params.m_map_type == 'sim1_summary'){
                 name = dirpath + mcmc_folder + params.m_map_type + '.png'
             }
             console.log(name);
             return name;
         });
 
         pager.setparams({
             'digit1':'0',
             'digit2': '0',
             'digit3': '1',
             'm_map_type': '_bestfitEB',
             'bin_num15': '_bin15',
             'eded': 'zeroeb',
             'spectrad':'_all',
             'dust_model':'_pysm1',
         });
     </script>
 </figure>
 <p> As seen in the table below, the recovered <em>g</em> values across all dust models 
    are similar, suggesting that the dust foregrounds do not significantly affect the
     measurement of <em>g</em>. 
     This indicates that the <em>g</em> parameter is well-constrained, 
     and the dust models used here are not introducing large biases 
     into the analysis. </p>
 <table border="1">
    <thead>
      <tr>
        <th>Model</th>
        <th>No Dust</th>
        <th>Gaussian Dust</th>
        <th>pysm1</th>
        <th>pysm2</th>
        <th>pysm3</th>
        <th>mhd</th>
        <th>mkd</th>
        <th>gdecorr</th>
        <th>gampmod</th>
        <th>vansyngel</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>g</td>
        <td>0.04&plusmn;0.31</td>
        <td>0.03&plusmn;0.31</td>
        <td>-0.02&plusmn;0.35</td>
        <td>0&plusmn;0.46</td>
        <td>-0.03&plusmn;0.38</td>
        <td>-0.07&plusmn;0.33</td>
        <td>0.13&plusmn;0.35</td>
        <td>0.04&plusmn;0.32</td>
        <td>0.03&plusmn;0.32</td>
        <td>0.05&plusmn;0.31</td>
      </tr>
    </tbody>
  </table>
 </section>
 <section>
    <h2>Future Directions</h2>

<p>
    In this work, we've demonstrated that there is no significant bias affecting the 
    recovered parameters when excluding BB from the analysis, 
    particularly the coupling parameter \( g \), and that the results 
    are consistent across different dust models. 
    This is an important step as it suggests that we may proceed with 
    analyzing the real data from BK18. 
    However, there are still a few important aspects to further explore in order to 
    ensure the robustness and consistency of our analysis.
</p>
<p>
    One next step is to test our results on different EB curves generated from 
    various EDE parameters. By running MCMC chains using these alternate EB curves, 
    we can verify that our results are consistent regardless of the specific choice of 
    EB spectra. The choice of EB spectrum may have subtle 
    effects on the recovered parameters, and ensuring that our analysis is insensitive 
    to these choices strengthens the overall reliability of our conclusions. 
    Eskilt's previous work demonstrated the consistency of results across different EB curves, 
    and we aim to replicate these findings in our analysis to ensure that our conclusions hold 
    across a range of possible EB spectra.
</p>
<p>
    Additionally, although our analysis has shown that BB spectra are not significantly 
    affecting the \( g \) parameter and rotation angles when \(g\) is small, 
    there are still indications that the BB spectra may be introducing some 
    discrepancies into the fits. To address this, we can continue to investigate the 
    role of the BB spectra in the fitting process, 
    particularly focusing on how it affects the MCMC chains. 
    Specifically, we need to explore why the inclusion of BB seems to cause the 
    \( g \) parameter to shift, and whether this is related to the way the BB spectra 
    are being used to constrain the dust models. 
    We can also rerun the analysis with a different injected EDE signal at \(g=0.3\) instead,
    so we can determine whether the same effect appears with \(g\) is smaller.
    Understanding and resolving these issues will be important, 
    particularly if further refinements to the analysis pipeline are needed to 
    improve the precision of the parameter estimates.
</p>

<p>
    Overall, while we've shown that the current approach is robust, 
    further validation and refinement are key to ensuring that the results are as 
    precise and reliable as possible. By continuing to explore different EB spectra, 
    further scrutinizing the role of BB spectra, 
    and keeping a close eye on potential systematic uncertainties, 
    we can move towards a final analysis using real data.
</p>
</section>
 <section>
    <h2>Appendix</h2>
    <p>All chains and plots can be found in 
        <code>/n/holylfs04/LABS/kovac_lab/Users/liuto/ede_chains</code>.</p>
</section>
</body>

</html>
