<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Early Dark Energy Simulation Dust and Polarization Miscalibration Update</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <!-- Load up MathJax for math notation -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
    </script><script type="text/javascript" src="../mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
</head>

<body>
    <!-- Add my custom pager script -->
    <script type="text/javascript" src="scripts/pager.js"></script>
    <link rel="stylesheet" type="text/css" href="scripts/pager.css">

    <header>
        <h1>Early Dark Energy Simulation Dust and Polarization Miscalibration Update</h1>

        <time datetime="2025 May 13" class="published updated">
            2025 May 13
        </time> —
        Tongtian (Tom) Liu, Dominic Beck
    </header>

    <hr>
    <section>
        <h2>Introduction</h2>
        <p>This posting builds upon previous updates:</p>
  <ul>
    <li><a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20240924_preliminary_eb_ede_results/">
        2024-09-24: Preliminary EB EDE Results</a></li>
    <li><a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20241203_multicomp_eb_ede_update/">
        2024-12-03: Multicomponent EB EDE Update</a></li>
    <li><a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20250218_ede_forecast/">
        2025-02-18: EDE Forecast</a></li>
  </ul>
  <p>
    Here, we further demonstrate the robustness of our method for fitting early dark energy (EDE)
    parameters by expanding the pipeline to also include EE and BB spectra alongside EB. While
    EE and BB are far less sensitive to polarization rotation or EDE parameters than EB,
    their inclusion helps calibrate nuisance parameters like dust, ultimately tightening
    constraints on the EB-inferred rotation angle.
</p>
<p>
    To test the impact of miscalibration, we inject artificial rotation angles into the maps
    and fit the parameters using three combinations of spectra: EB only, EE + EB (excluding BB),
    and the full EE + EB + BB set. This progression allows us to isolate the influence of each
    spectrum type on the parameter recovery in the presence of injected signals.
</p>



<p>
    These are applied to two datasets: <strong>BK18lf</strong> (no EDE injection) and
    <strong>BK18lf_fede01</strong> (EDE injected with
    \( f_{\mathrm{EDE}} = 0.07 \), \( g = 1 \)). This tests whether miscalibration-induced
    polarization rotation could artificially enhance an EDE signal.
</p>
           
<p>
    Finally, we assess the robustness of our constraints against different dust models by
    fitting over the dust scenarios presented in
    <a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20210122_BK18mm_final_altdust/">
        J. Willmert’s posting
    </a>. This helps determine whether the inferred coupling \( g \) is sensitive to dust modeling.
</p>
    </section>
    <section>
   <h2>Initial Bias Checks</h2>
   <p>
    We begin by running MCMC chains on the two datasets: <strong>BK18lf</strong> (no EDE injection)
    and <strong>BK18lf_fede01</strong> (with EDE injected). Both datasets are based on the
    standard BK18 large-field map combination (3553×1459×5260×5261). The only difference is that
    <strong>BK18lf_fede01</strong> includes a nonzero EB spectrum corresponding to best-fit EDE
    parameters from
    <a href="https://arxiv.org/pdf/2209.07804">Murai (2022)</a>,
    specifically the case with \( f_{\mathrm{EDE}} = 0.07 \).
</p>

<p>
    This choice differs from
    <a href="https://arxiv.org/pdf/2303.15369">Eskilt (2023)</a>,
    who considers other values such as \( f_{\mathrm{EDE}} = 0.0872 \) and
    \( f_{\mathrm{EDE}} = 0.1271 \). For our final fits of the coupling \( g \),
    we plan to explore a grid of \( f_{\mathrm{EDE}} \) values based on multiple best-fit spectra.
</p>
<p>
    For each dataset, we fit to three spectrum combinations: EB only, EE + EB, and full EE + EB + BB.
    We also evaluate two dust models:
</p>

<ol>
    <li>
        <strong>No dust:</strong> We set dust to zero and use base EE and BB theory curves
        (with lensing) along with an EB theory curve derived from the EDE model.
    </li>
    <li>
        <strong>Nominal dust:</strong> Following the assumptions in
        <a href="https://bicep.rc.fas.harvard.edu/dbeck/20230202_cmbbirefringence/">
            Dominic’s posting
        </a>, we set \( P_{\text{cal}} = 1 \) and ignore synchrotron emission.
        In addition to fitting for rotation angle \( \alpha_\nu \) for each frequency \(\nu\), 
        we now additionally fit to 
        dust amplitude \( A_{\text{dust}} \) and exponent \( \alpha_{\text{dust}} \) ,
        using separate \( A_{\text{dust}} \) and \( \alpha_{\text{dust}} \) parameters for EE, BB, and EB.
        The dust spectral index \( \beta \) is shared across all spectra.
    </li>
</ol>
<p>
    The goal of these MCMC chains is to recover the injected signals and demonstrate that 
    our pipeline does not bias the EDE coupling parameter \(g\).
    We also show that fitting dust parameters alongside \(g\) introduces no additional bias. 
    Rather than fixing dust to a single “best‐fit” value, 
    we simultaneously fit dust parameters alongside the EDE coupling. 
    This approach properly propagates dust uncertainties into our final errors, 
    and potentially breaks degeneracies between foreground EB and true polarization rotation, 
    Jointly fitting dust with EE and BB also leverages those spectra to self‑calibrate the
    polarization amplitude, ensuring a more robust, bias‑resistant measurement of 
    any cosmological birefringence or early dark energy signal. </p>

   <figure>
    <img alt="Multicomponent Analysis EB Spectrum" id="dustfigs" src="#" width="750" height="500" onerror="javascript:this.src='dne.png'" />
    <figcaption>
        <p>Interactive plot pager for multicomponent analysis of the Early Dark Energy (EDE) spectrum.
            Visualizes the fits and triangle plots for 499 simulations.</p>
        <ul>
            <li><strong>Map Type</strong>: Choose the type of plot to visualize:
                <ul>
                    <li>Best Fit EE: Displays best fit to the EE spectrum.</li>
                    <li>Best Fit EB: Displays best fit to the EB spectrum.</li>
                    <li>Best Fit BB: Displays best fit to the BB spectrum.</li>
                    <li>Triangle Plot: Shows parameter correlation contours.</li>
                </ul>
            </li>
            <li><strong>Bins Used</strong>: Choose the binning scheme applied to spectra:
                <ul>
                    <li>2–15: Uses bins 2 through 15.</li>
                </ul>
            </li>
            <li><strong>Theory comp</strong>: Select the theoretical model used for comparison:
                <ul>
                    <li>Fixed dust fit: Dust parameters fixed to zero.</li>
                    <li>With Dust fit: Dust parameters are floated in the fit.</li>
                </ul>
            </li>
            <li><strong>Spectra</strong>: Choose which spectra to include in the fit:
                <ul>
                    <li>All: Includes EE, EB, and BB.</li>
                    <li>No BB: Includes EE and EB only.</li>
                    <li>EB only: Only EB spectrum is used.</li>
                </ul>
            </li>
            <li><strong>Injected EDE Signal</strong>: Select which Early Dark Energy (EDE) signal was injected:
                <ul>
                    <li>Fede = 0.07, g = 1: Injected signal with EDE.</li>
                    <li>g = 0: No rotation, null birefringence.</li>
                </ul>
            </li>
            <li><strong>Map Sim num</strong>: Choose the simulation number (three digits) to view results for a particular realization.</li>
        </ul>
        <p>This interactive plot allows detailed exploration of multicomponent analysis by adjusting map types, binning, theoretical assumptions, spectra selections, EDE signal injections, and simulation numbers.</p>
    </figcaption>

    <script type="text/javascript">
                function pad(num, size) {
                    num = num.toString();
                    while (num.length < size) num = "0" + num;
                    return num;
                }
                const simnums = [];
                for (let i = 0; i < 10; i++) {
                    s = pad(i, 1);

                    simnums[i] = s.concat('|', s);

                }

        pager.link("#dustfigs", {
            'Map Sim Num Digit1|digit1': simnums,
            'Digit2|digit2': simnums,
            'Digit3|digit3': simnums,

            'Map Type|m_map_type': [
                'Best Fit EE|_bestfitEE',
                'Best Fit EB|_bestfitEB',
                'Best Fit BB|_bestfitBB',
                'Triangle Plot|_triangle_plot',
                'Summary Plot (Peaks histogram)|sim1_summary'
            ],
            'Bins Used|bin_num15': [
                '2-15|_bin15',
            ],
            'Dust Model|theory_comp':[
                'Fixed dust = zero|_fixeddust',
                'Gaussian dust|_gdust',
            ],
            'Spectra|spectra':[
                'All|_all',
                'No BB|_nob',
                'EB only|_eb',
            ],
            'Injected EDE Signal|ede': [
                'Fede = 0.07, g = 1|fede01',
                'g = 0|zeroeb'
            ]
        },
        function (params) {
            let dirbase = '/liuto'
            let dirpath = dirbase + '/ede_chains/';
            let mcmc_folder = params.ede + params.bin_num15 + params.theory_comp + params.spectra + '/';
            let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
            let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
            if(params.m_map_type == 'sim1_summary'){
                name = dirpath + mcmc_folder + params.m_map_type + '.png'
            }
            console.log(name);
            return name;
        });

        pager.setparams({
            'digit1':'0',
            'digit2': '0',
            'digit3': '1',
            'm_map_type': '_bestfitEB',
            'bin_num15': '_bin15',
            'ede': 'zeroeb',
            'spectra':'_all',
            'theory_comp':'_fixeddust',
        });
    </script>
</figure>
Below is a summary of the results over the peaks of the simulations.
<table>
    <caption>MCMC fit results for <em>g</em> = 0 (no dust model)</caption>
    <thead>
      <tr>
        <th>Spectra</th>
        <th>g</th>
        <th>α<sub>220</sub> (°)</th>
        <th>α<sub>150</sub> (°)</th>
        <th>α<sub>K95</sub> (°)</th>
        <th>α<sub>B95lf</sub> (°)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>All</th>
        <td>0.03 ± 0.27</td>
        <td>–0.01 ± 0.22</td>
        <td>–0.01 ± 0.14</td>
        <td>–0.01 ± 0.23</td>
        <td>–0.02 ± 0.13</td>
      </tr>
      <tr>
        <th>No BB</th>
        <td>0.05 ± 0.37</td>
        <td>–0.03 ± 0.24</td>
        <td>–0.03 ± 0.19</td>
        <td>–0.02 ± 0.26</td>
        <td>–0.03 ± 0.18</td>
      </tr>
      <tr>
        <th>EB only</th>
        <td>0.03 ± 0.37</td>
        <td>–0.02 ± 0.24</td>
        <td>–0.02 ± 0.19</td>
        <td>–0.02 ± 0.26</td>
        <td>–0.02 ± 0.18</td>
      </tr>
    </tbody>
  </table>
  
  <table>
    <caption>MCMC fit results for <em>g</em> = 1 (no dust model)</caption>
    <thead>
      <tr>
        <th>Spectra</th>
        <th>g</th>
        <th>α<sub>220</sub> (°)</th>
        <th>α<sub>150</sub> (°)</th>
        <th>α<sub>K95</sub> (°)</th>
        <th>α<sub>B95lf</sub> (°)</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>All</th>
        <td>0.62 ± 0.27</td>
        <td>0.20 ± 0.24</td>
        <td>0.18 ± 0.15</td>
        <td>0.15 ± 0.24</td>
        <td>0.16 ± 0.14</td>
      </tr>
      <tr>
        <th>No BB</th>
        <td>1.02 ± 0.44</td>
        <td>–0.04 ± 0.25</td>
        <td>–0.02 ± 0.21</td>
        <td>–0.03 ± 0.26</td>
        <td>–0.03 ± 0.19</td>
      </tr>
      <tr>
        <th>EB only</th>
        <td>1.00 ± 0.42</td>
        <td>–0.03 ± 0.25</td>
        <td>–0.01 ± 0.20</td>
        <td>–0.02 ± 0.23</td>
        <td>–0.02 ± 0.19</td>
      </tr>
    </tbody>
  </table>
  
  <table>
    <caption>MCMC fit results for <em>g</em> = 0 (with dust model)</caption>
    <thead>
      <tr>
        <th>Spectra</th>
        <th>g</th>
        <th>α<sub>220</sub> (°)</th>
        <th>α<sub>150</sub> (°)</th>
        <th>α<sub>K95</sub> (°)</th>
        <th>α<sub>B95lf</sub> (°)</th>
        <th>A<sub>dust</sub><sup>EE</sup></th>
        <th>α<sub>dust</sub><sup>EE</sup></th>
        <th>A<sub>dust</sub><sup>BB</sup></th>
        <th>α<sub>dust</sub><sup>BB</sup></th>
        <th>A<sub>dust</sub><sup>EB</sup></th>
        <th>α<sub>dust</sub><sup>EB</sup></th>
        <th>β</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>All</th>
        <td>0.03 ± 0.31</td>
        <td>0.01 ± 0.22</td>
        <td>–0.02 ± 0.17</td>
        <td>0.02 ± 0.27</td>
        <td>–0.02 ± 0.15</td>
        <td>7.7 ± 1.3</td>
        <td>–0.33 ± 0.18</td>
        <td>3.86 ± 0.8</td>
        <td>–0.31 ± 0.18</td>
        <td>0.00 ± 0.40</td>
        <td>—</td>
        <td>1.68 ± 0.15</td>
      </tr>
      <tr>
        <th>No BB</th>
        <td>0.04 ± 0.38</td>
        <td>–0.01 ± 0.26</td>
        <td>–0.04 ± 0.21</td>
        <td>0.01 ± 0.29</td>
        <td>–0.03 ± 0.18</td>
        <td>8.36 ± 1.46</td>
        <td>–0.33 ± 0.18</td>
        <td>—</td>
        <td>—</td>
        <td>–0.07 ± 0.45</td>
        <td>—</td>
        <td>1.79 ± 0.26</td>
      </tr>
      <tr>
        <th>EB only</th>
        <td>0.03 ± 0.38</td>
        <td>0.00 ± 0.25</td>
        <td>–0.03 ± 0.21</td>
        <td>0.02 ± 0.28</td>
        <td>–0.02 ± 0.18</td>
        <td>—</td>
        <td>—</td>
        <td>—</td>
        <td>—</td>
        <td>–0.03 ± 0.45</td>
        <td>—</td>
        <td>—</td>
      </tr>
    </tbody>
  </table>
  


<figure>
    <img alt="Multicomponent Analysis EB Spectrum" id="sigl" src="#" width="750" height="500" onerror="javascript:this.src='dne.png'" />
    <figcaption>
        <p>Interactive plot pager for multicomponent analysis of the Early Dark Energy (EDE) spectrum.
            Visualizes the fits and triangle plots for 499 simulations.</p>
        <ul>
            <li><strong>Map Type</strong>: Choose the type of plot to visualize:
                <ul>
                    <li>Best Fit EE: Displays best fit to the EE spectrum.</li>
                    <li>Best Fit EB: Displays best fit to the EB spectrum.</li>
                    <li>Best Fit BB: Displays best fit to the BB spectrum.</li>
                    <li>Triangle Plot: Shows parameter correlation contours.</li>
                </ul>
            </li>
            <li><strong>Bins Used</strong>: Choose the binning scheme applied to spectra:
                <ul>
                    <li>2–15: Uses bins 2 through 15.</li>
                </ul>
            </li>
            <li><strong>Theory comp</strong>: Select the theoretical model used for comparison:
                <ul>
                    <li>Fixed dust fit: Dust parameters fixed to zero.</li>
                    <li>With Dust fit: Dust parameters are floated in the fit.</li>
                    <li>Signal Only: Only the injected signal is fit, no dust model or noise.</li>
                    <li>Fixed angle signal only: Signal-only fit with angle fixed to 0.</li>
                </ul>
            </li>
            <li><strong>Spectra</strong>: Choose which spectra to include in the fit:
                <ul>
                    <li>All: Includes EE, EB, and BB.</li>
                    <li>No BB: Includes EE and EB only.</li>
                    <li>EB only: Only EB spectrum is used.</li>
                </ul>
            </li>
            <li><strong>Injected EDE Signal</strong>: Select which Early Dark Energy (EDE) signal was injected:
                <ul>
                    <li>Fede = 0.07, g = 1: Injected signal with EDE.</li>
                    <li>g = 0: No rotation, null birefringence.</li>
                </ul>
            </li>
            <li><strong>Map Sim num</strong>: Choose the simulation number (three digits) to view results for a particular realization.</li>
        </ul>
        <p>This interactive plot allows detailed exploration of multicomponent analysis by adjusting map types, binning, theoretical assumptions, spectra selections, EDE signal injections, and simulation numbers.</p>
    </figcaption>

    <script type="text/javascript">

        pager.link("#sigl", {
            'Map Sim Num Digit1|digit1': simnums,
            'Digit2|digit2': simnums,
            'Digit3|digit3': simnums,

            'Map Type|m_map_type': [
                'Best Fit EE|_bestfitEE',
                'Best Fit EB|_bestfitEB',
                'Best Fit BB|_bestfitBB',
                'Triangle Plot|_triangle_plot',
                'Summary Plot (Peaks histogram)|sim1_summary'
            ],
            'Bins Used|bin_num15': [
                '2-15|_bin15',
            ],
            'Theory comp|theory_comp':[
                'Fixed dust fit|_fixeddust',
                'With Dust fit|_gdust',
                'Signal Only|_sigl',
                'Fixed angle signal only|_sigl_fixedangle'
            ],
            'Spectra|spectra':[
                'All|_all',
                'No BB|_nob',
                'EB only|_eb',
            ],
            'Injected EDE Signal|ede': [
                'Fede = 0.07, g = 1|fede01',
            ]
        },
        function (params) {
            let dirbase = '/liuto'
            let dirpath = dirbase + '/ede_chains/';
            let mcmc_folder = params.ede + params.bin_num15 + params.theory_comp + params.spectra + '/';
            let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
            let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
            if(params.m_map_type == 'sim1_summary'){
                name = dirpath + mcmc_folder + params.m_map_type + '.png'
            }
            console.log(name);
            return name;
        });

        pager.setparams({
            'digit1':'0',
            'digit2': '0',
            'digit3': '1',
            'm_map_type': '_bestfitEB',
            'bin_num15': '_bin15',
            'ede': 'zeroeb',
            'spectra':'_all',
            'theory_comp':'_fixeddust',
        });
    </script>
</figure>
    </section>
 
<section>

<h2>Injecting detector rotation miscalibration</h2>
<p>
    The injected rotation angles (in degrees) for BK18_220, BK18_150, BK18_K95, and BK18_B95e
    (B95lf) are grouped as follows:
</p>

<ul>
    <li><strong>Positive:</strong> 0, 0.25, 0.5, 0.75</li>
    <li><strong>Negative:</strong> 0, -0.25, -0.5, -0.75</li>
    <li><strong>Balanced:</strong> -1, -0.5, 0, 0.5</li>
</ul>
<figure>
    <img alt="Fitting to injected miscalibration" id="polrot" src="#" width="750" height="500" onerror="javascript:this.src='dne.png'" />
    <figcaption>
        <p>Interactive plot pager for multicomponent analysis of the Early Dark Energy (EDE) spectrum.
            Visualizes the fits and triangle plots for 499 simulations.</p>
        <ul>
            <li><strong>Map Type</strong>: Choose the type of plot to visualize:
                <ul>
                    <li>Best Fit EE: Displays best fit to the EE spectrum.</li>
                    <li>Best Fit EB: Displays best fit to the EB spectrum.</li>
                    <li>Best Fit BB: Displays best fit to the BB spectrum.</li>
                    <li>Triangle Plot: Shows parameter correlation contours.</li>
                    <li>Summary plot: shows the peaks of all the triangle plot sims.</li>
                </ul>
            </li>
            <li><strong>Bins Used</strong>: Choose the binning scheme applied to spectra:
                <ul>
                    <li>2–15: Uses bins 2 through 15.</li>
                </ul>
            </li>
            <li><strong>Injected Signal</strong>: Select the detector miscalibration angle to inject into the sim, units in degrees
                <ul>
                <li>No Miscalibration: Nothing is injected</li>
                <li>Positive Miscalibration: Injected rotation of 0, 0.25, 0.5, 0.75</li>
                <li>Negative Miscalibration: Injected rotation of 0, -0.25, -0.5, -0.75</li>
                <li>Blanaced Miscalibration: Injected rotation of 0.5, 0, -0,5, -1</li>

                </ul>
            </li>
            </li>
            <li><strong>Map Sim num</strong>: Choose the simulation number (three digits) to view results for a particular realization.</li>
        </ul>
        <p>This interactive plot allows detailed exploration of multicomponent analysis by adjusting map types, binning, theoretical assumptions, spectra selections, EDE signal injections, and simulation numbers.</p>
    </figcaption>

    <script type="text/javascript">

        pager.link("#polrot", {
            'Map Sim Num Digit1|digit1': simnums,
            'Digit2|digit2': simnums,
            'Digit3|digit3': simnums,

            'Map Type|m_map_type': [
                'Best Fit EE|_bestfitEE',
                'Best Fit EB|_bestfitEB',
                'Best Fit BB|_bestfitBB',
                'Triangle Plot|_triangle_plot',
                'Summary Plot (Peaks histogram)|sim1_summary'
            ],
            'Bins Used|bin_num15': [
                '2-15|_bin15',
            ],
            'Injected Signal|inj_sig':[
                'Positive Miscalibration|_sigpos',
                'Negative Miscalibration|_signeg',
                'Balanced Miscalibration|_sigbal',
                ],
            'Spectra|spectra':[
                'All|_all',
                'No  BB|_nob',
                'EB Only|_eb',
            ],
            'Injected EDE Signal|ede': [
                'g = 0|zeroeb',
                'g = 1, fede=0.07|fede01'
            ]
        },
        function (params) {
            let dirbase2 = '/liuto'
            let dirpath = dirbase2 + '/ede_chains/';
            let mcmc_folder = params.ede + params.bin_num15 + '_gdust' + params.spectra + params.inj_sig + '/';
            let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
            let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
            if(params.m_map_type == 'sim1_summary'){
                name = dirpath + mcmc_folder + params.m_map_type + '.png'
            }
            console.log(name);
            return name;
        });

        pager.setparams({
            'digit1':'0',
            'digit2': '0',
            'digit3': '1',
            'm_map_type': '_bestfitEB',
            'bin_num15': '_bin15',
            'ede': 'zeroeb',
            'spectra':'_all',
            'inj_sig': '_sigpos',
        });
    </script>
</figure>
</section>

<section>
    <h2>Trying different dust models</h2>
 <figure>
     <img alt="Fitting to different dust models" id="dustmodels" src="#" width="750" height="500" onerror="javascript:this.src='dne.png'" />
     <figcaption>
         <p>Interactive plot pager for multicomponent analysis of the Early Dark Energy (EDE) spectrum.
             Visualizes the fits and triangle plots for 499 simulations.</p>
         <ul>
             <li><strong>Map Type</strong>: Choose the type of plot to visualize:
                 <ul>
                     <li>Best Fit EE: Displays best fit to the EE spectrum.</li>
                     <li>Best Fit EB: Displays best fit to the EB spectrum.</li>
                     <li>Best Fit BB: Displays best fit to the BB spectrum.</li>
                     <li>Triangle Plot: Shows parameter correlation contours.</li>
                     <li>Summary plot: shows the peaks of all the triangle plot sims.</li>
                 </ul>
             </li>
             <li><strong>Bins Used</strong>: Choose the binning scheme applied to spectra:
                 <ul>
                     <li>2–15: Uses bins 2 through 15.</li>
                 </ul>
             </li>
             <li><strong>Dust model</strong>: Select the theoretical dust model used for comparison:
                 <ul>
                 Dust models acquired from <a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20210122_BK18mm_final_altdust/">J. Willmert's posting</a>
                 </ul>
             </li>
             </li>
             <li><strong>Map Sim num</strong>: Choose the simulation number (three digits) to view results for a particular realization.</li>
         </ul>
         <p>This interactive plot allows detailed exploration of multicomponent analysis by adjusting map types, binning, theoretical assumptions, spectra selections, EDE signal injections, and simulation numbers.</p>
     </figcaption>
 
     <script type="text/javascript">
 
         pager.link("#dustmodels", {
             'Map Sim Num Digit1|digit1': simnums,
             'Digit2|digit2': simnums,
             'Digit3|digit3': simnums,
 
             'Map Type|m_map_type': [
                 'Best Fit EE|_bestfitEE',
                 'Best Fit EB|_bestfitEB',
                 'Best Fit BB|_bestfitBB',
                 'Triangle Plot|_triangle_plot',
                 'Summary Plot (Peaks histogram)|sim1_summary'
             ],
             'Bins Used|bin_num15': [
                 '2-15|_bin15',
             ],
             'Dust model|dust_model':[
                 'No Dust|_nodust',
                 'Gaussian Dust|_gdust',
                 'pysm1|_pysm1',
                 'pysm2|_pysm2',
                 'pysm3|_pysm3',
                 'mhd|_mhd',
                 'mkd|_mkd',
                 'gdecorr|_gdecorr',
                 'gampmod|_gampmod',
                 'vansyngel|_vansyngel',
 
             ],
             'Spectra|spectrad':[
                 'All|_all',
             ],
             'Injected EDE Signal|eded': [
                 'g = 0|zeroeb'
             ]
         },
         function (params) {
             let dirbase2 = '/liuto'
             let dirpath = dirbase2 + '/ede_chains/';
             let mcmc_folder = params.eded + params.bin_num15 + params.dust_model + params.spectrad + '/';
             let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
             let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
             if(params.m_map_type == 'sim1_summary'){
                 name = dirpath + mcmc_folder + params.m_map_type + '.png'
             }
             console.log(name);
             return name;
         });
 
         pager.setparams({
             'digit1':'0',
             'digit2': '0',
             'digit3': '1',
             'm_map_type': '_bestfitEB',
             'bin_num15': '_bin15',
             'eded': 'zeroeb',
             'spectrad':'_all',
             'dust_model':'_pysm1',
         });
     </script>
 </figure>
 </section>

 
</body>

</html>
