<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Early Dark Energy Fisher Forecast</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <!-- Load up MathJax for math notation -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
    </script><script type="text/javascript" src="../mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
</head>

<body>
    <!-- Add my custom pager script -->
    <script type="text/javascript" src="scripts/pager.js"></script>
    <link rel="stylesheet" type="text/css" href="scripts/pager.css">

    <header>
        <h1>Early Dark Energy Fisher Forecast</h1>

        <time datetime="2025 February 18" class="published updated">
            2025 February 18
        </time> —
        Tongtian (Tom) Liu, Dominic Beck
    </header>

    <hr>

    <section>
        <h2>Introduction</h2>
        
        <p>
            Fisher matrices are used to forecasting the uncertainties in 
            cosmological parameters when experimental conditions, such as sky coverage or observation time, 
            are improved. Below, we present the Fisher matrices used to project uncertainties for the parameters 
            \( g, \alpha_{150}, \alpha_{220}, \alpha_{K95}, \) and \( \alpha_{B95e} \). These matrices encode the 
            expected uncertainties and correlations between parameters under the assumption of Gaussian likelihoods.
        </p>
        </section>
        <section>
        <h2>Fisher Matrix Calculations</h2>
        
            <h3>Mathematical Derivation of the Fisher Matrix</h3>
            The Fisher forecasting methodology and calculations presented here are adapted from 
    <a href="https://bicep.rc.fas.harvard.edu/~bicep2/papers/thesi/Keck/VB_PhD_Thesis_Final.pdf">Vargas (2023)</a>, which provides a detailed derivation and validation of the framework 
    using Bicep/Keck data (see Section 7 of the thesis for the full mathematical treatment).
       
            <p>
                The Fisher matrix \( F_{ij} \) quantifies the information content of the data about the parameters \( \theta_i \). For a likelihood function \( \mathcal{L}(\theta; d) \), it is defined as:
                \[
                F_{ij} = -\mathbb{E}\left[\frac{\partial^2 \ln \mathcal{L}}{\partial \theta_i \partial \theta_j}\right],
                \]
                where \( \mathbb{E}[\cdot] \) denotes the expectation value over the data.
            </p>
        
         
            <p>
                For Gaussian-distributed data with mean \( \mu(\theta) \) and covariance \( \Sigma(\theta) \), the log-likelihood is:
                \[
                \ln \mathcal{L}(\theta; d) = -\frac{1}{2} \left( d - \mu(\theta) \right)^T \Sigma(\theta)^{-1} \left( d - \mu(\theta) \right) - \frac{1}{2} \ln \det \Sigma(\theta).
                \]
                The Fisher matrix becomes:
                \[
                F_{ij} = \frac{\partial \mu^T}{\partial \theta_i} \Sigma^{-1} \frac{\partial \mu}{\partial \theta_j} + \frac{1}{2} \text{Tr}\left( \Sigma^{-1} \frac{\partial \Sigma}{\partial \theta_i} \Sigma^{-1} \frac{\partial \Sigma}{\partial \theta_j} \right).
                \]
            </p>
        
            <p>
                Assuming a fixed covariance matrix (\( \Sigma(\theta) = \Sigma \)), the second term vanishes:
                \[
                F_{ij} = \frac{\partial \mu^T}{\partial \theta_i} \Sigma^{-1} \frac{\partial \mu}{\partial \theta_j}.
                \]
            </p>
        
     
            <p>
                The Cramér-Rao bound gives the minimum variance for parameter \( \theta_i \):
                \[
                \sigma_{ii} = \sqrt{(F^{-1})_{ii}}.
                \]
            </p>
        
            <h4>Practical Implementation Steps</h4>
            <p>
                <strong>Inputs:</strong>
            </p>
            <ul>
                <li>Covariance matrices from Bicep/Keck.</li>
                <li>Fiducial model parameters (\(\theta_i =  g, \alpha_\nu \)).</li>
            </ul>
        
            <p>
                <strong>Workflow:</strong>
            </p>
            <ol>
                <li>Compute partial derivatives \( \frac{\partial \mu}{\partial \theta_i} \).</li>
                <li>Assemble Fisher matrix \( F_{ij} \).</li>
                <li>Invert \( F \) to get \( \sigma_{ii} = \sqrt{(F^{-1})_{ii}} \).</li>
            </ol>
            </section><section>
        <h2>Confirming Forecast Results for Current Data</h2>
        
        Following the steps outlined above, we obtain the following uncertainties for Bin num = 15, matching 
            the emperical peak spread from the simulations in 
            <a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20241203_multicomp_eb_ede_update/">the previous update</a>.

            <table>
                <thead>
                    <tr>
                        <th>Parameter</th>
                        <th>Uncertainty from Fisher Forecast(\( \sigma_{ii} \))</th>
                        <th>Uncertainty from Simulations (Upper)</th>
                        <th>Uncertainty from Simulations (Lower)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>\( g \)</td>
                        <td>0.3246</td>
                        <td>+0.35°</td>
                        <td>-0.37°</td>
                    </tr>
                    <tr>
                        <td>\( \alpha_{150} \)</td>
                        <td>0.1523°</td>
                        <td>+0.19°</td>
                        <td>-0.17°</td>
                    </tr>
                    <tr>
                        <td>\( \alpha_{220} \)</td>
                        <td>0.2164°</td>
                        <td>+0.24°</td>
                        <td>-0.22°</td>
                    </tr>
                    <tr>
                        <td>\( \alpha_{K95} \)</td>
                        <td>0.2032°</td>
                        <td>+0.22°</td>
                        <td>-0.20°</td>
                    </tr>
                    <tr>
                        <td>\( \alpha_{B95e} \)</td>
                        <td>0.1404°</td>
                        <td>+0.17°</td>
                        <td>-0.16°</td>
                    </tr>
                </tbody>
            </table>
            The simulation uncertainties are slightly larger than the uncertainties from the Fisher Forecast because the 
            calculations are for the minimum bound, which is not necessarily true for any particular realization.
    </section><section>
    <h2>Forecast for Future Observations</h2>
    <p>After verifying that the Fisher Forecast parameter uncertainties are consistent with the results of our simulations 
        in the previous update, we repeated the calculations while varying sky fraction, noise level, and observation time. 
        At this stage, we assume uniform scaling and do not yet account for the impact of individual receivers or new receivers 
        on the uncertainties.</p>

       <figure>
        <img alt="Forecast Analysis" id="forecast" src="#" width="750" height="500" onerror="javascript:this.src='dne.png'" />
        <figcaption>
            
            <p>The pager shows how g uncertainties scale with experimental improvements for different forecast scenarios:</p>
            <ul>
                <li><strong>Sky Fraction Scaling Only</strong>: Impact of increased sky coverage and assumes noise level stays the same.</li>
                <li><strong>Sky Fraction + Noise</strong>: Assumes noise levels are independent of sky coverage.</li>
                <strong>Sky Fraction + Observation Time</strong>: Combines sky coverage and observation time scaling 
                                            (assumes noise scales linearly with sky coverage and inversely with observation time).</li>
                <li><strong>Noise Only</strong>: Assumes current sky coverage.</li>
            </ul>
        </figcaption>
        <script type="text/javascript">
            pager.link("#forecast", {
                'Forecast Type|ftype': [
                    
                    'Sky Fraction + Observation Time|skyfrac_tobs',
                    'Sky Fraction + Noise|skyfrac_noise',
                    'Sky Fraction Scaling Only|skyfrac',
                    'Noise Only|noise'
                ]
            },
            function(params) {
                dirbase = '.'
                let dirpath = dirbase + '/forecast_plots/';
                let plotname;
                
                if(params.ftype === 'skyfrac') {
                    plotname = 'skyfrac.png';
                } else if(params.ftype == 'noise'){
                    plotname = 'noise.png'; 
                } else if(params.ftype == 'skyfrac_noise'){
                    plotname = 'skyfrac_noise_2D.png'; 
                } else if(params.ftype == 'skyfrac_tobs'){
                    plotname = 'skyfrac_tobs_2D.png';
                } else {
                    plotname = 'dne.png'
                }
                
                return dirpath + plotname;
            });
    
            pager.setparams({
                'ftype': 'skyfrac'
            });
        </script>
    </figure>
    <p>As expected, we observe that as observation time increases, noise level decreases, and sky fraction increases, 
        the uncertainty on \( g \) decreases. The magenta line in the <strong>sky fraction + noise</strong> plot represents 
        the same scenario as the magenta line in the <strong>sky fraction + observation time</strong> plot, which, in turn, 
        corresponds to the scenario in the <strong>sky fraction scaling only</strong> plot. This consistency arises because, 
        as sky fraction increases with a constant observation time, the observation time per unit area of the sky decreases, 
        leading to an overall increase in noise. This effect is evident in the <strong>sky fraction + observation time</strong> 
        plot: while a larger sky fraction provides more data points and initially reduces the uncertainty on \( g \), 
        the accompanying rise in noise eventually outweighs the benefits of the increased sky coverage.</p>

        <p>These findings suggest two potential strategies to achieve the literature value of \( \Delta g = \pm 0.15 \):</p>
        <ul>
            <li><strong>Maintain the current sky fraction</strong> but increase the observation time by a factor of 10.</li>
            <li><strong>Expand the observed sky area by a factor of 3</strong> while maintaining the same noise level, 
                which would require a corresponding threefold increase in observation time.</li>
        </ul>
    </section>
    <section>   
    <h2>Next Steps</h2>
    <p>To improve the accuracy of our forecast, we should account for the fact that only Bicep 3 is currently operational. 
        This means we will likely obtain data from a single frequency, requiring us to scale the data under the assumption 
        that improvements in the multicomponent analysis will rely solely on this single frequency.</p>
    </section>

</body>

</html>
