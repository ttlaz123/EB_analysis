<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Early Dark Energy Fisher Forecast</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <!-- Load up MathJax for math notation -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
    </script><script type="text/javascript" src="../mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
</head>

<body>
    <!-- Add my custom pager script -->
    <script type="text/javascript" src="scripts/pager.js"></script>
    <link rel="stylesheet" type="text/css" href="scripts/pager.css">

    <header>
        <h1>Early Dark Energy Fisher Forecast</h1>

        <time datetime="2025 February 18" class="published updated">
            2025 February 18
        </time> —
        Tongtian (Tom) Liu, Dominic Beck
    </header>

    <hr>

    <section>
        <h2>Introduction</h2>
        
        <p>
            Fisher matrices are used to forecasting the uncertainties in 
            cosmological parameters when experimental conditions, such as sky coverage or observation time, 
            are improved. Below, we present the Fisher matrices used to project uncertainties for the parameters 
            \( g, \alpha_{150}, \alpha_{220}, \alpha_{K95}, \) and \( \alpha_{B95e} \). These matrices encode the 
            expected uncertainties and correlations between parameters under the assumption of Gaussian likelihoods.
        </p>
        </section>
        <section>
        <h2>Fisher Matrix Calculations</h2>
        
            <h3>Mathematical Derivation of the Fisher Matrix</h3>
            The Fisher forecasting methodology and calculations presented here are adapted from 
    <a href="https://bicep.rc.fas.harvard.edu/~bicep2/papers/thesi/Keck/VB_PhD_Thesis_Final.pdf">Vargas (2023)</a>, which provides a detailed derivation and validation of the framework 
    using Bicep/Keck data (see Section 7 of the thesis for the full mathematical treatment).
       
            <p>
                The Fisher matrix \( F_{ij} \) quantifies the information content of the data about the parameters \( \theta_i \). For a likelihood function \( \mathcal{L}(\theta; d) \), it is defined as:
                \[
                F_{ij} = -\mathbb{E}\left[\frac{\partial^2 \ln \mathcal{L}}{\partial \theta_i \partial \theta_j}\right],
                \]
                where \( \mathbb{E}[\cdot] \) denotes the expectation value over the data.
            </p>
        
         
            <p>
                For Gaussian-distributed data with mean \( \mu(\theta) \) and covariance \( \Sigma(\theta) \), the log-likelihood is:
                \[
                \ln \mathcal{L}(\theta; d) = -\frac{1}{2} \left( d - \mu(\theta) \right)^T \Sigma(\theta)^{-1} \left( d - \mu(\theta) \right) - \frac{1}{2} \ln \det \Sigma(\theta).
                \]
                The Fisher matrix becomes:
                \[
                F_{ij} = \frac{\partial \mu^T}{\partial \theta_i} \Sigma^{-1} \frac{\partial \mu}{\partial \theta_j} + \frac{1}{2} \text{Tr}\left( \Sigma^{-1} \frac{\partial \Sigma}{\partial \theta_i} \Sigma^{-1} \frac{\partial \Sigma}{\partial \theta_j} \right).
                \]
            </p>
        
            <p>
                Assuming a fixed covariance matrix (\( \Sigma(\theta) = \Sigma \)), the second term vanishes:
                \[
                F_{ij} = \frac{\partial \mu^T}{\partial \theta_i} \Sigma^{-1} \frac{\partial \mu}{\partial \theta_j}.
                \]
            </p>
        
     
            <p>
                The Cramér-Rao bound gives the minimum variance for parameter \( \theta_i \):
                \[
                \sigma_{ii} = \sqrt{(F^{-1})_{ii}}.
                \]
            </p>
        
            <h4>Practical Implementation Steps</h4>
            <p>
                <strong>Inputs:</strong>
            </p>
            <ul>
                <li>Covariance matrices from Bicep/Keck.</li>
                <li>Fiducial model parameters (\(\theta_i =  g, \alpha_\nu \)).</li>
            </ul>
        
            <p>
                <strong>Workflow:</strong>
            </p>
            <ol>
                <li>Compute partial derivatives \( \frac{\partial \mu}{\partial \theta_i} \).</li>
                <li>Assemble Fisher matrix \( F_{ij} \).</li>
                <li>Invert \( F \) to get \( \sigma_{ii} = \sqrt{(F^{-1})_{ii}} \).</li>
            </ol>
            </section><section>
        <h2>Confirming Forecast Results for Current Data</h2>
        
        Following the steps outlined above, we obtain the following uncertainties for Bin num = 15, matching 
            the emperical peak spread from the simulations in 
            <a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20241203_multicomp_eb_ede_update/">the previous update</a>.

        <table>
            <thead>
                <tr>
                    <th>Parameter</th>
                    <th>Uncertainty (\( \sigma_{ii} \))</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>\( g \)</td>
                    <td>0.3246</td>
                </tr>
                <tr>
                    <td>\( \alpha_{150} \)</td>
                    <td>0.1523°</td>
                </tr>
                <tr>
                    <td>\( \alpha_{220} \)</td>
                    <td>0.2164°</td>
                </tr>
                <tr>
                    <td>\( \alpha_{K95} \)</td>
                    <td>0.2032°</td>
                </tr>
                <tr>
                    <td>\( \alpha_{B95e} \)</td>
                    <td>0.1404°</td>
                </tr>
            </tbody>
        </table>
    
    </section><section>
    <h2>Forecast for Future Observations</h2>
    <figure>
        <img alt="Forecast Analysis" id="forecast" src="#" width="750" height="500" onerror="javascript:this.src='dne.png'" />
        <figcaption>
            <p>Interactive forecast analysis with two scaling modes:</p>
            <ul>
                <li><strong>Forecast Type</strong>:
                    <ul>
                        <li>Sky Fraction Scaling: Projections based on increased sky coverage</li>
                        <li>Sky Fraction + Observation Time: Combined scaling of sky area and integration time</li>
                    </ul>
                </li>
            </ul>
            <p>This interactive plot shows how parameter uncertainties scale with experimental improvements. 
               Use the dropdown to switch between different forecast scenarios.</p>
        </figcaption>
        <script type="text/javascript">
            pager.link("#forecast", {
                'Forecast Type|ftype': [
                    'Sky Fraction Scaling Only|skyfrac',
                    'Sky Fraction + Observation Time|skyfrac_tobs'
                ]
            },
            function(params) {
                let dirpath = dirbase + '/forecast_plots/';
                let plotname;
                
                if(params.ftype === 'skyfrac') {
                    plotname = 'sky_fraction_scaling.png';
                } else {
                    plotname = 'skyfrac_tobs_scaling.png';
                }
                
                return dirpath + plotname;
            });
    
            pager.setparams({
                'ftype': 'skyfrac'
            });
        </script>
    </figure>
    </section>
    <section>   
    <h2>Conclusion</h2>
    
    </section>

</body>

</html>
