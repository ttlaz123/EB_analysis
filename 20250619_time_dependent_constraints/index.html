<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>EDE Update</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <!-- Load up MathJax for math notation -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
    </script>
    <script type="text/javascript" src="../mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
</head>

<body>
    <!-- Add my custom pager script -->
    <script type="text/javascript" src="scripts/pager.js"></script>
    <link rel="stylesheet" type="text/css" href="scripts/pager.css">

    <header>
        <h1>Another Update</h1>

        <time datetime="2025 June 19" class="published updated">
            2025 June 19
        </time> —
        Tongtian (Tom) Liu, Dominic Beck
    </header>

    <hr>
    <section>
        <h2>Introduction</h2>
        <p><strong>Summary:</strong>  
    This posting presents follow-up analysis on the Early Dark Energy (EDE) signal in BICEP data, 
    focusing on further MCMC fits and addressing simulation-related systematics identified in previous work.  
    We assess how fitting different EB curves impacts the inferred coupling parameter \(g\),  
    and introduce a new angular-scale-dependent birefringence analysis to test for potential scale dependence 
    in the signal.
  </p>

        <p>This posting builds upon previous updates:</p>
        <ul>
            <li><a
                    href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20240924_preliminary_eb_ede_results/">
                    2024-09-24: Preliminary EB EDE Results</a></li>
            <li><a
                    href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20241203_multicomp_eb_ede_update/">
                    2024-12-03: Multicomponent EB EDE Update</a></li>
            <li><a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20250218_ede_forecast/">
                    2025-02-18: EDE Forecast</a></li>
            <li><a href="https://bicep.rc.fas.harvard.edu/bkcmb/analysis_logbook/analysis/20250513_dust_eb_ede_update/">
                    2025-05-13: Dust analysis</a></li>

        </ul>
        <p>
    We revisit the issue raised in the May 13 dust analysis regarding bias in the 
    maximum-likelihood (ML) estimator caused by the BB spectra.  
    We identify that the bias is due to excess signal in the BB simulations.
  </p>
   <p>
    We also rerun the MCMC fits for EB using a range of EDE parameters.  
    In particular, we test how different theoretical EDE parameters affect the inferred value of \(g\)
    as well as the rotation angles alpha, even when the simulated data uses a different set of EDE parameters.
  </p>
      <p>
    In addition, we implement an angular-scale dependent birefringence analysis.  
    We divide the multipole range into bins and fit independent rotation angles in each.  
    Comparing the resulting angle fits across binning schemes allows us to check for consistency 
    and any potential l-dependence in the signal.
  </p>
    </section>


    <section>
        <h2>BB spectra comparison</h2>
        <p>
    We begin by plotting the BB and EB spectra from the simulations. Each plot shows 499 simulated 
    curves overlaid in gray. The <span style="color:rgb(116, 116, 238);">blue shaded area</span> represents the 68% 
    confidence band (i.e., the central range containing 68% of the simulations), while the 
    <span style="color:red;">red line</span> shows the mean spectrum across all simulations for each bin.
  </p>

  <p>
    The BB and EB spectra are compared against the expected input signals used to generate the simulations.  
    In particular, the <code>Sigl</code> curves represent the signal-only case (no dust, no noise), including 
    only the primary CMB plus lensing. This serves as a useful baseline for verifying the fidelity 
    of the simulations and the consistency of the injected EDE signal.
  </p>
        <figure>
            <img alt="BB curves" id="bbcomp" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
             <figcaption>
  Comparison of BB and EB spectra across 499 simulations.  
 
  <ul>
    <li><strong>Spectrum type:</strong> 
      <em>BB</em> (total BB spectrum), 
      <em>BB Sigl</em> (BB signal-only without dust or noise), or 
      <em>EB</em> (total EB spectrum).</li>
    <li><strong>Injected EDE signal:</strong> 
      <em>Fede = 0.07, g = 1</em> shows simulations with an injected Early Dark Energy signal, 
      while <em>g = 0</em> corresponds to the null case with no EDE signal.</li>
  </ul>
  Each plot displays all 499 simulation realizations as gray lines.  
  The <span style="color:blue;">blue band</span> indicates the 68% confidence interval across simulations,  
  and the <span style="color:red;">red line</span> shows the mean spectrum in each bin.
</figcaption>

            <script type="text/javascript">
               

                pager.link("#bbcomp", {
                   
                    
                    'Spectra|spectro': [
                        'BB|BB',
                        'BB Sigl|BB_sigl',
                        'EB|EB',
                        'EE|EE',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
         
                    function (params) {
                        let dirbase = '/liuto/home/GitHub/EB_analysis/'
                        let dirpath = dirbase + '/overlay_plots/';
                        let file = params.ede + '_overlay_confband_' + params.spectro
                        let name = dirpath + file +  '.png';
            
                        console.log(name);
                        return name;
                    });

                pager.setparams({
        
                    'ede': 'zeroeb',
                    'spectro': 'BB',
                });
            </script>
        </figure>
        <p>
  Differences between the BB curves become especially apparent in the BB sigl plots
  when comparing the <em>g = 1</em> and <em>g = 0</em> cases. In contrast, the EE curves
  remain largely similar between these two cases.
</p>
<p>
  As expected, the EB curves center around zero when <em>g = 0</em> (no injected EDE), while
  they resemble a scaled version of EE when <em>g = 1</em> (with EDE injection), consistent with
  theoretical expectations that cosmic birefringence mixes E and B modes.
</p>
<p>
  To better illustrate these differences, we plot the bin-by-bin differences between the mean EE
  and BB spectra for each case. For EE, the difference straddles zero, suggesting minimal change
  between <em>g = 0</em> and <em>g = 1</em>. However, for BB, there is a clear and consistent
  positive excess when EDE is injected.
</p>
  Notably, the BB excess signal is approximately 10% of the peak BB sigl amplitude, whereas the
  EE difference remains within 5% of its peak, as seen by comparing the vertical axis ranges.
</p>
            <figure>
            <img alt="BB Diffs" id="bbdiff" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
             <figcaption>
    Plot showing the difference between the mean spectra for <em>g = 1</em> and
    <em>g = 0</em> cases.
    <ul>
      <li><strong>Data type:</strong>
        Choose <em>Signal + lensing</em> for signal-only simulations (no dust or noise), or
        <em>+Dust+Noise</em> for fully simulated datasets.</li>
      <li><strong>Spectrum:</strong>
        Toggle between <em>BB</em> and <em>EE</em> to see how EDE injection impacts each.</li>
    </ul>
    The gray curves represent simulation realizations, the <span style="color:blue;">blue band</span> shows
    the 68% spread, and the <span style="color:red;">red line</span> indicates the mean difference.
  </figcaption>

            <script type="text/javascript">
               

                pager.link("#bbdiff", {
                   
                    
                    'Data type|dtype': [
                        'Signal + lensing|_sigl',
                        '+Dust+Noise|'
                    ],
                    'Spectra|spectrq': [
                        'BB|BB',
                        'EE|EE',
                    ],
                },
         
                    function (params) {
                        let dirbase = '/liuto/home/GitHub/EB_analysis/'
                        let dirpath = dirbase + '/overlay_plots/';
                        let file = 'diff_overlay_confband_' + params.spectrq + params.dtype 
                        let name = dirpath + file +  '.png';
            
                        console.log(name);
                        return name;
                    });

                pager.setparams({
        
                    'dtype': '_sigl',
                });
            </script>
        </figure>
        <p>
  Going forward, we can further verify the origin of the BB excess signal through several approaches.
  One option is to rerun the MCMC analysis using a more realistic BB model that accounts for 
  additional contributions from EB and EE leakage via lensing, the currently hypothesized source of this excess signal. 
  This would help confirm the robustness of the 
  estimator under more complete modeling of the BB spectrum.
</p>
<p>
  Alternatively, we can revisit the simulation pipeline itself to better control for unwanted 
  excess in the BB signal, ensuring that only the intended signal components (e.g., lensing, 
  injected birefringence) are included and that the BB spectrum is not affected by these components.
</p>
<p>
  These investigations reinforce that the issue identified in the previous analysis is not 
  a bug in the estimator, but rather a mismatch between the BB signal in our simulations 
  and the assumed BB model used in the MCMC fit. The estimator provides unbiased 
  fits for <em>g</em> and rotation angle as long as the simulated BB is consistent with the model.
</p>
<p>
  For real data, this means we must carefully check whether the inclusion of BB in the likelihood 
  alters the best-fit values. A shift would imply that BB is indeed seeing excess rotation. 
  The magnitude of this shift could potentially indicate a true physical signal and 
  can be characterized by the estimator bias due to unmodeled BB structure.
</p>
    </section>
    <section>
        <h2>Alternative EB curves with different EDE parameters</h2>
       <p>
    We rerun the MCMC fits for EB-only using alternative theoretical EB spectra generated 
    from <a href="https://github.com/doicbek/class_private">CLASS</a>, with best-fit parameters 
    from <a href="https://arxiv.org/pdf/2303.15369">Eskilt et al.</a> Each EB curve corresponds 
    to a different EDE model motivated by recent cosmological datasets. Note that the 
    <code>f<sub>EDE</sub> = 0.07</code> case is the same fiducial model used throughout our 
    previous analyses.
</p>
        <figure>
            <img alt="EDE params" id="fede" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
    Explore different MCMC fit results and diagnostic plots:<br><br>
    <strong>Map Sim Num Digit1, Digit2, Digit3:</strong> Select the simulation instance by its digit indices (0–9), viewing individual simulation chain results.<br><br>
    <strong>Map Type:</strong> Choose the type of plot:<br>
    &nbsp;&nbsp;- <em>Best Fit EE/EB/BB:</em> Shows the MCMC best-fit parameter constraints for each polarization spectrum.<br>
    &nbsp;&nbsp;- <em>Triangle Plot:</em> Displays joint posterior distributions and parameter correlations.<br>
    &nbsp;&nbsp;- <em>Summary Plot (Peaks histogram):</em> Histogram summarizing the distribution of peak values in the MCMC chains.<br>
    &nbsp;&nbsp;- <em>Chi Squared histogram:</em> Distribution of chi-squared goodness-of-fit values across simulations.<br><br>
    <strong>EDE parameters:</strong> Select different Early Dark Energy models based on f<sub>EDE</sub> values from various datasets:<br>
    • <a href="https://arxiv.org/abs/2503.14454">ACT</a> data (f<sub>EDE</sub> ≈ 0.012).<br>
    • <a href="https://arxiv.org/pdf/2210.16296">Planck</a> data (f<sub>EDE</sub> ≈ 0.070).<br>
    • <a href="https://arxiv.org/pdf/2210.16296">Planck + BOSS</a> (f<sub>EDE</sub> ≈ 0.087).<br>
    • <a href="https://arxiv.org/pdf/2210.16296">Planck + BOSS + SH0ES</a> (f<sub>EDE</sub> ≈ 0.127).<br><br>
   
    <strong>Bins Used:</strong> Select the multipole bin range used in the fit (currently fixed to bins 2–15).<br><br>
    <strong>Dust model:</strong> Currently fixed to 'Fixed Dust = 0', indicating no dust contamination is modeled.<br><br>
    <strong>Spectra:</strong> Choose which spectra to fit; here it is EB only.<br><br>
    <strong>Injected EDE Signal:</strong> Select whether the simulations include an injected EDE signal (f<sub>EDE</sub>=0.07, g=1) or no signal (g=0).<br><br>
    
</figcaption>
            <script type="text/javascript">
               function pad(num, size) {
                    num = num.toString();
                    while (num.length < size) num = "0" + num;
                    return num;
                }
                const simnums = [];
                for (let i = 0; i < 10; i++) {
                    s = pad(i, 1);

                    simnums[i] = s.concat('|', s);

                }

                pager.link("#fede", {
                    'Map Sim Num Digit1|digit1': simnums,
                    'Digit2|digit2': simnums,
                    'Digit3|digit3': simnums,

                    'Map Type|m_map_type': [
                        'Best Fit EE|_bestfitEE',
                        'Best Fit EB|_bestfitEB',
                        'Best Fit BB|_bestfitBB',
                        'Triangle Plot|_triangle_plot',
                        'Summary Plot (Peaks histogram)|sim1_summary',
                        'Chi Squared histogram|simchisq_hist'
                    ],
                    'EDE parameters|fede': [
                        'f_EDE = 0.012 (ACT)|_ebfede0.01',
                        'f_EDE = 0.070 (Planck)|_ebfede0.07',
                        'f_EDE = 0.087 (Planck Boss)|_ebfede0.09',
                        'f_EDE = 0.127 (Planck Boss SH0ES)|_ebfede0.13',
                    ], 
                    'Bins Used|bin_num': [
                        '2-15|_bin2-15',
                    ],
                    'Dust model|theory_compf': [
                        'Fixed Dust = 0|_fixed_dust',
                    ],
                    'Spectra|spectra': [
                        'EB only|_eb',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
         
                    function (params) {
                        let dirbase = '/liuto'
                        let dirpath = dirbase + '/ede_chains/';
                        let mcmc_folder = params.ede + params.bin_num  + params.theory_compf + params.spectra+ params.fede +'/';
                        let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
                        let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
                        if (params.m_map_type == 'sim1_summary' || params.m_map_type == 'simchisq_hist') {
                            name = dirpath + mcmc_folder + params.m_map_type + '.png'
                        }
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'digit1': '0',
                    'digit2': '0',
                    'digit3': '1',
                    'inj_sig': '',
                    'bin_num':'_bin2-15',
                    'fede':'_ebfede0.07',
                    'ede': 'zeroeb',
                    'spectra': '_eb',
                    'theory_compf': '_fixed_dust',
                });
            </script>
        </figure>

        <h3>g = 0</h3>
<table border="1" cellpadding="6" cellspacing="0">
  <thead>
    <tr>
      <th>Parameter</th>
      <th>fede = 0.12</th>
      <th>fede = 0.07</th>
      <th>fede = 0.087</th>
      <th>fede = 0.127</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>alpha_BK18_220</td>
      <td></td>
      <td>-0.02 ± 0.27</td>
      <td>-0.01 ± 0.22</td>
      <td>0 ± 0.17</td>
    </tr>
    <tr>
      <td>alpha_BK18_150</td>
      <td></td>
      <td>-0.02 ± 0.21</td>
      <td>-0.01 ± 0.16</td>
      <td>0 ± 0.10</td>
    </tr>
    <tr>
      <td>alpha_BK18_K95</td>
      <td></td>
      <td>-0.03 ± 0.32</td>
      <td>-0.04 ± 0.26</td>
      <td>-0.01 ± 0.23</td>
    </tr>
    <tr>
      <td>alpha_BK18_B95lf</td>
      <td></td>
      <td>-0.03 ± 0.22</td>
      <td>-0.01 ± 0.15</td>
      <td>-0.01 ± 0.07</td>
    </tr>
    <tr>
      <td>g</td>
      <td></td>
      <td>0.02 ± 0.46</td>
      <td>0.04 ± 0.41</td>
      <td>0.03 ± 0.35</td>
    </tr>
  </tbody>
</table>

<h3>g = 1</h3>
<table border="1" cellpadding="6" cellspacing="0">
  <thead>
    <tr>
      <th>Parameter</th>
      <th>fede = 0.12</th>
      <th>fede = 0.07</th>
      <th>fede = 0.087</th>
      <th>fede = 0.127</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>alpha_BK18_220</td>
      <td></td>
      <td>0 ± 0.30</td>
      <td>0.13 ± 0.23</td>
      <td>0.34 ± 0.19</td>
    </tr>
    <tr>
      <td>alpha_BK18_150</td>
      <td></td>
      <td>0 ± 0.23</td>
      <td>0.12 ± 0.16</td>
      <td>0.35 ± 0.10</td>
    </tr>
    <tr>
      <td>alpha_BK18_K95</td>
      <td></td>
      <td>0 ± 0.29</td>
      <td>0.12 ± 0.25</td>
      <td>0.35 ± 0.23</td>
    </tr>
    <tr>
      <td>alpha_BK18_B95lf</td>
      <td></td>
      <td>0 ± 0.23</td>
      <td>0.13 ± 0.15</td>
      <td>0.36 ± 0.07</td>
    </tr>
    <tr>
      <td>g</td>
      <td></td>
      <td>0.97 ± 0.45</td>
      <td>0.89 ± 0.42</td>
      <td>0.75 ± 0.37</td>
    </tr>
  </tbody>
</table>


  <p>The two tables present the fitted rotation angle parameters (<code>α</code>) across different BK18 frequency bands,<br>
     along with the early dark energy axion coupling parameter <code>g</code>, for two cases: <code>g=0</code> (no coupling)<br>
     and <code>g=1</code> (maximal coupling). Fits are shown for varying Early Dark Energy fractions <code>f<sub>EDE</sub>.</p>
  <h4>1. <code>g = 0</code> Case (No Axion Coupling)</h4>
  
    <li>Rotation angles <code>α</code> are consistent with zero within uncertainties across bands and EDE fractions.<br></li>
    <li><code>g</code> is close to zero with large uncertainties (~0.35 to 0.46), as expected.<br></li>
    <li>No systematic trend with EDE fraction; no spurious rotation detected.<br></li>
  

  <h4>2. <code>g = 1</code> Case (Large Coupling)</h4>
  
    <li>Rotation angles <code>α</code> show positive shifts increasing with EDE fraction.<br></li>
    <li><code>g</code> values near 1 with uncertainties similar to <code>g=0</code> case.<br></li>
    <li>Error bars shrink at higher EDE fractions while the value of g shifts down.<br></li>
    <li>Consistent angle shifts across bands suggest a coherent rotation pattern when the EDE curve 
        in the MCMC model do not match the EB curve in the simulations.<br></li>
  



    </section>
    <section>
        <h2>L dependent rotation Bin split 2-8 and 9-15</h2>
 <figure>
            <img alt="Multicomponent Analysis Spectrum" id="morebins" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
                <p>Interactive plot pager for multicomponent analysis of the Early Dark Energy (EDE) spectrum.
                    Visualizes the fits and triangle plots for 499 simulations.</p>
               
                <p>This interactive plot allows detailed exploration of multicomponent analysis by adjusting
                    map types, binning, theoretical assumptions, spectra selections, EDE signal injections, and
                    simulation numbers.</p>
            </figcaption>

            <script type="text/javascript">
                

                pager.link("#morebins", {
                    'Map Sim Num Digit1|digit1': simnums,
                    'Digit2|digit2': simnums,
                    'Digit3|digit3': simnums,

                    'Map Type|m_map_type': [
                        'Best Fit EE|_bestfitEE',
                        'Best Fit EB|_bestfitEB',
                        'Best Fit BB|_bestfitBB',
                        'Triangle Plot|_triangle_plot',
                        'Summary Plot (Peaks histogram)|sim1_summary',
                        'Chi Squared histogram|simchisq_hist'
                    ],
                    'Bins Used|bin_num15': [
                        '2-8|_bin2-8',
                        '9-15|_bin9-15',
                        '2-15|_bin2-15',
                    ],
                    'Injected Signal|inj_sig': [
                        'Positive Miscalibration|_sigpos',
                        'Negative Miscalibration|_signeg',
                        'Balanced Miscalibration|_sigbal',
                        'No Miscalibration|'
                    ],
                    'Model|theory_comp': [
                        'Rotation Only|_det_polrot',
                    ],
                    'Spectra|spectra': [
                        'EB only|_eb',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
                    function (params) {
                        let dirbase = '/liuto'
                        let dirpath = dirbase + '/ede_chains/';
                        let mcmc_folder = params.ede + params.bin_num15 + params.theory_comp + params.spectra + params.inj_sig+ '/';
                        let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
                        let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
                        if (params.m_map_type == 'sim1_summary' || params.m_map_type == 'simchisq_hist') {
                            name = dirpath + mcmc_folder + params.m_map_type + '.png'
                        }
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'digit1': '0',
                    'digit2': '0',
                    'digit3': '1',
                    'inj_sig': '',
                    'm_map_type': '_bestfitEB',
                    'bin_num15': '_bin2-15',
                    'ede': 'zeroeb',
                    'spectra': '_eb',
                    'theory_comp': '_det_polrot',
                });
            </script>
        </figure>
          
      <figure>
            <img alt="Bin diffs" id="bindiff" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
                
            </figcaption>

            <script type="text/javascript">
               

                pager.link("#bindiff", {
                    'Map Sim Num Digit1|digit1': simnums,
                    'Digit2|digit2': simnums,
                    'Digit3|digit3': simnums,

                 
                    'Injected Signal|inj_sig': [
                        'Positive Miscalibration|_sigpos',
                        'Negative Miscalibration|_signeg',
                        'Balanced Miscalibration|_sigbal',
                        'No Miscalibration|'
                    ],
                    'Model|theory_comp': [
                        'Rotation Only|_det_polrot',
                    ],
                    'Spectra|spectra': [
                        'EB only|_eb',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
         
                    function (params) {
                        let dirbase = '/liuto'
                        let dirpath = dirbase + '/ede_chains/bindiffs2-8,9-15,2-15/';
                        let mcmc_folder = params.ede + params.theory_comp + params.spectra + params.inj_sig+ '/';
                        let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
                        let name = dirpath + mcmc_folder + sim_id  + '.png';
            
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'digit1': '0',
                    'digit2': '0',
                    'digit3': '1',
                    'inj_sig': '',
                    'ede': 'zeroeb',
                    'spectra': '_eb',
                    'theory_comp': '_det_polrot',
                });
            </script>
        </figure>
        <figure>
            <img alt="Z Scores" id="zscore" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
                
            </figcaption>

            <script type="text/javascript">
               

                pager.link("#zscore", {
                   
                    'Angle|angle':[
                        'alpha_BK18_150|alpha_BK18_150',
                        'alpha_BK18_K95|alpha_BK18_K95',
                        'alpha_BK18_B95lf|alpha_BK18_B95e',
                        'alpha_BK18_220|alpha_BK18_220',
                    ],
                 
                    'Injected Signal|inj_sig': [
                        'Positive Miscalibration|_sigpos',
                        'Negative Miscalibration|_signeg',
                        'Balanced Miscalibration|_sigbal',
                        'No Miscalibration|'
                    ],
                    'Bins compare 1|binset1':[
                        'Bins 2-8|bin2-8',
                    ],
                    'Bins compare 2|binset2':[
                        'Bins 9-15|bin9-15',
                    ],
                    'Model|theory_comp': [
                        'Rotation Only|_det_polrot',
                    ],
                    'Spectra|spectra': [
                        'EB only|_eb',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
         
                    function (params) {
                        let dirbase = '/liuto/home/GitHub/EB_analysis/'
                        let dirpath = dirbase + '/zscore_histograms/';
                        let zscore1 = params.angle + '_' + params.ede + '_' + params.binset1 + params.theory_comp + params.spectra + params.inj_sig
                        let zscore2 = params.ede + '_' + params.binset2 + params.theory_comp + params.spectra + params.inj_sig
                        
                        let name = dirpath + 'zscore_hist_' + zscore1 + '_' + zscore2 +  '.png';
            
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'angle': 'alpha_BK18_150',
                    'binset1': 'bin2-8',
                    'binset2': 'bin9-15',
                    'inj_sig': '',
                    'ede': 'zeroeb',
                    'spectra': '_eb',
                    'theory_comp': '_det_polrot',
                });
            </script>
        </figure>
        <figure>
    <img alt="All Bin2-8 vs Bin9-15 Comparisons" id="bindiff_all_combos" src="#" width="750" height="500"
        onerror="javascript:this.src='dne.png'" />
    <figcaption>
        Comparison of every bin2-8 vs bin9-15 combination
    </figcaption>

    <script type="text/javascript">

        pager.link("#bindiff_all_combos", {
            'Angle|angle':[
                        'alpha_BK18_150|alpha_BK18_150',
                        'alpha_BK18_K95|alpha_BK18_K95',
                        'alpha_BK18_B95lf|alpha_BK18_B95e',
                        'alpha_BK18_220|alpha_BK18_220',
                    ],
            'Injected Signal Bins 2-8|inj_sig1': [
                'Positive Miscalibration|_sigpos',
                'Negative Miscalibration|_signeg',
                'Balanced Miscalibration|_sigbal',
                'No Miscalibration|'
            ],
            'Injected Signal Bins 9-15|inj_sig2': [
                'Positive Miscalibration|_sigpos',
                'Negative Miscalibration|_signeg',
                'Balanced Miscalibration|_sigbal',
                'No Miscalibration|'
            ],
            'Model|theory_comp': [
                'Rotation Only|_det_polrot',
            ],
            'Spectra|spectra': [
                'EB only|_eb',
            ],
            'Injected EDE Signal Bins 2-8|ede1': [
                'Fede = 0.07, g = 1|fede01',
                'g = 0|zeroeb'
            ],

            'Injected EDE Signal Bins 9-15|ede2': [
                'Fede = 0.07, g = 1|fede01',
                'g = 0|zeroeb'
            ]
        },

            function (params) {
                let dirbase = '/liuto/home/GitHub/EB_analysis/'
                let dirpath = dirbase + '/zscore_histograms/';
                let bin1 = 'bin2-8' + params.inj_sig1;
                let bin2 = 'bin9-15' + params.inj_sig2;
                let zscore1 = params.angle + '_' + params.ede1 + '_' + params.binset1 + params.theory_comp + params.spectra + params.inj_sig1
                let zscore2 = params.ede2 + '_' + params.binset2 + params.theory_comp + params.spectra + params.inj_sig2
                        
                let name = dirpath + 'zscore_hist_' + zscore1 + '_' + zscore2 +  '.png';
                console.log(name);
                return name;
            });

        pager.setparams({
            'inj_sig1': '',
            'inj_sig2': '',
            'ede1': 'zeroeb',
            'ede2': 'zeroeb',
            'spectra': '_eb',
            'theory_comp': '_det_polrot',
            'angle': 'alpha_BK18_150',
            'binset1': 'bin2-8',
            'binset2': 'bin9-15',
        });

    </script>
</figure>

    </section>
    <section>
        <h2>L dependent rotation Bin split 2-10 and 11-15</h2>
 <figure>
            <img alt="Multicomponent Analysis Spectrum" id="morebins10" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
                <p>Interactive plot pager for multicomponent analysis of the Early Dark Energy (EDE) spectrum.
                    Visualizes the fits and triangle plots for 499 simulations.</p>
               
                <p>This interactive plot allows detailed exploration of multicomponent analysis by adjusting
                    map types, binning, theoretical assumptions, spectra selections, EDE signal injections, and
                    simulation numbers.</p>
            </figcaption>

            <script type="text/javascript">

                pager.link("#morebins10", {
                    'Map Sim Num Digit1|digit1': simnums,
                    'Digit2|digit2': simnums,
                    'Digit3|digit3': simnums,

                    'Map Type|m_map_type': [
                        'Best Fit EE|_bestfitEE',
                        'Best Fit EB|_bestfitEB',
                        'Best Fit BB|_bestfitBB',
                        'Triangle Plot|_triangle_plot',
                        'Summary Plot (Peaks histogram)|sim1_summary',
                        'Chi Squared histogram|simchisq_hist'
                    ],
                    'Bins Used|bin_num10': [
                        '2-10|_bin2-10',
                        '11-15|_bin11-15',
                        '2-15|_bin2-15',
                    ],
                    'Injected Signal|inj_sig': [
                        'Positive Miscalibration|_sigpos',
                        'Negative Miscalibration|_signeg',
                        'Balanced Miscalibration|_sigbal',
                        'No Miscalibration|'
                    ],
                    'Model|theory_comp': [
                        'Rotation Only|_det_polrot',
                    ],
                    'Spectra|spectra': [
                        'EB only|_eb',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
                    function (params) {
                        let dirbase = '/liuto'
                        let dirpath = dirbase + '/ede_chains/';
                        let mcmc_folder = params.ede + params.bin_num10 + params.theory_comp + params.spectra + params.inj_sig+ '/';
                        let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
                        let name = dirpath + mcmc_folder + sim_id + params.m_map_type + '.png';
                        if (params.m_map_type == 'sim1_summary' || params.m_map_type == 'simchisq_hist') {
                            name = dirpath + mcmc_folder + params.m_map_type + '.png'
                        }
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'digit1': '0',
                    'digit2': '0',
                    'digit3': '1',
                    'inj_sig': '',
                    'm_map_type': '_bestfitEB',
                    'bin_num10': '_bin2-15',
                    'ede': 'zeroeb',
                    'spectra': '_eb',
                    'theory_comp': '_det_polrot',
                });
            </script>
        </figure>
          
      <figure>
            <img alt="Bin diffs" id="bindiff10" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
                
            </figcaption>

            <script type="text/javascript">
               

                pager.link("#bindiff10", {
                    'Map Sim Num Digit1|digit1': simnums,
                    'Digit2|digit2': simnums,
                    'Digit3|digit3': simnums,

                 
                    'Injected Signal|inj_sig': [
                        'Positive Miscalibration|_sigpos',
                        'Negative Miscalibration|_signeg',
                        'Balanced Miscalibration|_sigbal',
                        'No Miscalibration|'
                    ],
                    'Model|theory_comp': [
                        'Rotation Only|_det_polrot',
                    ],
                    'Spectra|spectra': [
                        'EB only|_eb',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
         
                    function (params) {
                        let dirbase = '/liuto'
                        let dirpath = dirbase + '/ede_chains/bindiffs2-10,11-15,2-15/';
                        let mcmc_folder = params.ede + params.theory_comp + params.spectra + params.inj_sig+ '/';
                        let sim_id = 'sim' + params.digit1 + params.digit2 + params.digit3;
                        let name = dirpath + mcmc_folder + sim_id  + '.png';
            
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'digit1': '0',
                    'digit2': '0',
                    'digit3': '1',
                    'inj_sig': '',
                    'ede': 'zeroeb',
                    'spectra': '_eb',
                    'theory_comp': '_det_polrot',
                });
            </script>
        </figure>
        <figure>
            <img alt="Z Scores" id="zscore10" src="#" width="750" height="500"
                onerror="javascript:this.src='dne.png'" />
            <figcaption>
                
            </figcaption>

            <script type="text/javascript">
               

                pager.link("#zscore10", {
                   
                    'Angle|angle':[
                        'alpha_BK18_150|alpha_BK18_150',
                        'alpha_BK18_K95|alpha_BK18_K95',
                        'alpha_BK18_B95lf|alpha_BK18_B95e',
                        'alpha_BK18_220|alpha_BK18_220',
                    ],
                 
                    'Injected Signal|inj_sig': [
                        'Positive Miscalibration|_sigpos',
                        'Negative Miscalibration|_signeg',
                        'Balanced Miscalibration|_sigbal',
                        'No Miscalibration|'
                    ],
                    'Bins compare 1|binset1b':[
                        'Bins 2-10|bin2-10',
                    ],
                    'Bins compare 2|binset2b':[
                        'Bins 11-15|bin11-15',
                    ],
                    'Model|theory_comp': [
                        'Rotation Only|_det_polrot',
                    ],
                    'Spectra|spectra': [
                        'EB only|_eb',
                    ],
                    'Injected EDE Signal|ede': [
                        'Fede = 0.07, g = 1|fede01',
                        'g = 0|zeroeb'
                    ]
                },
         
                    function (params) {
                        let dirbase = '/liuto/home/GitHub/EB_analysis/'
                        let dirpath = dirbase + '/zscore_histograms/';
                        let zscore1 = params.angle + '_' + params.ede + '_' + params.binset1b + params.theory_comp + params.spectra + params.inj_sig
                        let zscore2 = params.ede + '_' + params.binset2b + params.theory_comp + params.spectra + params.inj_sig
                        
                        let name = dirpath + 'zscore_hist_' + zscore1 + '_' + zscore2 +  '.png';
            
                        console.log(name);
                        return name;
                    });

                pager.setparams({
                    'angle': 'alpha_BK18_150',
                    'binset1b': 'bin2-10',
                    'binset2b': 'bin11-15',
                    'inj_sig': '',
                    'ede': 'zeroeb',
                    'spectra': '_eb',
                    'theory_comp': '_det_polrot',
                });
            </script>
        </figure>
        <figure>
    <img alt="All Bin2-10 vs Bin11-15 Comparisons" id="bindiff_all_combos10" src="#" width="750" height="500"
        onerror="javascript:this.src='dne.png'" />
    <figcaption>
        Comparison of every bin2-10 vs bin11-15 combination
    </figcaption>

    <script type="text/javascript">

        pager.link("#bindiff_all_combos10", {
            'Angle|angle':[
                        'alpha_BK18_150|alpha_BK18_150',
                        'alpha_BK18_K95|alpha_BK18_K95',
                        'alpha_BK18_B95lf|alpha_BK18_B95e',
                        'alpha_BK18_220|alpha_BK18_220',
                    ],
            'Injected Signal Bins 2-10|inj_sig1': [
                'Positive Miscalibration|_sigpos',
                'Negative Miscalibration|_signeg',
                'Balanced Miscalibration|_sigbal',
                'No Miscalibration|'
            ],
            'Injected Signal Bins 11-15|inj_sig2': [
                'Positive Miscalibration|_sigpos',
                'Negative Miscalibration|_signeg',
                'Balanced Miscalibration|_sigbal',
                'No Miscalibration|'
            ],
            'Model|theory_comp': [
                'Rotation Only|_det_polrot',
            ],
            'Spectra|spectra': [
                'EB only|_eb',
            ],
            'Injected EDE Signal Bins 2-10|ede1': [
                'Fede = 0.07, g = 1|fede01',
                'g = 0|zeroeb'
            ],

            'Injected EDE Signal Bins 11-15|ede2': [
                'Fede = 0.07, g = 1|fede01',
                'g = 0|zeroeb'
            ]
        },

            function (params) {
                let dirbase = '/liuto/home/GitHub/EB_analysis/'
                let dirpath = dirbase + '/zscore_histograms/';
                let bin1 = 'bin2-10' + params.inj_sig1;
                let bin2 = 'bin11-15' + params.inj_sig2;
                let zscore1 = params.angle + '_' + params.ede1 + '_' + params.binset1b + params.theory_comp + params.spectra + params.inj_sig1
                let zscore2 = params.ede2 + '_' + params.binset2b + params.theory_comp + params.spectra + params.inj_sig2
                        
                let name = dirpath + 'zscore_hist_' + zscore1 + '_' + zscore2 +  '.png';
                console.log(name);
                return name;
            });

        pager.setparams({
            'inj_sig1': '',
            'inj_sig2': '',
            'ede1': 'zeroeb',
            'ede2': 'zeroeb',
            'spectra': '_eb',
            'theory_comp': '_det_polrot',
            'angle': 'alpha_BK18_150',
            'binset1b': 'bin2-10',
            'binset2b': 'bin11-15',
        });

    </script>
</figure>

    </section>

    <section>
        <h2>Future Directions</h2>

     
    </section>
    <section>
        <h2>Appendix</h2>
        <p>All chains and plots can be found in
            <code>/n/holylfs04/LABS/kovac_lab/Users/liuto/ede_chains</code>.
        </p>
    </section>
</body>

</html>
